<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>API Monitor</title>
  <link rel="icon" type="image/png" href="/logo.png">
  <link rel="shortcut icon" href="/logo.png">
  <link rel="icon" href="/logo.png" sizes="32x32">
  <meta name="msapplication-TileImage" content="/logo.png">
  <script src="https://cdn.jsdelivr.net/npm/vue@3/dist/vue.global.prod.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    ::-webkit-scrollbar {
      display: none !important;
    }

    :root {
      --primary-color: #6366f1;
      --primary-dark: #4f46e5;
      --primary-light: #818cf8;
      --secondary-color: #f97316;
      --success-color: #10b981;
      --warning-color: #f59e0b;
      --danger-color: #ef4444;
      --info-color: #3b82f6;
      --cf-color: #f38020;
      --cf-dark: #e5730d;

      /* Light theme */
      --bg-primary: #ffffff;
      --bg-secondary: #f9fafb;
      --bg-tertiary: #f3f4f6;
      --text-primary: #111827;
      --text-secondary: #4b5563;
      --text-tertiary: #6b7280;
      --border-color: #e5e7eb;
      --card-bg: #ffffff;
      --card-shadow: 5px 5px 8px -5px rgba(0, 0, 0, 0.1), 0 7px 7px -7px rgba(0, 0, 0, 0.04);
      --card-hover-shadow: 5px 5px 6px 0px rgb(0 0 0 / 0%), 4px 4px 5px 0px rgb(0 0 0 / 9%);
      --modal-overlay: rgba(0, 0, 0, 0.5);
      --input-bg: #ffffff;
      --input-border: #d1d5db;
      --input-focus-border: #6366f1;
      --button-primary-bg: #6366f1;
      --button-primary-hover: #4f46e5;
      --button-secondary-bg: #f3f4f6;
      --button-secondary-hover: #00878d;
      --status-running: #10b981;
      --status-stopped: #ef4444;
      --status-suspended: #f59e0b;
      --status-deploying: #8b5cf6;
      --status-paused: #6b7280;
    }

    @media (prefers-color-scheme: dark) {
      :root {
        --bg-primary: #111827;
        --bg-secondary: #1f2937;
        --bg-tertiary: #374151;
        --text-primary: #f9fafb;
        --text-secondary: #d1d5db;
        --text-tertiary: #9ca3af;
        --border-color: #374151;
        --card-bg: #1f2937;
        --card-shadow: 2px 2px 2px 0px rgba(0, 0, 0, 0.3), 2px 2px 2px 0px rgba(0, 0, 0, 0.2);
        --card-hover-shadow: 5px 5px 6px 0px rgba(0, 0, 0, 0.3), 4px 4px 5px 0px rgba(0, 0, 0, 0.2);
        --modal-overlay: rgba(0, 0, 0, 0.7);
        --input-bg: #374151;
        --input-border: #4b5563;
        --input-focus-border: #6366f1;
        --button-primary-bg: #6366f1;
        --button-primary-hover: #4f46e5;
        --button-secondary-bg: #374151;
        --button-secondary-hover: #004346;
        --status-running: #10b981;
        --status-stopped: #ef4444;
        --status-suspended: #f59e0b;
        --status-deploying: #8b5cf6;
        --status-paused: #6b7280;
      }
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
      background-color: var(--bg-primary);
      color: var(--text-primary);
      line-height: 1.6;
      transition: background-color 0.3s, color 0.3s;
      min-height: 100vh;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 12px;
    }

    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 12px;
      flex-wrap: wrap;
      gap: 10px;
    }

    .title {
      font-size: 20px;
      font-weight: 700;
      color: var(--text-primary);
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .controls {
      display: flex;
      gap: 10px;
      align-items: center;
      margin-bottom: 10px;
      flex-wrap: wrap;
      justify-content: flex-end;
    }

    .refresh-info {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .refresh-progress {
      position: relative;
      width: 80px;
      height: 6px;
      background-color: var(--bg-tertiary);
      border-radius: 3px;
      overflow: hidden;
      border: 1px solid var(--border-color);
      box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.1);
    }

    .refresh-progress-bar {
      height: 100%;
      background: linear-gradient(90deg, var(--primary-color), var(--primary-light));
      border-radius: 3px;
      transition: width 1s linear;
    }



    .btn {
      width: 90px;
      padding: 8px 12px;
      border-radius: 6px;
      font-weight: 500;
      font-size: 13px;
      cursor: pointer;
      transition: all 0.15s;
      border: none;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      white-space: nowrap;
    }

    .btn-primary {
      background-color: var(--button-primary-bg);
      color: white;
    }

    .btn-primary:hover {
      background-color: var(--button-primary-hover);
    }

    .btn-secondary {
      background-color: #00adafbf;
      color: white;
    }

    .btn-secondary:hover {
      background-color: var(--button-secondary-hover);
    }

    .btn-danger {
      background-color: var(--danger-color);
      color: white;
    }

    .btn-danger:hover {
      background-color: #dc2626;
    }

    .btn-success {
      background: linear-gradient(135deg, #27ae60, #2ecc71);
      color: white;
    }

    .btn-success:hover {
      background: linear-gradient(135deg, #229954, #27ae60);
    }

    .btn-warning {
      background: linear-gradient(135deg, #f39c12, #e67e22);
      color: white;
    }

    .btn-warning:hover {
      background: linear-gradient(135deg, #e67e22, #d35400);
    }

    .btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none;
    }

    .info-card {
      display: none;
      background-color: var(--card-bg);
      border-radius: 10px;
      padding: 8px;
      margin-bottom: 10px;
      border: 1px solid var(--border-color);
    }

    .info-card-title {
      font-weight: 600;
      margin-bottom: 8px;
      color: var(--primary-color);
    }

    .info-card-content {
      color: var(--text-secondary);
      font-size: 14px;
    }

    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      gap: 10px;
      margin-bottom: 10px;
    }

    .stat-card {
      padding: 8px 20px;
      gap: 0px;
      background-color: var(--card-bg);
      border-radius: 10px;
      display: flex;
      align-items: center;
      box-shadow: var(--card-shadow);
      border: 1px solid var(--border-color);
      transition: transform 0.3s, box-shadow 0.3s;
      justify-content: space-between;
      align-content: center;
    }

    .stat-card:hover {
      transform: translateY(-1px);
      box-shadow: var(--card-hover-shadow);
    }

    .stat-label {
      font-size: 14px;
      color: var(--text-secondary);
    }

    .stat-value {
      font-size: 20px;
      font-weight: 700;
      color: var(--primary-color);
    }

    .account-card {
      background-color: var(--card-bg);
      border-radius: 10px;
      padding: 12px;
      margin-bottom: 12px;
      box-shadow: var(--card-shadow);
      border: 1px solid var(--border-color);
      transition: transform 0.3s, box-shadow 0.3s;
    }

    /* .account-card:hover {
      transform: translateY(-2px);
      box-shadow: var(--card-hover-shadow);
    } */

    .account-header {
      padding-left: 18px !important;
      background-color: var(--card-bg);
      border-radius: 10px;
      padding: 10px;
      border: 1px solid var(--border-color);
      transition: transform 0.3s, box-shadow 0.3s;
      height: 100%;
      display: flex;
      justify-content: space-between;
      align-items: center;
      cursor: pointer;
    }

    .account-header:hover {
      box-shadow: var(--card-shadow);
    }

    .account-header:active {
      transform: scale(0.995);
    }

    .account-balance:active {
      transform: none;
    }

    .account-info {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .account-name {
      font-size: 16px;
      font-weight: 600;
      color: var(--text-primary);
    }

    .account-email {
      font-size: 14px;
      color: var(--text-secondary);
    }

    .account-balance {
      display: flex;
      flex-direction: row;
      align-items: center;
      gap: 10px;
    }

    .balance {
      font-size: 16px;
      font-weight: 700;
      color: var(--success-color);
    }

    .balance.low {
      color: var(--warning-color);
    }

    .balance.critical {
      color: var(--danger-color);
    }

    .ai-balance {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 6px 12px;
      border-radius: 20px;
      font-size: 14px;
      font-weight: 600;
    }

    .projects-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
      gap: 10px;
      margin-top: 12px;
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      overflow: visible;
      transform-origin: top;
    }

    .projects-grid.collapsed {
      max-height: 0;
      opacity: 0;
      margin-top: 0;
      transform: scaleY(0.95);
      overflow: hidden;
    }

    .project-card {
      box-shadow: var(--card-shadow);
      background-color: var(--card-bg);
      border-radius: 10px;
      padding: 12px;
      border: 1px solid var(--border-color);
      transition: transform 0.3s, box-shadow 0.3s;
      height: 100%;
      display: flex;
      flex-direction: column;
    }

    .project-card:hover {
      transform: translateY(-1px);
      box-shadow: var(--card-hover-shadow);
    }

    .project-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 8px;
    }

    .project-name {
      font-size: 14px;
      font-weight: 600;
      color: var(--text-primary);
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .project-info {
      font-size: 12px;
      color: var(--text-tertiary);
    }

    .project-cost {
      font-size: 16px;
      font-weight: 700;
      color: var(--info-color);
    }

    .project-stats {
      display: flex;
      gap: 12px;
      margin-bottom: 12px;
      font-size: 13px;
      color: var(--text-secondary);
    }

    .services-container {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .service-item {
      border-radius: 6px;
      padding: 8px;
      border: 1px solid var(--border-color);
      transition: all 0.15s;
    }

    .service-item.running {
      background-color: rgba(16, 185, 129, 0.1);
      border-color: rgba(16, 185, 129, 0.2);
    }

    .service-item.stopped {
      background-color: rgba(239, 68, 68, 0.1);
      border-color: rgba(239, 68, 68, 0.2);
    }

    .service-item.suspended {
      background-color: rgba(245, 158, 11, 0.1);
      border-color: rgba(245, 158, 11, 0.2);
    }

    .service-item.deploying {
      background-color: rgba(139, 92, 246, 0.1);
      border-color: rgba(139, 92, 246, 0.2);
    }

    .service-item.paused {
      background-color: rgba(107, 114, 128, 0.1);
      border-color: rgba(107, 114, 128, 0.2);
    }

    .service-item.pending {
      background-color: rgba(59, 130, 246, 0.1);
      border-color: rgba(59, 130, 246, 0.2);
    }

    .service-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 8px;
    }

    .service-name {
      font-weight: 600;
      font-size: 14px;
      color: var(--text-primary);
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    .service-status {
      padding: 4px 8px;
      border-radius: 20px;
      font-size: 11px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .status-running {
      background-color: rgba(16, 185, 129, 0.2);
      color: var(--status-running);
    }

    .status-stopped {
      background-color: rgba(239, 68, 68, 0.2);
      color: var(--status-stopped);
    }

    .status-suspended {
      background-color: rgba(245, 158, 11, 0.2);
      color: var(--status-suspended);
    }

    .status-deploying {
      background-color: rgba(139, 92, 246, 0.2);
      color: var(--status-deploying);
    }

    .status-paused {
      background-color: rgba(107, 114, 128, 0.2);
      color: var(--status-paused);
    }

    .service-info {
      font-size: 12px;
      color: var(--text-tertiary);
      margin-bottom: 8px;
    }

    .service-actions {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
    }

    .service-btn {
      padding: 4px 8px;
      border-radius: 6px;
      font-size: 12px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s;
      border: none;
      display: inline-flex;
      align-items: center;
      gap: 4px;
    }

    .btn-pause {
      background-color: rgba(245, 158, 11, 0.2);
      color: var(--warning-color);
    }

    .btn-pause:hover {
      background-color: rgba(245, 158, 11, 0.3);
    }

    .btn-restart {
      background-color: rgba(59, 130, 246, 0.2);
      color: var(--info-color);
    }

    .btn-restart:hover {
      background-color: rgba(59, 130, 246, 0.3);
    }

    .btn-logs {
      background-color: rgba(139, 92, 246, 0.2);
      color: var(--status-deploying);
    }

    .btn-logs:hover {
      background-color: rgba(139, 92, 246, 0.3);
    }

    .domains-container {
      display: flex;
      flex-direction: column;
      gap: 10px;
      margin-top: 12px;
      padding-top: 12px;
      border-top: 1px solid var(--border-color);
    }

    .domain-link {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 8px 12px;
      background-color: var(--bg-secondary);
      border-radius: 8px;
      color: var(--primary-color);
      text-decoration: none;
      font-size: 13px;
      font-weight: 500;
      transition: all 0.2s;
      border: 1px solid var(--border-color);
    }

    .domain-link:hover {
      background-color: var(--bg-tertiary);
    }

    .domain-badge {
      background-color: var(--primary-color);
      color: white;
      padding: 2px 6px;
      border-radius: 10px;
      font-size: 10px;
      font-weight: 600;
    }

    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: var(--modal-overlay);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
      padding: 20px;
    }

    .modal-overlay.logs-fullscreen-overlay {
      align-items: stretch;
      justify-content: stretch;
      padding: 0;
      z-index: 1000;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
    }

    .modal {
      background-color: var(--card-bg);
      border-radius: 12px;
      padding: 24px;
      max-width: 500px;
      width: 100%;
      max-height: 90vh;
      overflow-y: auto;
      box-shadow: var(--card-hover-shadow);
    }

    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }

    .modal-title {
      font-size: 20px;
      font-weight: 600;
      color: var(--text-primary);
    }

    .modal-close {
      background: none;
      border: none;
      font-size: 20px;
      cursor: pointer;
      color: var(--text-secondary);
      padding: 4px;
      border-radius: 4px;
      transition: all 0.2s;
    }

    .modal-close:hover {
      background-color: var(--bg-secondary);
      color: var(--text-primary);
    }

    .form-group {
      margin-bottom: 16px;
    }

    .form-label {
      display: block;
      font-size: 14px;
      font-weight: 500;
      color: var(--text-secondary);
      margin-bottom: 6px;
    }

    .form-input {
      width: 100%;
      padding: 10px 12px;
      border: 1px solid var(--input-border);
      border-radius: 8px;
      font-size: 14px;
      background-color: var(--input-bg);
      color: var(--text-primary);
      transition: border-color 0.2s;
    }

    .form-input:focus {
      outline: none;
      border-color: var(--input-focus-border);
    }

    .form-textarea {
      width: 100%;
      padding: 10px 12px;
      border: 1px solid var(--input-border);
      border-radius: 8px;
      font-size: 14px;
      background-color: var(--input-bg);
      color: var(--text-primary);
      transition: border-color 0.2s;
      resize: vertical;
      min-height: 120px;
      font-family: monospace;
    }

    .form-textarea:focus {
      outline: none;
      border-color: var(--input-focus-border);
    }

    .form-help {
      font-size: 12px;
      color: var(--text-tertiary);
      margin-top: 4px;
    }

    .form-error {
      color: var(--danger-color);
      font-size: 13px;
      margin-bottom: 7px;
      margin-top: -9px;
    }

    .form-success {
      color: var(--success-color);
      font-size: 13px;
      margin-top: 4px;
    }

    .account-list {
      display: flex;
      flex-direction: column;
      gap: 3px;
      margin-bottom: 16px;
    }

    .account-item {
      padding-left: 18px !important;
      background-color: var(--card-bg);
      border-radius: 10px;
      padding: 10px;
      border: 1px solid var(--border-color);
      transition: transform 0.3s, box-shadow 0.3s;
      height: 100%;
      display: flex;
      justify-content: space-between;
      align-items: center;
      cursor: pointer;
    }

    .account-item:hover {
      transform: translateY(-1px);
      box-shadow: var(--card-hover-shadow);
    }

    .account-item-info {
      flex: 1;
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .account-item-name {
      font-weight: 600;
      color: var(--text-primary);
      font-size: 14px;
    }

    .divider {
      height: 1px;
      background-color: var(--border-color);
      margin: 16px 0;
    }

    .last-update {
      font-size: 14px;
      color: var(--text-tertiary);
      margin-left: auto;
    }

    .loading {
      text-align: center;
      padding: 40px;
      color: var(--text-secondary);
    }

    .error {
      background-color: rgba(239, 68, 68, 0.1);
      color: var(--danger-color);
      padding: 16px;
      border-radius: 8px;
      margin-bottom: 20px;
    }

    .empty-state {
      text-align: center;
      padding: 40px;
      color: var(--text-tertiary);
    }

    .opacity-label {
      font-size: 13px;
      font-weight: 500;
      color: var(--text-secondary);
    }

    .opacity-slider {
      width: 100px;
      height: 4px;
      -webkit-appearance: none;
      appearance: none;
      background: var(--border-color);
      border-radius: 2px;
      outline: none;
    }

    .opacity-slider::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 16px;
      height: 16px;
      border-radius: 50%;
      background: var(--primary-color);
      cursor: pointer;
    }

    .opacity-value {
      font-size: 13px;
      font-weight: 500;
      color: var(--text-secondary);
      min-width: 35px;
    }

    .logs-modal {
      max-width: 1200px;
      width: 95%;
      height: 80vh;
      display: flex;
      flex-direction: column;
      position: relative;
      background-color: var(--card-bg);
      border-radius: 12px;
      padding: 0;
      margin: 0;
    }

    .logs-modal-fullscreen {
      max-width: none !important;
      width: 100vw !important;
      height: 100vh !important;
      border-radius: 0 !important;
      margin: 0 !important;
      padding: 0 !important;
      top: 0 !important;
      left: 0 !important;
      right: 0 !important;
      bottom: 0 !important;
      position: fixed !important;
      z-index: 1001;
      display: flex !important;
      flex-direction: column !important;
      max-height: none !important;
      overflow-y: visible !important;
      box-shadow: none !important;
    }

    .logs-modal-fullscreen .logs-header {
      flex-shrink: 0;
    }

    .logs-modal-fullscreen .logs-info {
      flex-shrink: 0;
    }

    .logs-modal-fullscreen .logs-content {
      flex: 1;
      overflow-y: auto;
      overflow-x: hidden;
      min-height: 0;
    }

    .logs-modal-fullscreen .logs-footer {
      flex-shrink: 0;
    }

    .logs-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 8px 10px;
      border-bottom: 1px solid var(--border-color);
    }

    .logs-title {
      font-size: 16px;
      font-weight: 600;
      color: var(--primary-color);
    }

    .logs-controls {
      display: flex;
      align-items: center;
    }

    .logs-info {
      padding: 10px 20px;
      background-color: var(--bg-secondary);
      color: var(--text-secondary);
      font-size: 12px;
      display: flex;
      gap: 16px;
      flex-wrap: wrap;
    }

    .logs-content {
      flex: 1;
      overflow: hidden;
      padding: 16px;
      width: 100%;
      box-sizing: border-box;
      position: relative;
    }

    .logs-text-container {
      position: relative;
      width: 100%;
      height: 100%;
      overflow: hidden;
    }

    .logs-text {
      background-color: var(--bg-tertiary);
      padding: 12px;
      border-radius: 8px 8px 0 0;
      font-family: monospace;
      font-size: 12px;
      line-height: 1.5;
      white-space: pre;
      overflow-wrap: normal;
      word-break: normal;
      color: var(--text-primary);
      min-height: 100%;
      width: max-content;
      max-width: 100%;
      box-sizing: border-box;
      overflow-y: auto;
      overflow-x: auto;
      height: calc(100% - 12px);
      scrollbar-width: none;
      -ms-overflow-style: none;
    }

    .logs-text::-webkit-scrollbar {
      display: none;
    }

    .logs-horizontal-scrollbar {
      height: 12px;
      background-color: var(--border-color);
      border-radius: 0 0 6px 6px;
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      cursor: pointer;
      z-index: 10;
    }

    .logs-scrollbar-thumb {
      height: 100%;
      background-color: var(--primary-color);
      border-radius: 6px;
      position: absolute;
      top: 0;
      left: 0;
      width: 0%;
      transition: width 0.1s ease;
      cursor: grab;
    }

    .logs-scrollbar-thumb:active {
      cursor: grabbing;
    }

    .balance-card {
      display: flex;
      align-items: center;
      gap: 6px;
      padding: 3px 9px;
      background-color: var(--card-bg);
      border: 1px solid var(--border-color);
      border-radius: 8px;
      transition: all 0.2s ease;
      user-select: none;
    }

    .balance-card:hover {
      border-color: var(--primary-color);
    }

    .credit-balance-card {
      background: linear-gradient(135deg, rgba(16, 185, 129, 0.1), rgba(34, 197, 94, 0.1));
      border-color: rgba(16, 185, 129, 0.3);
    }

    .credit-balance-card:hover {
      border-color: var(--success-color);
      background: linear-gradient(135deg, rgba(16, 185, 129, 0.15), rgba(34, 197, 94, 0.15));
    }

    .ai-balance-card {
      background: linear-gradient(135deg, rgba(99, 102, 241, 0.1), rgba(139, 92, 246, 0.1));
      border-color: rgba(99, 102, 241, 0.3);
    }

    .ai-balance-card:hover {
      border-color: var(--primary-color);
      background: linear-gradient(135deg, rgba(99, 102, 241, 0.15), rgba(139, 92, 246, 0.15));
    }

    .balance-icon {
      font-size: 16px;
      line-height: 1;
    }

    .balance-amount {
      font-size: 14px;
      font-weight: 600;
      color: var(--text-primary);
      line-height: 1;
    }

    .balance-amount.critical {
      color: var(--danger-color);
    }

    .balance-amount.low {
      color: var(--warning-color);
    }

    .logs-footer {
      padding: 12px 20px;
      border-top: 1px solid var(--border-color);
      text-align: right;
    }

    .edit-input {
      width: 120px;
      padding: 4px 8px;
      border: 1px solid var(--input-focus-border);
      border-radius: 6px;
      font-size: 14px;
      font-weight: 600;
      outline: none;
      background-color: var(--input-bg);
      color: var(--text-primary);
    }

    .edit-btn {
      padding: 4px 8px;
      background-color: rgba(99, 102, 241, 0.2);
      border: 1px solid rgba(99, 102, 241, 0.4);
      border-radius: 6px;
      cursor: pointer;
      transition: all 0.2s;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .edit-btn:hover {
      background-color: rgba(99, 102, 241, 0.3);
    }

    .cancel-btn {
      padding: 4px 8px;
      background-color: rgba(239, 68, 68, 0.2);
      border: 1px solid rgba(239, 68, 68, 0.4);
      border-radius: 6px;
      cursor: pointer;
      transition: all 0.2s;
    }

    .cancel-btn:hover {
      background-color: rgba(239, 68, 68, 0.3);
    }

    .account-name-edit {
      display: flex;
      align-items: center;
    }

    /* ‰∏ªÊ†áÁ≠æÈ°µÊ†∑Âºè */
    .main-tabs {
      display: flex;
      gap: 0;
      margin-bottom: 16px;
      border-bottom: 2px solid var(--border-color);
    }

    .main-tab {
      padding: 12px 24px;
      border: none;
      background: none;
      cursor: pointer;
      font-size: 15px;
      font-weight: 600;
      color: var(--text-secondary);
      border-bottom: 3px solid transparent;
      margin-bottom: -2px;
      transition: all 0.2s;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .main-tab:hover {
      color: var(--primary-color);
      background-color: var(--bg-secondary);
    }

    .main-tab.active {
      color: var(--primary-color);
      border-bottom-color: var(--primary-color);
    }

    .main-tab.dns-tab:hover {
      color: var(--cf-color);
    }

    .main-tab.dns-tab.active {
      color: var(--cf-color);
      border-bottom-color: var(--cf-color);
    }

    /* DNS ÁÆ°ÁêÜÁõ∏ÂÖ≥Ê†∑Âºè */
    .dns-tabs {
      display: flex;
      gap: 8px;
      margin-bottom: 16px;
      border-bottom: 1px solid var(--border-color);
      padding-bottom: 12px;
    }

    .dns-tab-btn {
      padding: 8px 16px;
      border: none;
      background: none;
      cursor: pointer;
      font-size: 14px;
      font-weight: 600;
      color: var(--text-secondary);
      border-radius: 6px;
      transition: all 0.2s;
    }

    .dns-tab-btn.active {
      background: var(--cf-color);
      color: white;
    }

    .dns-tab-btn:hover:not(.active) {
      background: var(--bg-secondary);
    }

    .panel {
      line-height: 1;
      background: var(--card-bg);
      border-radius: 10px;
      padding: 16px;
      box-shadow: var(--card-shadow);
      border: 1px solid var(--border-color);
      margin-bottom: 16px;
    }

    .panel-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 12px;
    }

    .panel-title {
      font-size: 16px;
      font-weight: 600;
    }

    .table-container {
      overflow-x: auto;
    }

    .data-table {
      width: 100%;
      border-collapse: collapse;
      font-size: 13px;
      table-layout: fixed;
    }

    .data-table th,
    .data-table td {
      padding: 10px 12px;
      text-align: left;
      border-bottom: 1px solid var(--border-color);
      color: var(--text-primary);
      overflow: hidden;
    }

    .data-table th {
      background: var(--bg-secondary);
      font-weight: 600;
      color: var(--text-secondary);
      position: sticky;
      top: 0;
      white-space: nowrap;
    }

    .data-table tr:hover {
      background: var(--bg-secondary);
    }

    .data-table .actions {
      display: flex;
      gap: 6px;
    }

    .data-table td:nth-child(1) {
      width: 60px;
    }

    .data-table td:nth-child(2) {
      width: 150px;
    }

    .data-table td:nth-child(3) {
      width: auto;
      min-width: 150px;
    }

    .data-table td:nth-child(4) {
      width: 70px;
    }

    .data-table td:nth-child(5) {
      width: 70px;
    }

    .data-table td:nth-child(6) {
      width: 100px;
    }

    .record-type {
      padding: 2px 8px;
      border-radius: 4px;
      font-size: 11px;
      font-weight: 600;
      background: var(--bg-tertiary);
      color: var(--text-primary);
      display: inline-block;
      white-space: nowrap;
    }

    .record-type.A {
      background: rgba(16, 185, 129, 0.2);
      color: #10b981;
    }

    .record-type.AAAA {
      background: rgba(59, 130, 246, 0.2);
      color: #3b82f6;
    }

    .record-type.CNAME {
      background: rgba(139, 92, 246, 0.2);
      color: #a78bfa;
    }

    .record-type.TXT {
      background: rgba(245, 158, 11, 0.2);
      color: #fbbf24;
    }

    .record-type.MX {
      background: rgba(239, 68, 68, 0.2);
      color: #f87171;
    }

    .record-type.NS {
      background: rgba(99, 102, 241, 0.2);
      color: #818cf8;
    }

    .record-type.SRV {
      background: rgba(236, 72, 153, 0.2);
      color: #f472b6;
    }

    .record-type.CAA {
      background: rgba(20, 184, 166, 0.2);
      color: #2dd4bf;
    }

    .proxied-badge {
      padding: 2px 6px;
      border-radius: 4px;
      font-size: 10px;
      font-weight: 600;
      display: inline-block;
      white-space: nowrap;
    }

    .proxied-on {
      background: rgba(243, 128, 32, 0.2);
      color: #fb923c;
    }

    .proxied-off {
      background: var(--bg-tertiary);
      color: var(--text-tertiary);
    }

    .zones-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
      gap: 12px;
      margin-bottom: 16px;
    }

    .zone-card {
      background: var(--card-bg);
      border-radius: 8px;
      padding: 5px 16px;
      border: 1px solid var(--border-color);
      cursor: pointer;
      transition: all 0.2s;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .zone-card:hover {
      border-color: var(--cf-color);
      box-shadow: var(--card-shadow);
    }

    .zone-card.active {
      border-color: var(--cf-color);
      background: rgba(243, 128, 32, 0.05);
    }

    .zone-name {
      font-weight: 600;
      font-size: 14px;
    }

    .zone-status {
      font-size: 12px;
      color: var(--text-tertiary);
    }

    .zone-status.active {
      color: var(--success-color);
    }

    .dns-account-select {
      display: flex;
      gap: 8px;
      align-items: center;
      margin-bottom: 16px;
    }

    .dns-account-select select {
      padding: 8px 12px;
      border-radius: 6px;
      border: 1px solid var(--input-border);
      background: var(--input-bg);
      color: var(--text-primary);
      font-size: 14px;
      min-width: 200px;
    }

    .quick-switch {
      display: none;
      gap: 8px;
      align-items: center;
      padding: 12px;
      background: var(--bg-secondary);
      border-radius: 8px;
      margin-bottom: 16px;
      flex-wrap: wrap;
    }

    .quick-switch input {
      display: none;
      flex: 1;
      min-width: 120px;
      padding: 8px 12px;
      border: 1px solid var(--input-border);
      border-radius: 6px;
      background: var(--input-bg);
      color: var(--text-primary);
      font-size: 14px;
    }

    .content-truncate {
      max-width: 300px;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    .editable-cell {
      cursor: pointer;
      padding: 2px 4px;
      border-radius: 4px;
      transition: background-color 0.2s;
      color: var(--text-primary);
    }

    .editable-cell:hover {
      background-color: var(--bg-tertiary);
    }

    .inline-edit-container {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      max-width: 100%;
    }

    .inline-edit-input {
      padding: 4px 8px;
      border: 1px solid var(--cf-color);
      border-radius: 4px;
      font-size: 13px;
      background-color: var(--input-bg);
      color: var(--text-primary);
      outline: none;
      width: 230px;
      min-width: 150px;
      max-width: 230px;
    }

    .inline-edit-input:focus {
      border-color: var(--cf-color);
      box-shadow: 0 0 0 2px rgba(243, 128, 32, 0.2);
    }

    .inline-edit-cancel {
      padding: 2px 6px;
      background-color: rgba(239, 68, 68, 0.2);
      border: 1px solid rgba(239, 68, 68, 0.4);
      border-radius: 4px;
      cursor: pointer;
      font-size: 12px;
      transition: all 0.2s;
      color: var(--danger-color);
      flex-shrink: 0;
    }

    .inline-edit-cancel:hover {
      background-color: rgba(239, 68, 68, 0.3);
    }

    .btn-cf {
      background-color: var(--cf-color);
      color: white;
    }

    .btn-cf:hover {
      background-color: var(--cf-dark);
    }

    .toast {
      position: fixed;
      bottom: 20px;
      right: 20px;
      padding: 12px 20px;
      border-radius: 8px;
      color: white;
      font-size: 14px;
      z-index: 2000;
      animation: slideIn 0.3s;
    }

    .toast.success {
      background: var(--success-color);
    }

    .toast.error {
      background: var(--danger-color);
    }

    @keyframes slideIn {
      from {
        transform: translateX(100%);
        opacity: 0;
      }

      to {
        transform: translateX(0);
        opacity: 1;
      }
    }

    /* Responsive adjustments */
    @media (max-width: 768px) {
      .container {
        padding: 16px;
      }

      .header {
        flex-direction: column;
        align-items: flex-start;
      }

      .controls {
        display: flex;
        gap: 10px;
        align-items: center;
        margin-bottom: 10px;
        flex-wrap: wrap;
        justify-content: flex-end;
      }

      .stats-grid {
        grid-template-columns: repeat(2, 1fr);
      }

      .projects-grid {
        grid-template-columns: 1fr;
      }

      .account-header {
        background-color: var(--card-bg);
        border-radius: 10px;
        padding: 10px;
        border: 1px solid var(--border-color);
        transition: transform 0.3s, box-shadow 0.3s;
        height: 100%;
        display: flex;
        justify-content: space-between;
      }

      .account-balance {
        align-items: flex-start;
      }

      .modal {
        padding: 20px;
      }
    }

    @media (max-width: 480px) {
      .stats-grid {
        grid-template-columns: 1fr;
      }

      .controls {
        display: flex;
        gap: 10px;
        align-items: center;
        margin-bottom: 10px;
        flex-wrap: wrap;
        justify-content: flex-end;
      }

      .btn {
        justify-content: center;
      }
    }
  </style>
</head>

<body>
  <div id="app">
    <!-- È¶ñÊ¨°ËÆæÁΩÆÂØÜÁ†ÅÁïåÈù¢ -->
    <div v-if="showSetPasswordModal" class="modal-overlay">
      <div class="modal">
        <div class="modal-header">
          <div class="modal-title">üéâ Ê¨¢Ëøé‰ΩøÁî®</div>
        </div>
        <p style="text-align: center; color: var(--text-secondary); margin-bottom: 24px;">ËØ∑ËÆæÁΩÆÁÆ°ÁêÜÂëòÂØÜÁ†Å</p>
        <div class="form-group">
          <input v-model="setPassword" type="password" class="form-input" placeholder="ËØ∑ËæìÂÖ•ÂØÜÁ†ÅÔºàËá≥Â∞ë6‰ΩçÔºâ"
            @keyup.enter="setAdminPassword" />
        </div>
        <div class="form-group">
          <input v-model="setPasswordConfirm" type="password" class="form-input" placeholder="ËØ∑ÂÜçÊ¨°ËæìÂÖ•ÂØÜÁ†Å"
            @keyup.enter="setAdminPassword" />
        </div>
        <div v-if="setPasswordError" class="form-error">
          {{ setPasswordError }}
        </div>
        <button @click="setAdminPassword" class="btn btn-primary" style="width: 100%;">
          ËÆæÁΩÆÂØÜÁ†Å
        </button>
      </div>
    </div>

    <!-- ÁôªÂΩïÁïåÈù¢ -->
    <div v-if="showLoginModal" class="modal-overlay">
      <div class="modal">
        <div class="modal-header">
          <div class="modal-title">üîê ÁÆ°ÁêÜÂëòÁôªÂΩï</div>
        </div>
        <div class="form-group">
          <input v-model="loginPassword" type="password" class="form-input" placeholder="ËØ∑ËæìÂÖ•ÁÆ°ÁêÜÂëòÂØÜÁ†Å"
            @keyup.enter="verifyPassword" />
        </div>
        <div v-if="loginError" class="form-error">
          {{ loginError }}
        </div>
        <button @click="verifyPassword" class="btn btn-primary" style="width: 100%;">
          ÁôªÂΩï
        </button>
      </div>
    </div>

    <div v-if="isAuthenticated" class="container">
      <!-- ‰∏ªÊ†áÁ≠æÈ°µÂØºËà™ -->
      <div class="main-tabs">
        <button class="main-tab" :class="{ active: mainActiveTab === 'zeabur' }" @click="mainActiveTab = 'zeabur'">
          <i class="fas fa-rocket"></i> Zeabur ÁõëÊéß
        </button>
        <button class="main-tab dns-tab" :class="{ active: mainActiveTab === 'dns' }" @click="switchToDns">
          <i class="fas fa-cloud"></i> CF DNS ÁÆ°ÁêÜ
        </button>
      </div>

      <!-- ==================== Zeabur ÁõëÊéßÈÉ®ÂàÜ ==================== -->
      <div v-if="mainActiveTab === 'zeabur'">
        <div class="info-card">
          <div class="info-card-title">üí° ‰ΩøÁî®ËØ¥Êòé</div>
          <div class="info-card-content">
            Êï∞ÊçÆÊØè30ÁßíËá™Âä®Âà∑Êñ∞
          </div>
        </div>

        <div class="controls" style="justify-content: space-between;">
          <div style="display: flex; gap: 10px; align-items: center;">
            <button class="btn btn-primary" @click="fetchData" :disabled="loading">
              <i class="fas fa-sync-alt"></i>
              {{ loading ? 'Êï∞ÊçÆÊõ¥Êñ∞' : 'Âà∑Êñ∞Êï∞ÊçÆ' }}
            </button>
            <button class="btn btn-secondary" @click="toggleDataRefresh"
              :class="dataRefreshPaused ? 'btn-success' : 'btn-warning'">
              <i class="fas" :class="dataRefreshPaused ? 'fa-play' : 'fa-pause'"></i>
              {{ dataRefreshPaused ? 'ÁªßÁª≠Êõ¥Êñ∞' : 'ÊöÇÂÅúÊõ¥Êñ∞' }}
            </button>
            <button class="btn btn-secondary" @click="showManageModal = true">
              <i class="fas fa-cog"></i>
              ÁÆ°ÁêÜË¥¶Âè∑
            </button>
            <button class="btn btn-danger" @click="clearCache">
              <i class="fas fa-trash"></i>
              Ê∏ÖÈô§ÁºìÂ≠ò
            </button>
          </div>
          <div class="refresh-info">
            <div class="last-update">Â∞ÜÂú® {{ refreshCountdown }} ÁßíÂêéÂà∑Êñ∞</div>
            <div class="refresh-progress">
              <div class="refresh-progress-bar" :style="{ width: refreshProgress + '%' }"></div>
            </div>
          </div>
        </div>

        <!-- Êó•ÂøóÊ®°ÊÄÅÊ°Ü -->
        <div v-if="showLogsModal" class="modal-overlay" :class="{ 'logs-fullscreen-overlay': logsFullscreen }"
          @keydown.esc="showLogsModal = false" tabindex="-1">
          <div class="modal logs-modal" :class="{ 'logs-modal-fullscreen': logsFullscreen }">
            <div class="logs-header">
              <div class="logs-title">üìã {{ logsModalTitle }}</div>
              <div class="logs-controls">
                <button class="btn btn-secondary" @click="toggleRealTimeRefresh"
                  style="margin-right: 8px; padding: 6px 10px; font-size: 12px;">
                  <i class="fas" :class="logsRealTime ? 'fa-stop' : 'fa-play'"></i>
                  {{ logsRealTime ? 'ÂÅúÊ≠¢ÂÆûÊó∂' : 'ÂÆûÊó∂Âà∑Êñ∞' }}
                </button>
                <button class="btn btn-secondary" @click="toggleAutoScroll"
                  style="margin-right: 8px; padding: 6px 10px; font-size: 12px;">
                  <i class="fas" :class="logsAutoScroll ? 'fa-pause' : 'fa-play'"></i>
                  {{ logsAutoScroll ? 'ÂÅúÊ≠¢ÊªöÂä®' : 'Ëá™Âä®ÊªöÂä®' }}
                </button>
                <button class="btn btn-secondary" @click="toggleFullscreen"
                  style="margin-right: 8px; padding: 6px 10px; font-size: 12px;">
                  <i class="fas" :class="logsFullscreen ? 'fa-compress' : 'fa-expand'"></i>
                  {{ logsFullscreen ? 'ÈÄÄÂá∫ÂÖ®Â±è' : 'ÂÖ®Â±è' }}
                </button>
                <button class="btn btn-danger" @click="showLogsModal = false"
                  style="padding: 6px 10px; font-size: 12px;">
                  <i class="fas fa-times"></i>
                  ÂÖ≥Èó≠
                </button>
              </div>
            </div>
            <div class="logs-info">
              <span>È°πÁõÆ: {{ logsModalInfo.project }}</span>
              <span>Ë¥¶Âè∑: {{ logsModalInfo.account }}</span>
              <span>Êó•Âøó: {{ logsModalInfo.count }} Êù°</span>
              <span>Êó∂Èó¥: {{ logsModalInfo.time }}</span>
            </div>
            <div class="logs-content" ref="logsContent" @wheel.stop @touchmove.stop>
              <div v-if="logsLoading" style="text-align: center; padding: 40px;">‚è≥ Ê≠£Âú®Âä†ËΩΩÊó•Âøó...</div>
              <div v-else class="logs-text-container" ref="logsTextContainer">
                <pre class="logs-text" ref="logsText">{{ logsContent || 'ÊöÇÊó†Êó•Âøó' }}</pre>
                <div class="logs-horizontal-scrollbar" ref="logsScrollbar">
                  <div class="logs-scrollbar-thumb" ref="logsScrollbarThumb"></div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Ë¥¶Âè∑ÁÆ°ÁêÜÊ®°ÊÄÅÊ°Ü -->
        <div v-if="showManageModal" class="modal-overlay" @mousedown.self="showManageModal = false">
          <div class="modal" style="max-width: 700px;">
            <div class="modal-header">
              <div class="modal-title">‚öôÔ∏è Ë¥¶Âè∑ÁÆ°ÁêÜ</div>
              <button class="modal-close" @click="closeManageModal">√ó</button>
            </div>

            <div class="modal-actions" style="padding: 0 0px 10px;">
              <button class="btn btn-secondary" @click="exportAllAccounts" style="margin-right: 10px;">
                <i class="fas fa-download"></i> ÂØºÂá∫
              </button>
              <button class="btn btn-secondary" @click="importAllAccounts" style="margin-right: 10px;">
                <i class="fas fa-upload"></i> ÂØºÂÖ•
              </button>
            </div>

            <!-- Ë¥¶Âè∑ÂàóË°® -->
            <div class="account-list">
              <!-- ÊòæÁ§∫Êú¨Âú∞ÁÆ°ÁêÜÁöÑË¥¶Âè∑ -->
              <div v-for="(account, index) in managedAccounts" :key="'local-' + index" class="account-item">
                <div class="account-item-info">
                  <div class="account-item-name">{{ account.name }}</div>
                </div>
                <button @click="removeAccount(index)" class="btn btn-danger"
                  style="padding: 6px 10px; font-size: 12px;">
                  <i class="fas fa-trash"></i>
                  Âà†Èô§
                </button>
              </div>

              <!-- ÊòæÁ§∫ÊúçÂä°Âô®ÈÖçÁΩÆÁöÑË¥¶Âè∑ÔºàÂè™ËØªÔºâ -->
              <div v-if="managedAccounts.length === 0 && accounts.length > 0">
                <div
                  style="font-size: 12px; color: var(--text-secondary); margin-bottom: 8px; padding: 8px 10px; background-color: var(--bg-tertiary); border-radius: 4px; border: 1px solid var(--border-color);">
                  üí° ‰ª•‰∏ãË¥¶Âè∑Êù•Ëá™ÊúçÂä°Âô®ÈÖçÁΩÆÔºà.env Êñá‰ª∂ÔºâÔºåÊó†Ê≥ïÂú®Ê≠§Âà†Èô§
                </div>
                <div v-for="account in accounts" :key="'server-' + account.name" class="account-item">
                  <div class="account-item-info">
                    <div class="account-item-name">{{ account.name }}</div>
                  </div>
                  <span
                    style="font-size: 12px; color: var(--text-tertiary); padding: 6px 12px; background-color: var(--bg-tertiary); border-radius: 6px;">
                    üîí ÊúçÂä°Âô®ÈÖçÁΩÆ
                  </span>
                </div>
              </div>

              <div v-if="managedAccounts.length === 0 && accounts.length === 0" class="empty-state">
                ÊöÇÊó†Ë¥¶Âè∑ÔºåÁÇπÂáª‰∏ãÊñπÊåâÈíÆÊ∑ªÂä†
              </div>
            </div>

            <div class="divider"></div>

            <!-- Ê∑ªÂä†Êñ∞Ë¥¶Âè∑Ë°®Âçï -->
            <div>
              <div class="modal-title" style="margin-bottom: 12px; font-size: 15px;">‚ûï Ê∑ªÂä†Êñ∞Ë¥¶Âè∑</div>

              <div class="form-group" style="margin-bottom: 12px;">
                <label class="form-label">Ë¥¶Âè∑ÂêçÁß∞</label>
                <input v-model="newAccount.name" type="text" class="form-input" placeholder="‰æãÂ¶ÇÔºöÊàëÁöÑË¥¶Âè∑" />
              </div>

              <div class="form-group" style="margin-bottom: 12px;">
                <label class="form-label">API Token</label>
                <input v-model="newAccount.token" type="password" class="form-input"
                  placeholder="sk-xxxxxxxxxxxxxxxx" />
                <div class="form-help">
                  Âú® Zeabur ÊéßÂà∂Âè∞ÁöÑËÆæÁΩÆ‰∏≠ÂàõÂª∫ API Token
                </div>
              </div>

              <div v-if="addAccountError" class="form-error">
                {{ addAccountError }}
              </div>

              <div v-if="addAccountSuccess" class="form-success">
                {{ addAccountSuccess }}
              </div>

              <button class="btn btn-primary" @click="addAccountToList" :disabled="addingAccount" style="width: 100%;">
                {{ addingAccount ? 'È™åËØÅ‰∏≠...' : '‚ûï Ê∑ªÂä†Âà∞ÂàóË°®' }}
              </button>
            </div>

            <!-- ÊâπÈáèÊ∑ªÂä† -->
            <div class="divider"></div>
            <div>
              <div class="modal-title" style="margin-bottom: 12px; font-size: 15px;">üì¶ ÊâπÈáèÊ∑ªÂä†Ë¥¶Âè∑</div>
              <div class="form-help">
                ÊØèË°å‰∏Ä‰∏™Ë¥¶Âè∑ÔºåÊîØÊåÅÊ†ºÂºèÔºö<code>ÂêçÁß∞:Token</code> Êàñ <code>ÂêçÁß∞ÔºöToken</code> Êàñ <code>ÂêçÁß∞(Token)</code> Êàñ
                <code>ÂêçÁß∞ÔºàTokenÔºâ</code>
              </div>
              <div style="position: relative; min-height: 120px;">
                <div
                  style="width: 100%; min-height: 120px; padding: 12px; border: 1px solid var(--border-color); border-radius: 8px; font-size: 13px; font-family: monospace; white-space: pre-wrap; word-break: break-all; pointer-events: none; color: var(--text-primary); line-height: 1.5; background-color: var(--input-bg);">
                  {{ maskedBatchAccounts }}</div>
                <textarea v-model="batchAccounts" @input="updateBatchDisplay" placeholder="ÊØèË°å‰∏Ä‰∏™Ë¥¶Âè∑ÔºåÊ†ºÂºèÔºöË¥¶Âè∑ÂêçÁß∞:API_Token"
                  class="form-textarea"
                  style="position: absolute; top: 0; left: 0; color: transparent; caret-color: var(--text-primary); background: transparent; line-height: 1.5;"></textarea>
              </div>
              <div v-if="batchAddError" class="form-error">
                {{ batchAddError }}
              </div>
              <div v-if="batchAddSuccess" class="form-success">
                {{ batchAddSuccess }}
              </div>
              <button class="btn btn-primary" @click="batchAddAccounts" :disabled="addingAccount"
                style="width: 100%; margin-top: 12px;">
                {{ addingAccount ? 'Ê∑ªÂä†‰∏≠...' : 'üì¶ ÊâπÈáèÊ∑ªÂä†' }}
              </button>
            </div>
          </div>
        </div>

        <!-- ÊóßÁöÑÊ∑ªÂä†Ë¥¶Âè∑Ê®°ÊÄÅÊ°ÜÔºà‰øùÁïôÂÖºÂÆπÔºâ -->
        <div v-if="showAddModal" class="modal-overlay" @mousedown.self="showAddModal = false">
          <div class="modal">
            <div class="modal-header">
              <div class="modal-title">‚ûï Ê∑ªÂä† Zeabur Ë¥¶Âè∑</div>
              <button class="modal-close" @click="closeAddModal">√ó</button>
            </div>

            <div class="form-group">
              <label class="form-label">Ë¥¶Âè∑ÂêçÁß∞</label>
              <input v-model="newAccount.name" type="text" class="form-input" placeholder="‰æãÂ¶ÇÔºöÊàëÁöÑË¥¶Âè∑" />
            </div>

            <div class="form-group">
              <label class="form-label">API Token</label>
              <input v-model="newAccount.token" type="password" class="form-input" placeholder="sk-xxxxxxxxxxxxxxxx" />
              <div class="form-help">
                Âú® Zeabur ÊéßÂà∂Âè∞ÁöÑËÆæÁΩÆ‰∏≠ÂàõÂª∫ API Token
              </div>
            </div>

            <div v-if="addAccountError" class="form-error">
              {{ addAccountError }}
            </div>

            <div v-if="addAccountSuccess" class="form-success">
              {{ addAccountSuccess }}
            </div>

            <button class="btn btn-primary" @click="addAccount" :disabled="addingAccount" style="width: 100%;">
              {{ addingAccount ? 'È™åËØÅ‰∏≠...' : 'Ê∑ªÂä†Ë¥¶Âè∑' }}
            </button>

            <button class="btn btn-secondary" @click="closeAddModal" style="width: 100%; margin-top: 8px;">
              ÂèñÊ∂à
            </button>
          </div>
        </div>

        <div v-if="accounts.length > 0" class="stats-grid">
          <div class="stat-card">
            <div class="stat-label">Ë¥¶Âè∑Êï∞</div>
            <div class="stat-value">{{ accounts.length }}</div>
          </div>
          <div class="stat-card">
            <div class="stat-label">È°πÁõÆÊÄªÊï∞</div>
            <div class="stat-value">{{ totalProjects }}</div>
          </div>
          <div class="stat-card">
            <div class="stat-label">ÊúçÂä°ÊÄªÊï∞</div>
            <div class="stat-value">{{ totalServices }}</div>
          </div>
          <div class="stat-card">
            <div class="stat-label">ËøêË°å‰∏≠</div>
            <div class="stat-value">{{ runningServices }}</div>
          </div>
          <div class="stat-card">
            <div class="stat-label">ÊÄªË¥πÁî®</div>
            <div class="stat-value">${{ totalCost.toFixed(2) }}</div>
          </div>
        </div>

        <div v-if="loading && accounts.length === 0" class="loading">
          ‚ö° Ê≠£Âú®Âä†ËΩΩÊï∞ÊçÆ...
        </div>

        <div v-for="account in accounts" :key="account.name" class="account-card">
          <div class="account-header" @click="toggleAccount(account.name)">
            <div class="account-info">
              <span style="font-size: 20px; transition: transform 0.3s; display: inline-flex; align-items: center;"
                :style="{ 
          /* ‰øùÊåÅ span ‰Ωú‰∏∫‰∏Ä‰∏™ÂÆπÂô®Ôºå‰∏çÊóãËΩ¨ÊàñÊóãËΩ¨Âà∞ÁâπÂÆöËßíÂ∫¶ */
          transform: isAccountExpanded(account.name) ? 'rotate(0deg)' : 'rotate(0deg)' 
      }">

                <i class="fas fa-chevron-right toggle-icon" :style="{ 
           transition: 'transform 0.4s cubic-bezier(0.4, 0, 0.2, 1)', 
           // ÈÄªËæëË∞ÉÊï¥Ôºö
           // Â±ïÂºÄ (true) -> 0deg (Âêë‰∏ã)
           // Êî∂Ëµ∑ (false) -> 90deg (ÂêëÂè≥)
           transform: isAccountExpanded(account.name) ? 'rotate(90deg)' : 'rotate(0deg)' 
       }">
                </i>
              </span>
              <div>
                <div class="account-name" v-if="!account.isEditingName" @dblclick.stop="startEditAccountName(account)">
                  {{ account.name }}
                </div>
                <div v-else class="account-name-edit" @click.stop>
                  <input v-model="account.editingName" @keyup.enter="saveAccountName(account)"
                    @keyup.esc="cancelEditAccountName(account)" @blur="saveAccountName(account)" class="edit-input"
                    ref="accountNameInput" style="width: 150px;" />
                  <button @click.stop="cancelEditAccountName(account)" class="cancel-btn" title="ÂèñÊ∂à"
                    style="margin-left: 4px;">
                    ‚úñÔ∏è
                  </button>
                </div>
                <div v-if="account.data" class="account-email">
                  {{ maskEmail(account.data.email) || account.data.username }}
                </div>
              </div>
            </div>
            <div class="account-balance">
              <div style="display: flex; flex-direction: column; gap: 3px;">
                <div class="balance-card credit-balance-card">
                  <div class="balance-icon">üí∞</div>
                  <div class="balance-amount" :class="getBalanceClass(account.data.credit)">
                    ${{ (account.data.credit / 100).toFixed(2) }}
                  </div>
                </div>
                <div class="balance-card ai-balance-card">
                  <div class="balance-icon">ü§ñ</div>
                  <div class="balance-amount">
                    {{ account.aihub && account.aihub.balance ? '$' + (account.aihub.balance / 100000).toFixed(2) : 'Êó†'
                    }}
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div v-if="account.error" class="error">
            ‚ùå ÈîôËØØ: {{ account.error }}
          </div>

          <div v-if="account.projects" class="projects-grid" :class="{ 'collapsed': !isAccountExpanded(account.name) }">
            <div v-for="project in account.projects" :key="project._id" :id="'proj-' + project._id"
              class="project-card">
              <div class="project-header">
                <div style="flex: 1;">
                  <div class="project-name">
                    <span v-if="!project.isEditing">üì¶ {{ project.name }}</span>
                    <input v-else v-model="project.editingName" @keyup.enter="saveProjectName(account, project)"
                      @keyup.esc="cancelEditProjectName(project)" @blur="saveProjectName(account, project)"
                      class="edit-input" ref="projectNameInput" />
                    <button v-if="!project.isEditing" @click="startEditProjectName(project)" class="edit-btn"
                      title="ÈáçÂëΩÂêçÈ°πÁõÆ">
                      ‚úèÔ∏è
                    </button>
                    <button v-else @click="cancelEditProjectName(project)" class="cancel-btn" title="ÂèñÊ∂à">
                      ‚úñÔ∏è
                    </button>
                  </div>
                  <div class="project-info">
                    üìç {{ project.region }}
                  </div>
                </div>
                <div style="text-align: right;">
                  <div style="font-size: 12px; color: var(--text-tertiary); margin-bottom: 2px;">Êú¨ÊúàÁî®Èáè</div>
                  <div class="project-cost"
                    :style="{ color: project.cost === 0 ? 'var(--info-color)' : 'var(--info-color)' }"
                    :title="project.cost === 0 ? 'ÊöÇÊó†Ë¥πÁî®ËÆ∞ÂΩï' : ''">
                    ${{ formatCost(project.cost) }}
                  </div>
                </div>
              </div>
              <div class="project-stats">
                <span>üîß {{ project.services.length }} ‰∏™ÊúçÂä°</span>
                <span>‚úÖ {{ project.services.filter(s => s.status === 'RUNNING').length }} ËøêË°å‰∏≠</span>
                <span>‚è∏Ô∏è {{ project.services.filter(s => s.status === 'SUSPENDED').length }} Â∑≤ÊöÇÂÅú</span>
              </div>
              <div class="services-container">
                <div v-for="service in project.services" :key="service._id"
                  :class="['service-item', service.status.toLowerCase()]">
                  <div class="service-header">
                    <div class="service-name" :title="service.name">
                      {{ service.name }}
                    </div>
                    <div :class="['service-status', service.status.toLowerCase()]">
                      {{ service.status === 'RUNNING' ? 'ËøêË°å‰∏≠' : service.status === 'SUSPENDED' ? 'Â∑≤ÊöÇÂÅú' : service.status
                      }}
                    </div>
                  </div>
                  <div v-if="service.resourceLimit" class="service-info">
                    <span style="display: inline-flex; align-items: center; gap: 4px; margin-right: 12px;">
                      <i class="fas fa-microchip"></i>
                      {{ service.resourceLimit.cpu }}m
                    </span>
                    <span style="display: inline-flex; align-items: center; gap: 4px;">
                      <i class="fas fa-memory"></i>
                      {{ service.resourceLimit.memory }}MB
                    </span>
                  </div>
                  <div class="service-actions">
                    <button v-if="service.status === 'RUNNING'" @click="pauseService(account, project, service)"
                      class="service-btn btn-pause">
                      <i class="fas fa-pause"></i>
                      ÊöÇÂÅú
                    </button>
                    <button @click="restartService(account, project, service)" class="service-btn btn-restart">
                      <i class="fas fa-redo"></i>
                      {{ service.status === 'SUSPENDED' ? 'ÂêØÂä®' : 'ÈáçÂêØ' }}
                    </button>
                    <button @click="showServiceLogs(account, project, service)" class="service-btn btn-logs">
                      <i class="fas fa-file-alt"></i>
                      Êó•Âøó
                    </button>
                  </div>
                </div>
                <div v-if="project.services.length === 0" class="empty-state">
                  ÊöÇÊó†ÊúçÂä°
                </div>
              </div>

              <!-- È°πÁõÆÂüüÂêç -->
              <div v-if="getProjectDomains(project).length > 0" class="domains-container">
                <a v-for="domainInfo in getProjectDomains(project)" :key="domainInfo.domain"
                  :href="'https://' + domainInfo.domain" target="_blank" class="domain-link">
                  <i class="fas fa-globe"></i>
                  <span>{{ domainInfo.domain }}</span>
                  <span v-if="domainInfo.isGenerated" class="domain-badge">Ëá™Âä®</span>
                </a>
              </div>
            </div>
          </div>
        </div>

        <div v-if="!loading && accounts.length === 0" class="error">
          Êú™ÈÖçÁΩÆË¥¶Âè∑ÊàñÊó†Ê≥ïËé∑ÂèñÊï∞ÊçÆ„ÄÇËØ∑Ê£ÄÊü• .env ÈÖçÁΩÆÊñá‰ª∂„ÄÇ
        </div>
      </div>
      <!-- ==================== Zeabur ÁõëÊéßÈÉ®ÂàÜÁªìÊùü ==================== -->

      <!-- ==================== DNS ÁÆ°ÁêÜÈÉ®ÂàÜ ==================== -->
      <div v-if="mainActiveTab === 'dns'">
        <!-- Toast -->
        <div v-if="dnsToast.show" class="toast" :class="dnsToast.type">{{ dnsToast.message }}</div>

        <!-- DNS Â≠êÊ†áÁ≠æÈ°µ -->
        <div class="dns-tabs">
          <button class="dns-tab-btn" :class="{ active: dnsCurrentTab === 'dns' }" @click="dnsCurrentTab = 'dns'">
            <i class="fas fa-globe"></i> DNS ËÆ∞ÂΩï
          </button>
          <button class="dns-tab-btn" :class="{ active: dnsCurrentTab === 'accounts' }"
            @click="dnsCurrentTab = 'accounts'">
            <i class="fas fa-users"></i> Ë¥¶Âè∑ÁÆ°ÁêÜ
          </button>
          <button class="dns-tab-btn" :class="{ active: dnsCurrentTab === 'templates' }"
            @click="dnsCurrentTab = 'templates'">
            <i class="fas fa-copy"></i> Ê®°Êùø
          </button>
        </div>

        <!-- DNS ËÆ∞ÂΩïÊ†áÁ≠æÈ°µ -->
        <div v-if="dnsCurrentTab === 'dns'">
          <!-- Ë¥¶Âè∑ÈÄâÊã© -->
          <div class="dns-account-select">
            <label style="font-weight: 500;">ÈÄâÊã©Ë¥¶Âè∑Ôºö</label>
            <select v-model="dnsSelectedAccountId" @change="loadDnsZones">
              <option value="">-- ËØ∑ÈÄâÊã©Ë¥¶Âè∑ --</option>
              <option v-for="acc in dnsAccounts" :key="acc.id" :value="acc.id">{{ acc.name }}</option>
            </select>
            <button v-if="dnsSelectedAccountId" class="btn btn-secondary" style="padding: 6px 10px;"
              @click="loadDnsZones" :disabled="dnsLoadingZones">
              <i class="fas fa-sync-alt" :class="{ 'fa-spin': dnsLoadingZones }"></i>
            </button>
          </div>

          <div v-if="dnsLoadingZones" class="loading">
            <div class="spinner"></div>
            <div style="margin-top: 12px;">Âä†ËΩΩÂüüÂêçÂàóË°®...</div>
          </div>

          <!-- ÂüüÂêçÁΩëÊ†º -->
          <div v-if="dnsSelectedAccountId && dnsZones.length > 0 && !dnsLoadingZones" class="zones-grid">
            <div v-for="zone in dnsZones" :key="zone.id" class="zone-card"
              :class="{ active: dnsSelectedZoneId === zone.id }" @click="selectDnsZone(zone)">
              <div>
                <div class="zone-name">{{ zone.name }}</div>
                <div class="zone-status" :class="zone.status">{{ zone.status }}</div>
              </div>
              <i class="fas fa-chevron-right" style="color: var(--text-tertiary);"></i>
            </div>
          </div>

          <div v-if="dnsSelectedAccountId && dnsZones.length === 0 && !dnsLoadingZones" class="empty-state">
            <i class="fas fa-globe" style="font-size: 48px; margin-bottom: 16px;"></i>
            <div>ËØ•Ë¥¶Âè∑‰∏ãÊ≤°ÊúâÂüüÂêç</div>
          </div>

          <!-- Âø´ÈÄüÂàáÊç¢ -->
          <div v-if="dnsSelectedZoneId" class="quick-switch">
            <i class="fas fa-bolt" style="color: var(--cf-color);"></i>
            <span style="font-weight: 500; white-space: nowrap;">Âø´ÈÄüÂàáÊç¢Ôºö</span>
            <select v-model="dnsQuickSwitchType"
              style="color: #f38020; padding: 6px 10px; border-radius: 4px; border: 1px solid var(--input-border); background: var(--input-bg); min-width: 80px;">
              <option value="A">A</option>
              <option value="AAAA">AAAA</option>
              <option value="CNAME">CNAME</option>
            </select>
            <input v-model="dnsQuickSwitchName" placeholder="ËÆ∞ÂΩïÂêçÁß∞ (Â¶Ç @, www, *)" />
            <input v-model="dnsQuickSwitchContent" placeholder="Êñ∞ÁöÑÂÜÖÂÆπ (IP ÊàñÂüüÂêç)" />
            <button class="btn btn-cf" style="padding: 6px 12px;" @click="dnsQuickSwitch" :disabled="dnsSwitching">
              {{ dnsSwitching ? 'ÂàáÊç¢‰∏≠...' : 'ÂàáÊç¢' }}
            </button>
          </div>

          <!-- DNS ËÆ∞ÂΩïË°®Ê†º -->
          <div v-if="dnsSelectedZoneId" class="panel">
            <div class="panel-header">
              <div class="panel-title">DNS ËÆ∞ÂΩï - {{ dnsSelectedZoneName }}</div>
              <div style="display: flex; gap: 8px;">
                <button class="btn btn-success" style="padding: 6px 12px;" @click="openAddDnsRecordModal">
                  <i class="fas fa-plus"></i> Ê∑ªÂä†ËÆ∞ÂΩï
                </button>
                <button class="btn btn-secondary" style="padding: 6px 10px;" @click="loadDnsRecords"
                  :disabled="dnsLoadingRecords">
                  <i class="fas fa-sync-alt" :class="{ 'fa-spin': dnsLoadingRecords }"></i>
                </button>
              </div>
            </div>

            <div v-if="dnsLoadingRecords" class="loading">
              <div class="spinner"></div>
              <div style="margin-top: 12px;">Âä†ËΩΩ‰∏≠...</div>
            </div>

            <div v-else class="table-container">
              <table class="data-table">
                <thead>
                  <tr>
                    <th style="width: 15%;">Á±ªÂûã</th>
                    <th style="width: 20%;">ÂêçÁß∞</th>
                    <th style="width: 30%;">ÂÜÖÂÆπ</th>
                    <th style="width: 10%;">‰ª£ÁêÜ</th>
                    <th style="width: 10%;">TTL</th>
                    <th style="width: 10%;">Êìç‰Ωú</th>
                  </tr>
                </thead>
                <tbody>
                  <tr v-for="record in dnsRecords" :key="record.id">
                    <td><span class="record-type" :class="record.type">{{ record.type }}</span></td>
                    <td>
                      <div v-if="!record.isEditingName" class="editable-cell"
                        :title="formatDnsRecordName(record.name) + ' (ÂèåÂáªÁºñËæë)'" @dblclick="startEditDnsName(record)">
                        {{ formatDnsRecordName(record.name) }}
                      </div>
                      <div v-else class="inline-edit-container" @click.stop>
                        <input v-model="record.editingName" class="inline-edit-input" @keyup.enter="saveDnsName(record)"
                          @keyup.esc="cancelEditDnsName(record)" @blur="saveDnsName(record)" ref="dnsNameInput" />
                        <button @click.stop="cancelEditDnsName(record)" class="inline-edit-cancel" title="ÂèñÊ∂à">
                          ‚úñÔ∏è
                        </button>
                      </div>
                    </td>
                    <td>
                      <div v-if="!record.isEditingContent" class="content-truncate editable-cell"
                        :title="record.content + ' (ÂèåÂáªÁºñËæë)'" @dblclick="startEditDnsContent(record)">
                        {{ record.content }}
                      </div>
                      <div v-else class="inline-edit-container" @click.stop>
                        <input v-model="record.editingContent" class="inline-edit-input"
                          @keyup.enter="saveDnsContent(record)" @keyup.esc="cancelEditDnsContent(record)"
                          @blur="saveDnsContent(record)" ref="dnsContentInput" />
                        <button @click.stop="cancelEditDnsContent(record)" class="inline-edit-cancel" title="ÂèñÊ∂à">
                          ‚úñÔ∏è
                        </button>
                      </div>
                    </td>
                    <td>
                      <span class="proxied-badge" :class="record.proxied ? 'proxied-on' : 'proxied-off'">
                        {{ record.proxied ? 'ÂºÄÂêØ' : 'ÂÖ≥Èó≠' }}
                      </span>
                    </td>
                    <td>{{ record.ttl === 1 ? 'Auto' : record.ttl }}</td>
                    <td class="actions">
                      <button class="btn btn-secondary" style="padding: 4px 8px; font-size: 12px;"
                        @click="editDnsRecord(record)" title="ÁºñËæë">
                        <i class="fas fa-edit"></i>
                      </button>
                      <button class="btn btn-danger" style="padding: 4px 8px; font-size: 12px;"
                        @click="deleteDnsRecord(record)" title="Âà†Èô§">
                        <i class="fas fa-trash"></i>
                      </button>
                    </td>
                  </tr>
                </tbody>
              </table>
              <div v-if="dnsRecords.length === 0" class="empty-state">ÊöÇÊó† DNS ËÆ∞ÂΩï</div>
            </div>
          </div>
        </div>

        <!-- CF Ë¥¶Âè∑ÁÆ°ÁêÜÊ†áÁ≠æÈ°µ -->
        <div v-if="dnsCurrentTab === 'accounts'">
          <div class="panel">
            <div class="panel-header">
              <div class="panel-title">Cloudflare Ë¥¶Âè∑</div>
              <button class="btn btn-success" style="padding: 6px 12px;" @click="openAddDnsAccountModal">
                <i class="fas fa-plus"></i> Ê∑ªÂä†Ë¥¶Âè∑
              </button>
            </div>

            <div class="table-container">
              <table class="data-table">
                <thead>
                  <tr>
                    <th>ÂêçÁß∞</th>
                    <th>ÈÇÆÁÆ±</th>
                    <th>Ê∑ªÂä†Êó∂Èó¥</th>
                    <th>ÊúÄÂêé‰ΩøÁî®</th>
                    <th style="width: 150px;">Êìç‰Ωú</th>
                  </tr>
                </thead>
                <tbody>
                  <tr v-for="acc in dnsAccounts" :key="acc.id">
                    <td>{{ acc.name }}</td>
                    <td>{{ acc.email || '-' }}</td>
                    <td>{{ formatDnsDate(acc.createdAt) }}</td>
                    <td>{{ acc.lastUsed ? formatDnsDate(acc.lastUsed) : '-' }}</td>
                    <td class="actions">
                      <button class="btn btn-secondary" style="padding: 4px 8px; font-size: 12px;"
                        @click="verifyDnsAccount(acc)" title="È™åËØÅToken">
                        <i class="fas fa-check"></i>
                      </button>
                      <button class="btn btn-danger" style="padding: 4px 8px; font-size: 12px;"
                        @click="deleteDnsAccount(acc)" title="Âà†Èô§">
                        <i class="fas fa-trash"></i>
                      </button>
                    </td>
                  </tr>
                </tbody>
              </table>
              <div v-if="dnsAccounts.length === 0" class="empty-state">
                <i class="fas fa-key" style="font-size: 48px; margin-bottom: 16px;"></i>
                <div>ÊöÇÊó†Ë¥¶Âè∑ÔºåËØ∑Ê∑ªÂä† Cloudflare API Token</div>
              </div>
            </div>
          </div>
        </div>

        <!-- Ê®°ÊùøÊ†áÁ≠æÈ°µ -->
        <div v-if="dnsCurrentTab === 'templates'">
          <div class="panel">
            <div class="panel-header">
              <div class="panel-title">DNS Ê®°Êùø</div>
              <button class="btn btn-success" style="padding: 6px 12px;" @click="openAddDnsTemplateModal">
                <i class="fas fa-plus"></i> Ê∑ªÂä†Ê®°Êùø
              </button>
            </div>

            <div class="table-container">
              <table class="data-table">
                <thead>
                  <tr>
                    <th>ÂêçÁß∞</th>
                    <th style="width: 60px;">Á±ªÂûã</th>
                    <th>ÂÜÖÂÆπ</th>
                    <th style="width: 70px;">‰ª£ÁêÜ</th>
                    <th>ÊèèËø∞</th>
                    <th style="width: 120px;">Êìç‰Ωú</th>
                  </tr>
                </thead>
                <tbody>
                  <tr v-for="tpl in dnsTemplates" :key="tpl.id">
                    <td>{{ tpl.name }}</td>
                    <td><span class="record-type" :class="tpl.type">{{ tpl.type }}</span></td>
                    <td>
                      <div class="content-truncate" :title="tpl.content">{{ tpl.content }}</div>
                    </td>
                    <td>
                      <span class="proxied-badge" :class="tpl.proxied ? 'proxied-on' : 'proxied-off'">
                        {{ tpl.proxied ? 'ÂºÄÂêØ' : 'ÂÖ≥Èó≠' }}
                      </span>
                    </td>
                    <td>{{ tpl.description || '-' }}</td>
                    <td class="actions">
                      <button class="btn btn-secondary" style="padding: 4px 8px; font-size: 12px;"
                        @click="editDnsTemplate(tpl)" title="ÁºñËæë">
                        <i class="fas fa-edit"></i>
                      </button>
                      <button class="btn btn-danger" style="padding: 4px 8px; font-size: 12px;"
                        @click="deleteDnsTemplate(tpl)" title="Âà†Èô§">
                        <i class="fas fa-trash"></i>
                      </button>
                    </td>
                  </tr>
                </tbody>
              </table>
              <div v-if="dnsTemplates.length === 0" class="empty-state">
                <i class="fas fa-copy" style="font-size: 48px; margin-bottom: 16px;"></i>
                <div>ÊöÇÊó†Ê®°ÊùøÔºåÊ∑ªÂä†Â∏∏Áî® DNS ÈÖçÁΩÆÊ®°Êùø‰ª•Âø´ÈÄüÂ∫îÁî®</div>
              </div>
            </div>
          </div>
        </div>

        <!-- Ê∑ªÂä† CF Ë¥¶Âè∑Ê®°ÊÄÅÊ°Ü -->
        <div v-if="showAddDnsAccountModal" class="modal-overlay" @click.self="showAddDnsAccountModal = false">
          <div class="modal">
            <div class="modal-header">
              <div class="modal-title">Ê∑ªÂä† Cloudflare Ë¥¶Âè∑</div>
              <button class="modal-close" @click="showAddDnsAccountModal = false">&times;</button>
            </div>

            <div class="form-group">
              <label class="form-label">Ë¥¶Âè∑ÂêçÁß∞ *</label>
              <input v-model="dnsAccountForm.name" class="form-input" placeholder="‰æãÂ¶Ç: ‰∏ªË¥¶Âè∑" />
            </div>

            <div class="form-group">
              <label class="form-label">API Token *</label>
              <input v-model="dnsAccountForm.apiToken" type="password" class="form-input"
                placeholder="Cloudflare API Token" />
              <div class="form-help">Âú® Cloudflare ÊéßÂà∂Âè∞ ‚Üí My Profile ‚Üí API Tokens ÂàõÂª∫</div>
            </div>

            <div class="form-group">
              <label class="form-label">ÈÇÆÁÆ±ÔºàÂèØÈÄâÔºâ</label>
              <input v-model="dnsAccountForm.email" class="form-input" placeholder="Áî®‰∫éÊ†áËØÜË¥¶Âè∑" />
            </div>

            <div v-if="dnsAccountFormError" class="form-error">{{ dnsAccountFormError }}</div>
            <div v-if="dnsAccountFormSuccess" class="form-success">{{ dnsAccountFormSuccess }}</div>

            <div style="display: flex; gap: 12px; margin-top: 20px;">
              <button class="btn btn-primary" @click="addDnsAccount" :disabled="dnsSavingAccount" style="flex: 1;">
                {{ dnsSavingAccount ? 'È™åËØÅ‰∏≠...' : 'Ê∑ªÂä†Ë¥¶Âè∑' }}
              </button>
              <button class="btn btn-secondary" @click="showAddDnsAccountModal = false" style="flex: 1;">ÂèñÊ∂à</button>
            </div>
          </div>
        </div>

        <!-- Ê∑ªÂä†/ÁºñËæë DNS ËÆ∞ÂΩïÊ®°ÊÄÅÊ°Ü -->
        <div v-if="showDnsRecordModal" class="modal-overlay" @click.self="showDnsRecordModal = false">
          <div class="modal">
            <div class="modal-header">
              <div class="modal-title">{{ dnsEditingRecord ? 'ÁºñËæë DNS ËÆ∞ÂΩï' : 'Ê∑ªÂä† DNS ËÆ∞ÂΩï' }}</div>
              <button class="modal-close" @click="showDnsRecordModal = false">&times;</button>
            </div>

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
              <div class="form-group">
                <label class="form-label">Á±ªÂûã *</label>
                <select v-model="dnsRecordForm.type" class="form-input" :disabled="!!dnsEditingRecord">
                  <option v-for="t in dnsRecordTypes" :key="t" :value="t">{{ t }}</option>
                </select>
              </div>
              <div class="form-group">
                <label class="form-label">ÂêçÁß∞ *</label>
                <input v-model="dnsRecordForm.name" class="form-input" placeholder="@ Êàñ www" />
                <div class="form-help">@ Ë°®Á§∫Ê†πÂüüÂêç</div>
              </div>
            </div>

            <div class="form-group">
              <label class="form-label">ÂÜÖÂÆπ *</label>
              <input v-model="dnsRecordForm.content" class="form-input" placeholder="IP Âú∞ÂùÄÊàñÁõÆÊ†áÂüüÂêç" />
            </div>

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
              <div class="form-group">
                <label class="form-label">TTL</label>
                <select v-model="dnsRecordForm.ttl" class="form-input">
                  <option :value="1">Auto</option>
                  <option :value="60">1 ÂàÜÈíü</option>
                  <option :value="300">5 ÂàÜÈíü</option>
                  <option :value="600">10 ÂàÜÈíü</option>
                  <option :value="3600">1 Â∞èÊó∂</option>
                  <option :value="86400">1 Â§©</option>
                </select>
              </div>
              <div class="form-group" v-if="dnsRecordForm.type === 'MX'">
                <label class="form-label">‰ºòÂÖàÁ∫ß</label>
                <input v-model.number="dnsRecordForm.priority" type="number" class="form-input" placeholder="10" />
              </div>
            </div>

            <div class="form-group" v-if="canDnsBeProxied(dnsRecordForm.type)">
              <label style="display: flex; align-items: center; gap: 8px; font-size: 14px; cursor: pointer;">
                <input type="checkbox" v-model="dnsRecordForm.proxied" style="width: 16px; height: 16px;" />
                ÂêØÁî® Cloudflare ‰ª£ÁêÜ (Ê©ô‰∫ë)
              </label>
              <div class="form-help">ÂêØÁî®ÂêéÊµÅÈáèÂ∞ÜÈÄöËøá Cloudflare CDN</div>
            </div>

            <div v-if="dnsRecordFormError" class="form-error">{{ dnsRecordFormError }}</div>

            <div style="display: flex; gap: 12px; margin-top: 20px;">
              <button class="btn btn-primary" @click="saveDnsRecord" :disabled="dnsSavingRecord" style="flex: 1;">
                {{ dnsSavingRecord ? '‰øùÂ≠ò‰∏≠...' : '‰øùÂ≠ò' }}
              </button>
              <button class="btn btn-secondary" @click="showDnsRecordModal = false" style="flex: 1;">ÂèñÊ∂à</button>
            </div>
          </div>
        </div>

        <!-- Ê∑ªÂä†/ÁºñËæëÊ®°ÊùøÊ®°ÊÄÅÊ°Ü -->
        <div v-if="showDnsTemplateModal" class="modal-overlay" @click.self="showDnsTemplateModal = false">
          <div class="modal">
            <div class="modal-header">
              <div class="modal-title">{{ dnsEditingTemplate ? 'ÁºñËæëÊ®°Êùø' : 'Ê∑ªÂä†Ê®°Êùø' }}</div>
              <button class="modal-close" @click="showDnsTemplateModal = false">&times;</button>
            </div>

            <div class="form-group">
              <label class="form-label">Ê®°ÊùøÂêçÁß∞ *</label>
              <input v-model="dnsTemplateForm.name" class="form-input" placeholder="‰æãÂ¶Ç: CDN ËÆ∞ÂΩï" />
            </div>

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
              <div class="form-group">
                <label class="form-label">ËÆ∞ÂΩïÁ±ªÂûã *</label>
                <select v-model="dnsTemplateForm.type" class="form-input">
                  <option v-for="t in dnsRecordTypes" :key="t" :value="t">{{ t }}</option>
                </select>
              </div>
              <div class="form-group">
                <label class="form-label">TTL</label>
                <select v-model="dnsTemplateForm.ttl" class="form-input">
                  <option :value="1">Auto</option>
                  <option :value="300">5 ÂàÜÈíü</option>
                  <option :value="3600">1 Â∞èÊó∂</option>
                </select>
              </div>
            </div>

            <div class="form-group">
              <label class="form-label">ÂÜÖÂÆπ *</label>
              <input v-model="dnsTemplateForm.content" class="form-input" placeholder="IP Âú∞ÂùÄÊàñÁõÆÊ†áÂüüÂêç" />
            </div>

            <div class="form-group">
              <label class="form-label">ÊèèËø∞ÔºàÂèØÈÄâÔºâ</label>
              <input v-model="dnsTemplateForm.description" class="form-input" placeholder="Ê®°ÊùøÁî®ÈÄîËØ¥Êòé" />
            </div>

            <div class="form-group" v-if="canDnsBeProxied(dnsTemplateForm.type)">
              <label style="display: flex; align-items: center; gap: 8px; font-size: 14px; cursor: pointer;">
                <input type="checkbox" v-model="dnsTemplateForm.proxied" style="width: 16px; height: 16px;" />
                ÂêØÁî® Cloudflare ‰ª£ÁêÜ
              </label>
            </div>

            <div v-if="dnsTemplateFormError" class="form-error">{{ dnsTemplateFormError }}</div>

            <div style="display: flex; gap: 12px; margin-top: 20px;">
              <button class="btn btn-primary" @click="saveDnsTemplate" :disabled="dnsSavingTemplate" style="flex: 1;">
                {{ dnsSavingTemplate ? '‰øùÂ≠ò‰∏≠...' : '‰øùÂ≠ò' }}
              </button>
              <button class="btn btn-secondary" @click="showDnsTemplateModal = false" style="flex: 1;">ÂèñÊ∂à</button>
            </div>
          </div>
        </div>

      </div>
      <!-- ==================== DNS ÁÆ°ÁêÜÈÉ®ÂàÜÁªìÊùü ==================== -->

    </div>
  </div>

  <script>
    const { createApp } = Vue;

    createApp({
      data() {
        return {
          accounts: [],
          loading: false,
          lastUpdate: '--:--:--',
          showAddModal: false,
          showManageModal: false,
          managedAccounts: [],
          projectCosts: {},
          newAccount: {
            name: '',
            token: '',
            balance: ''
          },
          addingAccount: false,
          addAccountError: '',
          addAccountSuccess: '',
          opacity: 39,
          expandedAccounts: {},
          refreshInterval: null,
          refreshing: false,
          lastFetchAt: 0,
          minFetchInterval: 2000,
          // ÂØÜÁ†ÅÈ™åËØÅ
          isAuthenticated: false,
          showLoginModal: false,
          showSetPasswordModal: false,
          loginPassword: '',
          loginError: '',
          setPassword: '',
          setPasswordConfirm: '',
          setPasswordError: '',
          // ÊâπÈáèÊ∑ªÂä†
          batchAccounts: '',
          maskedBatchAccounts: '',
          batchAddError: '',
          batchAddSuccess: '',
          // Êó•ÂøóÊ®°ÊÄÅÊ°Ü
          showLogsModal: false,
          logsModalTitle: '',
          logsModalInfo: {},
          logsContent: '',
          logsLoading: false,
          logsAutoScroll: true,
          logsFullscreen: false,
          logsScrollTimer: null,
          logsRealTime: true,
          logsRealTimeTimer: null,
          logsCurrentAccount: null,
          logsCurrentProject: null,
          logsCurrentService: null,
          // Âà∑Êñ∞ÂÄíËÆ°Êó∂
          refreshCountdown: 30,
          refreshProgress: 100,
          countdownInterval: null,
          refreshInterval: null,
          dataRefreshPaused: false,
          // ==================== DNS ÁÆ°ÁêÜÁõ∏ÂÖ≥Êï∞ÊçÆ ====================
          mainActiveTab: 'zeabur',
          // DNS Toast
          dnsToast: { show: false, message: '', type: 'success' },
          // DNS ÂΩìÂâçÊ†áÁ≠æÈ°µ
          dnsCurrentTab: 'dns',
          // CF Ë¥¶Âè∑Áõ∏ÂÖ≥
          dnsAccounts: [],
          dnsSelectedAccountId: '',
          showAddDnsAccountModal: false,
          dnsAccountForm: { name: '', apiToken: '', email: '' },
          dnsAccountFormError: '',
          dnsAccountFormSuccess: '',
          dnsSavingAccount: false,
          // ÂüüÂêçÁõ∏ÂÖ≥
          dnsZones: [],
          dnsSelectedZoneId: '',
          dnsSelectedZoneName: '',
          dnsLoadingZones: false,
          // DNS ËÆ∞ÂΩïÁõ∏ÂÖ≥
          dnsRecords: [],
          dnsLoadingRecords: false,
          showDnsRecordModal: false,
          dnsEditingRecord: null,
          dnsRecordForm: { type: 'A', name: '', content: '', ttl: 1, proxied: false, priority: 10 },
          dnsRecordFormError: '',
          dnsSavingRecord: false,
          dnsRecordTypes: ['A', 'AAAA', 'CNAME', 'TXT', 'MX', 'NS', 'SRV', 'CAA'],
          // Âø´ÈÄüÂàáÊç¢
          dnsQuickSwitchType: 'A',
          dnsQuickSwitchName: '',
          dnsQuickSwitchContent: '',
          dnsSwitching: false,
          // Ê®°ÊùøÁõ∏ÂÖ≥
          dnsTemplates: [],
          showDnsTemplateModal: false,
          dnsEditingTemplate: null,
          dnsTemplateForm: { name: '', type: 'A', content: '', ttl: 1, proxied: false, description: '' },
          dnsTemplateFormError: '',
          dnsSavingTemplate: false
        };
      },
      async mounted() {
        // Ê£ÄÊü•ÊúçÂä°Âô®ÊòØÂê¶Â∑≤ËÆæÁΩÆÂØÜÁ†Å
        const hasPasswordResponse = await fetch('/api/check-password');
        const { hasPassword } = await hasPasswordResponse.json();

        if (!hasPassword) {
          // È¶ñÊ¨°‰ΩøÁî®ÔºåÊòæÁ§∫ËÆæÁΩÆÂØÜÁ†ÅÁïåÈù¢
          this.showSetPasswordModal = true;
          return;
        }

        // Ê£ÄÊü•Êú¨Âú∞ÊòØÂê¶Êúâ‰øùÂ≠òÁöÑÂØÜÁ†ÅÂíåÊó∂Èó¥Êà≥
        const savedPassword = localStorage.getItem('admin_password');
        const savedTime = localStorage.getItem('password_time');

        if (savedPassword && savedTime) {
          const now = Date.now();
          const elapsed = now - parseInt(savedTime);
          const fourDays = 4 * 24 * 60 * 60 * 1000; // 4Â§©ÁöÑÊØ´ÁßíÊï∞

          if (elapsed < fourDays) {
            // 4Â§©ÂÜÖÔºåËá™Âä®ÁôªÂΩï
            this.loginPassword = savedPassword;
            await this.verifyPassword();
            return;
          }
        }

        // ÈúÄË¶ÅËæìÂÖ•ÂØÜÁ†Å
        this.showLoginModal = true;
      },
      watch: {
        opacity(newVal) {
          localStorage.setItem('card_opacity', newVal);
          this.updateOpacity();
        },
        showLogsModal(newVal) {
          if (newVal) {
            this.$nextTick(() => {
              this.setupAutoScroll();
              this.setupHorizontalScrollbar();
              if (this.logsRealTime) {
                this.startRealTimeRefresh();
              }
              // ËÆæÁΩÆÁÑ¶ÁÇπÂà∞Ê®°ÊÄÅÊ°ÜÔºåÁ°Æ‰øùESCÈîÆÂèØ‰ª•Â∑•‰Ωú
              const modalOverlay = document.querySelector('.modal-overlay.logs-fullscreen-overlay, .modal-overlay');
              if (modalOverlay) {
                modalOverlay.focus();
              }
              // Á¶ÅÁî®‰∏ªÁïåÈù¢ÊªöÂä®
              document.body.style.overflow = 'hidden';
            });
          } else {
            if (this.logsScrollTimer) {
              clearInterval(this.logsScrollTimer);
              this.logsScrollTimer = null;
            }
            this.stopRealTimeRefresh();
            this.logsRealTime = false;
            // ÊÅ¢Â§ç‰∏ªÁïåÈù¢ÊªöÂä®
            document.body.style.overflow = '';
          }
        },
        logsAutoScroll(newVal) {
          this.setupAutoScroll();
        },
        logsRealTime(newVal) {
          if (newVal) {
            this.startRealTimeRefresh();
          } else {
            this.stopRealTimeRefresh();
          }
        }
      },
      beforeUnmount() {
        // Ê∏ÖÁêÜÂÆöÊó∂Âô®ÔºåÈò≤Ê≠¢ÂÜÖÂ≠òÊ≥ÑÊºè
        if (this.refreshInterval) {
          clearInterval(this.refreshInterval);
        }
        if (this.countdownInterval) {
          clearInterval(this.countdownInterval);
        }
        if (this.logsScrollTimer) {
          clearInterval(this.logsScrollTimer);
        }
        if (this.logsRealTimeTimer) {
          clearInterval(this.logsRealTimeTimer);
        }
      },
      computed: {
        totalProjects() {
          let total = 0;
          for (const acc of this.accounts) {
            if (acc.projects) total += acc.projects.length;
          }
          return total;
        },
        totalServices() {
          let total = 0;
          for (const acc of this.accounts) {
            if (acc.projects) {
              for (const p of acc.projects) {
                if (p.services) total += p.services.length;
              }
            }
          }
          return total;
        },
        runningServices() {
          let total = 0;
          for (const acc of this.accounts) {
            if (acc.projects) {
              for (const p of acc.projects) {
                if (p.services) {
                  for (const s of p.services) {
                    if (s.status === 'RUNNING') total++;
                  }
                }
              }
            }
          }
          return total;
        },
        totalCost() {
          let total = 0;
          for (const acc of this.accounts) {
            // ‰ºòÂÖà‰ΩøÁî®Ë¥¶Âè∑ÁöÑ totalCostÔºàÊù•Ëá™ÂÆòÊñπ serviceCostsThisMonthÔºâ
            if (acc.data && acc.data.totalCost !== undefined) {
              total += acc.data.totalCost || 0;
            } else if (acc.projects) {
              // Â§áÁî®ÔºöÁ¥ØÂä†È°πÁõÆË¥πÁî®ÔºàÂΩìË¥¶Âè∑Ê≤°Êúâ totalCost Êó∂Ôºâ
              for (const p of acc.projects) {
                total += p.cost || 0;
              }
            }
          }
          return total;
        }
      },
      methods: {
        // ËÆæÁΩÆÂØÜÁ†ÅÔºàÈ¶ñÊ¨°Ôºâ
        async setAdminPassword() {
          this.setPasswordError = '';

          if (!this.setPassword || this.setPassword.length < 6) {
            this.setPasswordError = 'ÂØÜÁ†ÅÈïøÂ∫¶Ëá≥Â∞ë6‰Ωç';
            return;
          }

          if (this.setPassword !== this.setPasswordConfirm) {
            this.setPasswordError = '‰∏§Ê¨°ËæìÂÖ•ÁöÑÂØÜÁ†Å‰∏ç‰∏ÄËá¥';
            return;
          }

          try {
            const response = await fetch('/api/set-password', {
              method: 'POST',
              headers: { 'Content-Type': 'application/json' },
              body: JSON.stringify({ password: this.setPassword })
            });

            const result = await response.json();
            if (result.success) {
              // ËÆæÁΩÆÊàêÂäüÔºåËá™Âä®ÁôªÂΩï
              this.loginPassword = this.setPassword;
              localStorage.setItem('admin_password', this.setPassword);
              localStorage.setItem('password_time', Date.now().toString());

              this.showSetPasswordModal = false;
              this.isAuthenticated = true;

              await this.loadManagedAccounts();
              this.loadProjectCosts();
              this.fetchData();

              // ÂêØÂä®Ëá™Âä®Âà∑Êñ∞Ôºà‰ΩøÁî®Áªü‰∏ÄÊñπÊ≥ïÔºåÈÅøÂÖçÈáçÂ§çÂàõÂª∫ intervalÔºâ
              this.startAutoRefresh();

              // Âä†ËΩΩÈÄèÊòéÂ∫¶ËÆæÁΩÆ
              const savedOpacity = localStorage.getItem('card_opacity');
              if (savedOpacity) {
                this.opacity = parseInt(savedOpacity);
                this.updateOpacity();
              }
            } else {
              this.setPasswordError = result.error || 'ËÆæÁΩÆÂ§±Ë¥•';
            }
          } catch (error) {
            this.setPasswordError = 'ËÆæÁΩÆÂ§±Ë¥•: ' + error.message;
          }
        },
        // È™åËØÅÂØÜÁ†Å
        async verifyPassword() {
          this.loginError = '';
          try {
            const response = await fetch('/api/verify-password', {
              method: 'POST',
              headers: { 'Content-Type': 'application/json' },
              body: JSON.stringify({ password: this.loginPassword })
            });

            const result = await response.json();
            if (result.success) {
              this.isAuthenticated = true;
              this.showLoginModal = false;

              // ‰øùÂ≠òÂØÜÁ†ÅÂíåÊó∂Èó¥Êà≥
              localStorage.setItem('admin_password', this.loginPassword);
              localStorage.setItem('password_time', Date.now().toString());

              await this.loadManagedAccounts();
              this.loadProjectCosts();
              this.fetchData();

              // ÂêØÂä®Ëá™Âä®Âà∑Êñ∞Ôºà‰ΩøÁî®Áªü‰∏ÄÊñπÊ≥ïÔºåÈÅøÂÖçÈáçÂ§çÂàõÂª∫ intervalÔºâ
              this.startAutoRefresh();

              // Âä†ËΩΩÈÄèÊòéÂ∫¶ËÆæÁΩÆ
              const savedOpacity = localStorage.getItem('card_opacity');
              if (savedOpacity) {
                this.opacity = parseInt(savedOpacity);
                this.updateOpacity();
              }
            } else {
              this.loginError = 'ÂØÜÁ†ÅÈîôËØØÔºåËØ∑ÈáçËØï';
            }
          } catch (error) {
            this.loginError = 'È™åËØÅÂ§±Ë¥•: ' + error.message;
          }
        },
        // ÈÇÆÁÆ±ÊâìÁ†Å
        maskEmail(email) {
          if (!email || !email.includes('@')) return email;
          const [local, domain] = email.split('@');
          if (local.length <= 4) return email;
          const masked = local.substring(0, 2) + 'x'.repeat(local.length - 4) + local.substring(local.length - 2);
          return masked + '@' + domain;
        },
        // Ëé∑ÂèñËØ∑Ê±ÇÂ§¥ÔºàÂåÖÂê´ÂØÜÁ†ÅÔºâ
        getAuthHeaders() {
          return {
            'Content-Type': 'application/json',
            'x-admin-password': this.loginPassword
          };
        },
        async loadManagedAccounts() {
          try {
            // ‰ªéÊúçÂä°Âô®Âä†ËΩΩË¥¶Âè∑
            const response = await fetch('/api/server-accounts', {
              headers: this.getAuthHeaders()
            });
            const accounts = await response.json();
            if (accounts && accounts.length > 0) {
              this.managedAccounts = accounts;
              console.log(`üìã ‰ªéÊúçÂä°Âô®Âä†ËΩΩ ${accounts.length} ‰∏™Ë¥¶Âè∑`);
            }
          } catch (error) {
            console.log('‚ö†Ô∏è ‰ªéÊúçÂä°Âô®Âä†ËΩΩË¥¶Âè∑Â§±Ë¥•:', error.message);
          }
        },
        async saveManagedAccounts() {
          try {
            // ‰øùÂ≠òÂà∞ÊúçÂä°Âô®
            const response = await fetch('/api/server-accounts', {
              method: 'POST',
              headers: this.getAuthHeaders(),
              body: JSON.stringify({ accounts: this.managedAccounts })
            });
            const result = await response.json();
            if (result.success) {
              console.log('‚úÖ Ë¥¶Âè∑Â∑≤‰øùÂ≠òÂà∞ÊúçÂä°Âô®');
            }
          } catch (error) {
            console.error('‚ùå ‰øùÂ≠òË¥¶Âè∑Âà∞ÊúçÂä°Âô®Â§±Ë¥•:', error.message);
          }
        },
        loadProjectCosts() {
          const saved = localStorage.getItem('zeabur_project_costs');
          if (saved) {
            this.projectCosts = JSON.parse(saved);
          }
        },

        startAutoRefresh() {
          try {
            if (this.refreshInterval) {
              clearInterval(this.refreshInterval);
            }
            if (this.countdownInterval) {
              clearInterval(this.countdownInterval);
            }

            // ÈáçÁΩÆÂÄíËÆ°Êó∂
            this.refreshCountdown = 30;
            this.refreshProgress = 100;

            // 30sËá™Âä®Âà∑Êñ∞
            this.refreshInterval = setInterval(() => {
              console.log('Ëá™Âä®Âà∑Êñ∞Ëß¶Âèë');
              this.fetchData();
            }, 30000);

            // 1sÂÄíËÆ°Êó∂Êõ¥Êñ∞ÔºåÂà∞0Êó∂Á´ãÂç≥ÈáçÁΩÆ
            this.countdownInterval = setInterval(() => {
              this.refreshCountdown--;

              if (this.refreshCountdown <= 0) {
                // Âà∞0Êó∂Á´ãÂç≥ÈáçÁΩÆÔºåÊó†Âä®Áîª
                this.refreshCountdown = 30;
                this.refreshProgress = 100;
              } else {
                // Ê≠£Â∏∏ÈÄíÂáè
                this.refreshProgress = (this.refreshCountdown / 30) * 100;
              }
            }, 1000);
          } catch (e) {
            console.error('startAutoRefresh error', e);
          }
        },

        stopAutoRefresh() {
          if (this.refreshInterval) {
            clearInterval(this.refreshInterval);
            this.refreshInterval = null;
          }
          if (this.countdownInterval) {
            clearInterval(this.countdownInterval);
            this.countdownInterval = null;
          }
        },

        async fetchData() {
          // ËäÇÊµÅÔºöÂ¶ÇÊûúË∑ùÁ¶ª‰∏äÊ¨°ËØ∑Ê±ÇÂ§™Áü≠ÔºåË∑≥Ëøá
          const now = Date.now();
          if (now - this.lastFetchAt < this.minFetchInterval) return;
          if (this.refreshing) return; // Èò≤Ê≠¢Âπ∂ÂèëËØ∑Ê±Ç

          this.lastFetchAt = now;
          this.refreshing = true;
          this.loading = true;

          console.log('fetchData Ë¢´Ë∞ÉÁî®');

          // ÊâãÂä®Âà∑Êñ∞Êó∂ÈáçÁΩÆÂÄíËÆ°Êó∂
          this.refreshCountdown = 30;
          this.refreshProgress = 100;

          try {
            // Â¶ÇÊûúÊúâË¥¶Âè∑Ôºå‰ΩøÁî®Ë¥¶Âè∑
            if (this.managedAccounts.length > 0) {
              // Ê∏ÖÈô§Ë¥¶Âè∑‰∏≠ÁöÑÊâãÂä®‰ΩôÈ¢ùÔºåËÆ©ÊúçÂä°Âô®‰ΩøÁî® API ÁúüÂÆûÊï∞ÊçÆ
              const accountsWithoutManualBalance = this.managedAccounts.map(acc => ({
                ...acc,
                balance: null // ‰∏çÂèëÈÄÅÊâãÂä®‰ΩôÈ¢ù
              }));

              const [accountsRes, projectsRes] = await Promise.all([
                fetch('/api/temp-accounts', {
                  method: 'POST',
                  headers: this.getAuthHeaders(),
                  body: JSON.stringify({ accounts: accountsWithoutManualBalance })
                }).then(r => r.json()),
                fetch('/api/temp-projects', {
                  method: 'POST',
                  headers: this.getAuthHeaders(),
                  body: JSON.stringify({
                    accounts: accountsWithoutManualBalance,
                    projectCosts: {} // ‰∏çÂèëÈÄÅÊâãÂä®Ë¥πÁî®ÔºåËÆ©ÊúçÂä°Âô®Â∞ùËØï‰ªé API Ëé∑Âèñ
                  })
                }).then(r => r.json())
              ]);

              console.log('API ËøîÂõûÁöÑË¥¶Âè∑Êï∞ÊçÆ:', accountsRes);
              console.log('API ËøîÂõûÁöÑÈ°πÁõÆÊï∞ÊçÆ:', projectsRes);

              // ‰ΩøÁî®Vue.setÊàñÁõ¥Êé•ÈáçÊñ∞ËµãÂÄºÁ°Æ‰øùÂìçÂ∫îÂºèÊõ¥Êñ∞
              this.accounts = [];
              this.$nextTick(() => {
                this.accounts = accountsRes.map((account, index) => {
                  const projectData = projectsRes[index];
                  console.log(`Ë¥¶Âè∑ ${account.name} ‰ΩôÈ¢ù: ${account.data?.credit} (${account.data?.credit / 100} USD)`);
                  return {
                    ...account,
                    projects: projectData.projects || []
                  };
                });
              });
            } else {
              // Âê¶Âàô‰ΩøÁî®ÊúçÂä°Âô®ÈÖçÁΩÆÁöÑË¥¶Âè∑
              const [accountsRes, projectsRes] = await Promise.all([
                fetch('/api/accounts').then(r => r.json()),
                fetch('/api/projects').then(r => r.json())
              ]);

              // ‰ΩøÁî®Vue.setÊàñÁõ¥Êé•ÈáçÊñ∞ËµãÂÄºÁ°Æ‰øùÂìçÂ∫îÂºèÊõ¥Êñ∞
              this.accounts = [];
              this.$nextTick(() => {
                this.accounts = accountsRes.map((account, index) => {
                  const projectData = projectsRes[index];
                  return {
                    ...account,
                    projects: projectData.projects || []
                  };
                });
              });
            }
          } catch (error) {
            console.error('Ëé∑ÂèñÊï∞ÊçÆÂ§±Ë¥•:', error);
            alert('Ëé∑ÂèñÊï∞ÊçÆÂ§±Ë¥•: ' + error.message);
          } finally {
            this.loading = false;
            this.refreshing = false;
            // Âº∫Âà∂ÈáçÊñ∞Ê∏≤ÊüìÁªÑ‰ª∂
            this.$forceUpdate();
            console.log('Êï∞ÊçÆÊõ¥Êñ∞ÂÆåÊàêÔºåÂº∫Âà∂ÈáçÊñ∞Ê∏≤Êüì');
          }
        },
        getBalanceClass(credit) {
          const balance = credit / 100;
          if (balance < 10) return 'critical';
          if (balance < 50) return 'low';
          return '';
        },
        async batchAddAccounts() {
          this.batchAddError = '';
          this.batchAddSuccess = '';

          if (!this.batchAccounts.trim()) {
            this.batchAddError = 'ËØ∑ËæìÂÖ•Ë¥¶Âè∑‰ø°ÊÅØ';
            return;
          }

          const lines = this.batchAccounts.trim().split('\n');
          const accounts = [];

          // Ëß£ÊûêÊØè‰∏ÄË°å
          for (let i = 0; i < lines.length; i++) {
            const line = lines[i].trim();
            if (!line) continue;

            let name = '';
            let token = '';

            // Â∞ùËØïÂåπÈÖçÊã¨Âè∑Ê†ºÂºèÔºöÂêçÁß∞(token) Êàñ ÂêçÁß∞ÔºàtokenÔºâ
            const bracketMatch = line.match(/^(.+?)[Ôºà(](.+?)[Ôºâ)]$/);
            if (bracketMatch) {
              name = bracketMatch[1].trim();
              token = bracketMatch[2].trim();
            } else if (line.includes(':')) {
              // ÂÜíÂè∑Ê†ºÂºèÔºöÂêçÁß∞:token
              const parts = line.split(':');
              name = parts[0].trim();
              token = parts.slice(1).join(':').trim();
            } else if (line.includes('Ôºö')) {
              // ‰∏≠ÊñáÂÜíÂè∑Ê†ºÂºèÔºöÂêçÁß∞Ôºötoken
              const parts = line.split('Ôºö');
              name = parts[0].trim();
              token = parts.slice(1).join('Ôºö').trim();
            } else {
              this.batchAddError = `Á¨¨ ${i + 1} Ë°åÊ†ºÂºèÈîôËØØÔºåÊîØÊåÅÁöÑÊ†ºÂºèÔºöÂêçÁß∞:Token Êàñ ÂêçÁß∞ÔºöToken Êàñ ÂêçÁß∞(Token) Êàñ ÂêçÁß∞ÔºàTokenÔºâ`;
              return;
            }

            if (!name || !token) {
              this.batchAddError = `Á¨¨ ${i + 1} Ë°åÔºöË¥¶Âè∑ÂêçÁß∞Êàñ Token ‰∏çËÉΩ‰∏∫Á©∫`;
              return;
            }

            accounts.push({ name, token });
          }

          if (accounts.length === 0) {
            this.batchAddError = 'Ê≤°ÊúâÊúâÊïàÁöÑË¥¶Âè∑‰ø°ÊÅØ';
            return;
          }

          this.addingAccount = true;
          let successCount = 0;
          let failedAccounts = [];

          // ÈÄê‰∏™È™åËØÅÂπ∂Ê∑ªÂä†
          for (const account of accounts) {
            try {
              const response = await fetch('/api/validate-account', {
                method: 'POST',
                headers: this.getAuthHeaders(),
                body: JSON.stringify({
                  accountName: account.name,
                  apiToken: account.token
                })
              });

              const data = await response.json();

              if (response.ok) {
                // Ê£ÄÊü•ÊòØÂê¶Â∑≤Â≠òÂú®
                const exists = this.managedAccounts.some(acc => acc.name === account.name);
                if (!exists) {
                  this.managedAccounts.push({
                    name: account.name,
                    token: account.token,
                    email: data.userData.email,
                    username: data.userData.username
                  });
                  successCount++;
                } else {
                  failedAccounts.push(`${account.name}ÔºàÂ∑≤Â≠òÂú®Ôºâ`);
                }
              } else {
                failedAccounts.push(`${account.name}Ôºà${data.error || 'È™åËØÅÂ§±Ë¥•'}Ôºâ`);
              }
            } catch (error) {
              failedAccounts.push(`${account.name}ÔºàÁΩëÁªúÈîôËØØÔºâ`);
            }
          }

          this.addingAccount = false;

          if (successCount > 0) {
            await this.saveManagedAccounts();
            this.fetchData();
          }

          // ÊòæÁ§∫ÁªìÊûú
          if (successCount > 0 && failedAccounts.length === 0) {
            this.batchAddSuccess = `‚úÖ ÊàêÂäüÊ∑ªÂä† ${successCount} ‰∏™Ë¥¶Âè∑`;
            this.batchAccounts = '';
            this.maskedBatchAccounts = '';
          } else if (successCount > 0) {
            this.batchAddSuccess = `‚úÖ ÊàêÂäüÊ∑ªÂä† ${successCount} ‰∏™Ë¥¶Âè∑`;
            this.batchAddError = `‚ùå Â§±Ë¥•: ${failedAccounts.join(', ')}`;
          } else {
            this.batchAddError = `‚ùå ÂÖ®ÈÉ®Â§±Ë¥•: ${failedAccounts.join(', ')}`;
          }

          // 3ÁßíÂêéÊ∏ÖÈô§ÊèêÁ§∫
          setTimeout(() => {
            this.batchAddSuccess = '';
            if (successCount > 0 && failedAccounts.length === 0) {
              this.batchAddError = '';
            }
          }, 3000);
        },
        async addAccountToList() {
          if (!this.newAccount.name || !this.newAccount.token) {
            this.addAccountError = 'ËØ∑Â°´ÂÜôË¥¶Âè∑ÂêçÁß∞Âíå API Token';
            return;
          }

          this.addingAccount = true;
          this.addAccountError = '';
          this.addAccountSuccess = '';

          try {
            const response = await fetch('/api/validate-account', {
              method: 'POST',
              headers: this.getAuthHeaders(),
              body: JSON.stringify({
                accountName: this.newAccount.name,
                apiToken: this.newAccount.token
              })
            });

            const data = await response.json();

            if (response.ok) {
              // Ê∑ªÂä†Âà∞Êú¨Âú∞ÂàóË°®
              this.managedAccounts.push({
                name: this.newAccount.name,
                token: this.newAccount.token,
                balance: this.newAccount.balance ? parseFloat(this.newAccount.balance) : null,
                email: data.userData.email,
                username: data.userData.username
              });

              this.saveManagedAccounts();
              this.addAccountSuccess = `‚úÖ Ë¥¶Âè∑Ê∑ªÂä†ÊàêÂäüÔºÅÁî®Êà∑: ${data.userData.username}`;

              // Ê∏ÖÁ©∫Ë°®Âçï
              this.newAccount = { name: '', token: '', balance: '' };

              // Âà∑Êñ∞Êï∞ÊçÆ
              setTimeout(() => {
                this.fetchData();
                this.addAccountSuccess = '';
              }, 1500);
            } else {
              this.addAccountError = data.error || 'Ê∑ªÂä†Â§±Ë¥•';
            }
          } catch (error) {
            this.addAccountError = 'ÁΩëÁªúÈîôËØØ: ' + error.message;
          } finally {
            this.addingAccount = false;
          }
        },
        async removeAccount(index) {
          const accountName = this.managedAccounts[index].name;
          const password = prompt(`Âà†Èô§Ë¥¶Âè∑"${accountName}"ÈúÄË¶ÅÈ™åËØÅÁÆ°ÁêÜÂëòÂØÜÁ†ÅÔºö`);

          if (!password) return;

          // È™åËØÅÂØÜÁ†Å
          try {
            const response = await fetch('/api/verify-password', {
              method: 'POST',
              headers: { 'Content-Type': 'application/json' },
              body: JSON.stringify({ password })
            });

            const result = await response.json();
            if (result.success) {
              this.managedAccounts.splice(index, 1);
              await this.saveManagedAccounts();
              this.fetchData();
              alert('Ë¥¶Âè∑Â∑≤Âà†Èô§');
            } else {
              alert('ÂØÜÁ†ÅÈîôËØØÔºåÂà†Èô§Â§±Ë¥•');
            }
          } catch (error) {
            alert('È™åËØÅÂ§±Ë¥•: ' + error.message);
          }
        },
        closeAddModal() {
          this.showAddModal = false;
          this.newAccount = { name: '', token: '', balance: '' };
          this.addAccountError = '';
          this.addAccountSuccess = '';
        },
        closeManageModal() {
          this.showManageModal = false;
          this.newAccount = { name: '', token: '', balance: '' };
          this.addAccountError = '';
          this.addAccountSuccess = '';
        },
        updateOpacity() {
          const opacity = this.opacity / 100;
          const root = document.documentElement;
          if (!root) return; // Èò≤Ê≠¢ DOM Êú™Âä†ËΩΩ

          // ËÆæÁΩÆÊâÄÊúâÁõ∏ÂÖ≥ÁöÑCSSÂèòÈáè
          root.style.setProperty('--card-opacity', opacity);
          root.style.setProperty('--service-opacity', Math.min(opacity + 0.05, 1));
          root.style.setProperty('--blur-amount', `${20 * opacity}px`);
          root.style.setProperty('--blur-amount-small', `${15 * opacity}px`);
          root.style.setProperty('--blur-amount-tiny', `${10 * opacity}px`);
          root.style.setProperty('--saturate-amount', `${100 + 80 * opacity}%`);
          root.style.setProperty('--shadow-opacity', 0.1 * opacity);
          root.style.setProperty('--shadow-opacity-light', 0.05 * opacity);
          root.style.setProperty('--border-opacity', 0.3 * opacity);
          root.style.setProperty('--border-opacity-light', 0.4 * opacity);
          root.style.setProperty('--border-opacity-strong', 0.5 * opacity);
        },
        clearCache() {
          if (confirm('Á°ÆÂÆöË¶ÅÊ∏ÖÈô§ÊâÄÊúâÁºìÂ≠òÊï∞ÊçÆÂêóÔºüËøôÂ∞ÜÂà†Èô§ÊâÄÊúâÊú¨Âú∞‰øùÂ≠òÁöÑË¥¶Âè∑„ÄÅ‰ΩôÈ¢ùÂíåË¥πÁî®Êï∞ÊçÆ„ÄÇ')) {
            // Ê∏ÖÈô§ÊâÄÊúâÊú¨Âú∞Êï∞ÊçÆ
            this.managedAccounts = [];
            this.projectCosts = {};
            localStorage.removeItem('zeabur_accounts');
            localStorage.removeItem('zeabur_project_costs');

            alert('ÁºìÂ≠òÂ∑≤Ê∏ÖÈô§ÔºÅÊ≠£Âú®ÈáçÊñ∞Ëé∑ÂèñÊï∞ÊçÆ...');
            this.fetchData();
          }
        },
        toggleAccount(accountName) {
          // Á¨¨‰∏ÄÊ¨°ÁÇπÂáªÊó∂ÔºåÁ°Æ‰øùÁä∂ÊÄÅË¢´Ê≠£Á°ÆÂàùÂßãÂåñ
          if (!(accountName in this.expandedAccounts)) {
            this.expandedAccounts[accountName] = false;
          } else {
            this.expandedAccounts[accountName] = !this.expandedAccounts[accountName];
          }
        },
        isAccountExpanded(accountName) {
          // Â¶ÇÊûúÊ≤°ÊúâËÆæÁΩÆËøáÔºåÈªòËÆ§‰∏∫Â±ïÂºÄÁä∂ÊÄÅ
          if (!(accountName in this.expandedAccounts)) {
            return true;
          }
          return this.expandedAccounts[accountName];
        },
        // ÊöÇÂÅúÊúçÂä°
        async pauseService(account, project, service) {
          if (!confirm(`Á°ÆÂÆöË¶ÅÊöÇÂÅúÊúçÂä°"${service.name}"ÂêóÔºü`)) return;

          try {
            // Ëé∑ÂèñÁéØÂ¢É ID
            const environmentId = project.environments && project.environments[0] ? project.environments[0]._id : null;
            if (!environmentId) {
              alert('‚ùå Êó†Ê≥ïËé∑ÂèñÁéØÂ¢É IDÔºåËØ∑Âà∑Êñ∞È°µÈù¢ÂêéÈáçËØï');
              return;
            }

            // Ëé∑ÂèñË¥¶Âè∑ token
            const accountData = this.managedAccounts.find(acc => acc.name === account.name);
            if (!accountData || !accountData.token) {
              alert('‚ùå Êó†Ê≥ïËé∑ÂèñË¥¶Âè∑ tokenÔºåËØ∑ÈáçÊñ∞Ê∑ªÂä†Ë¥¶Âè∑');
              return;
            }

            const response = await fetch('/api/service/pause', {
              method: 'POST',
              headers: this.getAuthHeaders(),
              body: JSON.stringify({
                token: accountData.token,
                serviceId: service._id,
                environmentId: environmentId
              })
            });

            const result = await response.json();
            if (result.success) {
              alert('‚úÖ ÊúçÂä°Â∑≤ÊöÇÂÅú');
              this.fetchData();
            } else {
              alert('‚ùå ÊöÇÂÅúÂ§±Ë¥•: ' + (result.error || JSON.stringify(result)));
            }
          } catch (error) {
            alert('‚ùå Êìç‰ΩúÂ§±Ë¥•: ' + error.message);
          }
        },
        // ÈáçÂêØÊúçÂä°
        async restartService(account, project, service) {
          const action = service.status === 'SUSPENDED' ? 'ÂêØÂä®' : 'ÈáçÂêØ';
          if (!confirm(`Á°ÆÂÆöË¶Å${action}ÊúçÂä°"${service.name}"ÂêóÔºü`)) return;

          try {
            // Ëé∑ÂèñÁéØÂ¢É ID
            const environmentId = project.environments && project.environments[0] ? project.environments[0]._id : null;
            if (!environmentId) {
              alert('‚ùå Êó†Ê≥ïËé∑ÂèñÁéØÂ¢É IDÔºåËØ∑Âà∑Êñ∞È°µÈù¢ÂêéÈáçËØï');
              return;
            }

            // Ëé∑ÂèñË¥¶Âè∑ token
            const accountData = this.managedAccounts.find(acc => acc.name === account.name);
            if (!accountData || !accountData.token) {
              alert('‚ùå Êó†Ê≥ïËé∑ÂèñË¥¶Âè∑ tokenÔºåËØ∑ÈáçÊñ∞Ê∑ªÂä†Ë¥¶Âè∑');
              return;
            }

            const response = await fetch('/api/service/restart', {
              method: 'POST',
              headers: this.getAuthHeaders(),
              body: JSON.stringify({
                token: accountData.token,
                serviceId: service._id,
                environmentId: environmentId
              })
            });

            const result = await response.json();
            if (result.success) {
              alert(`‚úÖ ÊúçÂä°Â∑≤${action}`);
              this.fetchData();
            } else {
              alert(`‚ùå ${action}Â§±Ë¥•: ` + (result.error || JSON.stringify(result)));
            }
          } catch (error) {
            alert('‚ùå Êìç‰ΩúÂ§±Ë¥•: ' + error.message);
          }
        },
        // Êü•ÁúãÊúçÂä°Êó•Âøó
        async showServiceLogs(account, project, service) {
          this.logsModalTitle = 'ÊúçÂä°Êó•Âøó - ' + service.name;
          this.logsModalInfo = { project: project.name, account: account.name, count: 0, time: new Date().toLocaleString('zh-CN') };
          this.logsContent = '';
          this.logsLoading = true;
          this.logsAutoScroll = true;
          this.logsFullscreen = false;
          this.logsRealTime = true;
          this.logsCurrentAccount = account;
          this.logsCurrentProject = project;
          this.logsCurrentService = service;
          this.showLogsModal = true;

          try {
            const environmentId = project.environments && project.environments[0] ? project.environments[0]._id : null;
            if (!environmentId) { this.logsContent = '‚ùå Êó†Ê≥ïËé∑ÂèñÁéØÂ¢É ID'; this.logsLoading = false; return; }

            const accountData = this.managedAccounts.find(acc => acc.name === account.name);
            if (!accountData || !accountData.token) { this.logsContent = '‚ùå Êó†Ê≥ïËé∑ÂèñË¥¶Âè∑ token'; this.logsLoading = false; return; }

            const response = await fetch('/api/service/logs', {
              method: 'POST',
              headers: this.getAuthHeaders(),
              body: JSON.stringify({ token: accountData.token, serviceId: service._id, environmentId: environmentId, projectId: project._id, limit: 200 })
            });

            const result = await response.json();
            if (result.success && result.logs) {
              this.logsContent = result.logs.map(log => '[' + new Date(log.timestamp).toLocaleString('zh-CN') + '] ' + log.message).join('\n');
              this.logsModalInfo.count = result.count;

              // Á≠âÂæÖDOMÊõ¥Êñ∞ÂêéÊªöÂä®Âà∞Â∫ïÈÉ®Âπ∂ËÆæÁΩÆÊªöÂä®Êù°
              this.$nextTick(() => {
                this.scrollToBottom();
                this.setupHorizontalScrollbar();
              });
            } else {
              this.logsContent = '‚ùå Ëé∑ÂèñÊó•ÂøóÂ§±Ë¥•: ' + (result.error || 'Êú™Áü•ÈîôËØØ');
            }
          } catch (error) {
            this.logsContent = '‚ùå Ëé∑ÂèñÊó•ÂøóÂ§±Ë¥•: ' + error.message;
          } finally {
            this.logsLoading = false;
          }
        },
        toggleAutoScroll() {
          this.logsAutoScroll = !this.logsAutoScroll;
          if (this.logsAutoScroll) {
            this.scrollToBottom();
          }
        },
        toggleFullscreen() {
          this.logsFullscreen = !this.logsFullscreen;
          this.$nextTick(() => {
            if (this.logsAutoScroll) {
              this.scrollToBottom();
            }
          });
        },
        scrollToBottom() {
          if (this.$refs.logsText) {
            this.$refs.logsText.scrollTop = this.$refs.logsText.scrollHeight;
          }
        },
        setupAutoScroll() {
          if (this.logsScrollTimer) {
            clearInterval(this.logsScrollTimer);
          }

          if (this.logsAutoScroll && this.showLogsModal) {
            this.logsScrollTimer = setInterval(() => {
              this.scrollToBottom();
              this.updateHorizontalScrollbar();
            }, 1000);
          }
        },
        updateHorizontalScrollbar() {
          this.$nextTick(() => {
            const logsText = this.$refs.logsText;
            const scrollbar = this.$refs.logsScrollbar;
            const thumb = this.$refs.logsScrollbarThumb;

            if (!logsText || !scrollbar || !thumb) return;

            const contentWidth = logsText.scrollWidth;
            const viewportWidth = logsText.clientWidth;

            if (contentWidth <= viewportWidth) {
              scrollbar.style.display = 'none';
              return;
            }

            scrollbar.style.display = 'block';

            const maxScroll = contentWidth - viewportWidth;
            const currentScroll = logsText.scrollLeft;
            const scrollRatio = maxScroll > 0 ? currentScroll / maxScroll : 0;

            const thumbWidth = Math.max((viewportWidth / contentWidth) * 100, 5);
            const maxThumbLeft = 100 - thumbWidth;
            const thumbLeft = scrollRatio * maxThumbLeft;

            thumb.style.width = thumbWidth + '%';
            thumb.style.left = thumbLeft + '%';
          });
        },
        setupHorizontalScrollbar() {
          this.$nextTick(() => {
            const logsTextContainer = this.$refs.logsTextContainer;
            const logsText = this.$refs.logsText;
            const scrollbar = this.$refs.logsScrollbar;
            const thumb = this.$refs.logsScrollbarThumb;

            if (!logsText || !scrollbar || !thumb || !logsTextContainer) return;

            let isDragging = false;
            let dragStartX = 0;
            let dragStartThumbLeft = 0;

            // Êõ¥Êñ∞ÊªöÂä®Êù°Áä∂ÊÄÅ
            const updateScrollbar = () => {
              const contentWidth = logsText.scrollWidth;
              const viewportWidth = logsText.clientWidth;

              if (contentWidth <= viewportWidth) {
                scrollbar.style.display = 'none';
                return;
              }

              scrollbar.style.display = 'block';

              const maxScroll = contentWidth - viewportWidth;
              const currentScroll = logsText.scrollLeft;
              const scrollRatio = maxScroll > 0 ? currentScroll / maxScroll : 0;

              const thumbWidth = Math.max((viewportWidth / contentWidth) * 100, 5);
              const maxThumbLeft = 100 - thumbWidth;
              const thumbLeft = scrollRatio * maxThumbLeft;

              thumb.style.width = thumbWidth + '%';
              thumb.style.left = thumbLeft + '%';
            };

            // ÊªöÂä®Êù°‰ΩçÁΩÆËΩ¨Êç¢‰∏∫ÂÜÖÂÆπÊªöÂä®‰ΩçÁΩÆ
            const thumbPositionToScroll = (thumbLeftPercent) => {
              const contentWidth = logsText.scrollWidth;
              const viewportWidth = logsText.clientWidth;
              const maxScroll = contentWidth - viewportWidth;
              const thumbWidth = parseFloat(thumb.style.width) || 0;
              const maxThumbLeft = 100 - thumbWidth;

              if (maxThumbLeft <= 0) return 0;

              const scrollRatio = thumbLeftPercent / maxThumbLeft;
              return scrollRatio * maxScroll;
            };

            // ÁõëÂê¨ÂÜÖÂÆπÊªöÂä®
            logsText.addEventListener('scroll', updateScrollbar);

            // ÊªëÂùóÊãñÊãΩÂºÄÂßã
            thumb.addEventListener('mousedown', (e) => {
              isDragging = true;
              dragStartX = e.clientX;
              dragStartThumbLeft = parseFloat(thumb.style.left) || 0;
              thumb.style.cursor = 'grabbing';
              e.preventDefault();
              e.stopPropagation();
            });

            // ÊãñÊãΩ‰∏≠
            document.addEventListener('mousemove', (e) => {
              if (!isDragging) return;

              const scrollbarRect = scrollbar.getBoundingClientRect();
              const scrollbarWidth = scrollbarRect.width;
              const thumbWidth = thumb.clientWidth;
              const maxThumbLeftPx = scrollbarWidth - thumbWidth;

              if (maxThumbLeftPx <= 0) return;

              // ËÆ°ÁÆóÈº†Ê†áÁßªÂä®Ë∑ùÁ¶ªÂØπÂ∫îÁöÑÊªëÂùóÁßªÂä®Ë∑ùÁ¶ª
              const deltaX = e.clientX - dragStartX;
              const deltaThumbPercent = (deltaX / scrollbarWidth) * 100;
              const newThumbLeft = Math.max(0, Math.min(dragStartThumbLeft + deltaThumbPercent, 100 - (thumbWidth / scrollbarWidth * 100)));

              // ËÆæÁΩÆÊªëÂùó‰ΩçÁΩÆÂπ∂ÊªöÂä®ÂÜÖÂÆπ
              thumb.style.left = newThumbLeft + '%';
              const targetScroll = thumbPositionToScroll(newThumbLeft);
              logsText.scrollLeft = targetScroll;
            });

            // ÊãñÊãΩÁªìÊùü
            document.addEventListener('mouseup', () => {
              if (isDragging) {
                isDragging = false;
                thumb.style.cursor = 'grab';
              }
            });

            // ÁÇπÂáªÊªöÂä®Êù°Âå∫ÂüüË∑≥ËΩ¨
            scrollbar.addEventListener('click', (e) => {
              if (e.target === thumb) return;

              const scrollbarRect = scrollbar.getBoundingClientRect();
              const clickX = e.clientX - scrollbarRect.left;
              const scrollbarWidth = scrollbarRect.width;
              const thumbWidth = thumb.clientWidth;

              // ËÆ°ÁÆóÁõÆÊ†áÊªëÂùó‰ΩçÁΩÆÔºàËÆ©ÊªëÂùó‰∏≠ÂøÉÂØπÈΩêÂà∞ÁÇπÂáª‰ΩçÁΩÆÔºâ
              const targetThumbLeftPx = Math.max(0, Math.min(clickX - thumbWidth / 2, scrollbarWidth - thumbWidth));
              const targetThumbLeftPercent = (targetThumbLeftPx / scrollbarWidth) * 100;

              // ËÆæÁΩÆÊªëÂùó‰ΩçÁΩÆÂπ∂ÊªöÂä®ÂÜÖÂÆπ
              thumb.style.left = targetThumbLeftPercent + '%';
              const targetScroll = thumbPositionToScroll(targetThumbLeftPercent);
              logsText.scrollLeft = targetScroll;
            });

            // ÂàùÂßãÂåñÊªöÂä®Êù°
            // ÁõëÂê¨Á™óÂè£Â§ßÂ∞èÂèòÂåñ
            const resizeObserver = new ResizeObserver(() => {
              updateScrollbar();
            });
            resizeObserver.observe(logsText);

            // ÂàùÂßãÂåñ
            updateScrollbar();
          });
        },
        toggleRealTimeRefresh() {
          this.logsRealTime = !this.logsRealTime;
          if (this.logsRealTime) {
            this.startRealTimeRefresh();
          } else {
            this.stopRealTimeRefresh();
          }
        },
        toggleDataRefresh() {
          this.dataRefreshPaused = !this.dataRefreshPaused;
          if (this.dataRefreshPaused) {
            // ÊöÇÂÅúËá™Âä®Âà∑Êñ∞
            if (this.countdownInterval) {
              clearInterval(this.countdownInterval);
              this.countdownInterval = null;
            }
            if (this.refreshInterval) {
              clearInterval(this.refreshInterval);
              this.refreshInterval = null;
            }
          } else {
            // ÊÅ¢Â§çËá™Âä®Âà∑Êñ∞
            this.startCountdown();
            this.refreshInterval = setInterval(() => {
              this.fetchData();
            }, 30000);
          }
        },
        // ÂÆûÊó∂Âà∑Êñ∞Êó•Âøó
        startRealTimeRefresh() {
          if (this.logsRealTimeTimer) {
            clearInterval(this.logsRealTimeTimer);
          }

          if (this.logsRealTime && this.showLogsModal && this.logsCurrentAccount && this.logsCurrentProject && this.logsCurrentService) {
            this.logsRealTimeTimer = setInterval(async () => {
              await this.refreshLogs();
            }, 5000); // ÊØè5ÁßíÂà∑Êñ∞‰∏ÄÊ¨°
          }
        },

        // ÂÅúÊ≠¢ÂÆûÊó∂Âà∑Êñ∞
        stopRealTimeRefresh() {
          if (this.logsRealTimeTimer) {
            clearInterval(this.logsRealTimeTimer);
            this.logsRealTimeTimer = null;
          }
        },

        // Âà∑Êñ∞Êó•Âøó
        async refreshLogs() {
          if (!this.logsCurrentAccount || !this.logsCurrentProject || !this.logsCurrentService) return;

          try {
            const environmentId = this.logsCurrentProject.environments && this.logsCurrentProject.environments[0] ? this.logsCurrentProject.environments[0]._id : null;
            if (!environmentId) return;

            const accountData = this.managedAccounts.find(acc => acc.name === this.logsCurrentAccount.name);
            if (!accountData || !accountData.token) return;

            const response = await fetch('/api/service/logs', {
              method: 'POST',
              headers: this.getAuthHeaders(),
              body: JSON.stringify({
                token: accountData.token,
                serviceId: this.logsCurrentService._id,
                environmentId: environmentId,
                projectId: this.logsCurrentProject._id,
                limit: 200
              })
            });

            const result = await response.json();
            if (result.success && result.logs) {
              const newLogs = result.logs.map(log => '[' + new Date(log.timestamp).toLocaleString('zh-CN') + '] ' + log.message).join('\n');

              // Â¶ÇÊûúÊòØËá™Âä®ÊªöÂä®Áä∂ÊÄÅÔºå‰øùÊåÅÂú®Â∫ïÈÉ®
              const wasAtBottom = this.$refs.logsText && (this.$refs.logsText.scrollHeight - this.$refs.logsText.scrollTop <= this.$refs.logsText.clientHeight + 10);

              this.logsContent = newLogs;
              this.logsModalInfo.count = result.count;
              this.logsModalInfo.time = new Date().toLocaleString('zh-CN');

              this.$nextTick(() => {
                if (wasAtBottom && this.logsAutoScroll) {
                  this.scrollToBottom();
                }
                this.updateHorizontalScrollbar();
              });
            }
          } catch (error) {
            console.error('Âà∑Êñ∞Êó•ÂøóÂ§±Ë¥•:', error);
          }
        },
        // Âà∑Êñ∞Êó•Âøó
        async refreshLogs() {
          if (!this.logsCurrentAccount || !this.logsCurrentProject || !this.logsCurrentService) return;

          try {
            const environmentId = this.logsCurrentProject.environments && this.logsCurrentProject.environments[0] ? this.logsCurrentProject.environments[0]._id : null;
            if (!environmentId) return;

            const accountData = this.managedAccounts.find(acc => acc.name === this.logsCurrentAccount.name);
            if (!accountData || !accountData.token) return;

            const response = await fetch('/api/service/logs', {
              method: 'POST',
              headers: this.getAuthHeaders(),
              body: JSON.stringify({
                token: accountData.token,
                serviceId: this.logsCurrentService._id,
                environmentId: environmentId,
                projectId: this.logsCurrentProject._id,
                limit: 200
              })
            });

            const result = await response.json();
            if (result.success && result.logs) {
              const newLogs = result.logs.map(log => '[' + new Date(log.timestamp).toLocaleString('zh-CN') + '] ' + log.message).join('\n');

              // Âè™Âú®ÊúâÊñ∞Êó•ÂøóÊó∂Êõ¥Êñ∞
              if (newLogs !== this.logsContent) {
                this.logsContent = newLogs;
                this.logsModalInfo.count = result.count;
                this.logsModalInfo.time = new Date().toLocaleString('zh-CN');

                // Â¶ÇÊûúÂêØÁî®Ëá™Âä®ÊªöÂä®ÔºåÊªöÂä®Âà∞Â∫ïÈÉ®
                if (this.logsAutoScroll) {
                  this.$nextTick(() => {
                    this.scrollToBottom();
                    this.updateHorizontalScrollbar();
                  });
                }
              }
            }
          } catch (error) {
            console.error('Âà∑Êñ∞Êó•ÂøóÂ§±Ë¥•:', error);
          }
        },
        // Ê†ºÂºèÂåñË¥πÁî®ÊòæÁ§∫ÔºàÂ∞è‰∫é $0.01 ÊòæÁ§∫‰∏∫ $0.01Ôºâ
        formatCost(cost) {
          if (cost > 0 && cost < 0.01) {
            return '0.01';
          }
          return cost.toFixed(2);
        },
        // Êõ¥Êñ∞ÊâπÈáèÊ∑ªÂä†ÁöÑÊâìÁ†ÅÊòæÁ§∫
        updateBatchDisplay() {
          if (!this.batchAccounts) {
            this.maskedBatchAccounts = '';
            return;
          }
          const lines = this.batchAccounts.split('\n');
          this.maskedBatchAccounts = lines.map(line => {
            // Â∞ùËØïÂåπÈÖçÊã¨Âè∑Ê†ºÂºèÔºöÂêçÁß∞(token) Êàñ ÂêçÁß∞ÔºàtokenÔºâ
            const bracketMatch = line.match(/^(.+?)[Ôºà(](.+?)[Ôºâ)]$/);
            if (bracketMatch) {
              const name = bracketMatch[1];
              const bracket = line.includes('Ôºà') ? 'Ôºà' : '(';
              const closeBracket = line.includes('Ôºâ') ? 'Ôºâ' : ')';
              const maskedToken = bracketMatch[2].replace(/./g, '‚óè');
              return name + bracket + maskedToken + closeBracket;
            }

            // ÂÜíÂè∑Ê†ºÂºè
            let separatorIndex = -1;
            let separator = '';

            if (line.includes(':')) {
              separatorIndex = line.indexOf(':');
              separator = ':';
            } else if (line.includes('Ôºö')) {
              separatorIndex = line.indexOf('Ôºö');
              separator = 'Ôºö';
            }

            if (separatorIndex === -1) return line;

            const name = line.substring(0, separatorIndex);
            const token = line.substring(separatorIndex + 1);
            return name + separator + token.replace(/./g, '‚óè');
          }).join('\n');
        },
        // Ëé∑ÂèñÈ°πÁõÆÁöÑÊâÄÊúâÂüüÂêç
        getProjectDomains(project) {
          const domains = [];
          if (project.services) {
            project.services.forEach(service => {
              if (service.domains && service.domains.length > 0) {
                service.domains.forEach(d => {
                  if (d.domain) {
                    domains.push({
                      domain: d.domain,
                      isGenerated: d.isGenerated || false
                    });
                  }
                });
              }
            });
          }
          return domains;
        },
        // ÂºÄÂßãÁºñËæëÈ°πÁõÆÂêçÁß∞
        startEditProjectName(project) {
          project.isEditing = true;
          project.editingName = project.name;
          setTimeout(() => {
            try {
              // Âè™Âú®ÂΩìÂâçÈ°πÁõÆËåÉÂõ¥ÂÜÖÊü•ÊâæËæìÂÖ•ÔºåÈÅøÂÖçÂÖ®Â±Ä querySelectorAll
              const el = document.getElementById('proj-' + project._id);
              if (el) {
                const input = el.querySelector('.edit-input');
                if (input) input.focus();
              }
            } catch (e) { console.error(e); }
          }, 50);
        },
        // ÂèñÊ∂àÁºñËæëÈ°πÁõÆÂêçÁß∞
        cancelEditProjectName(project) {
          project.isEditing = false;
          project.editingName = '';
        },
        // ‰øùÂ≠òÈ°πÁõÆÂêçÁß∞
        async saveProjectName(account, project) {
          // Â¶ÇÊûú‰∏çÂú®ÁºñËæëÁä∂ÊÄÅÔºåÁõ¥Êé•ËøîÂõûÔºàÈÅøÂÖç blur ‰∫ã‰ª∂ÈáçÂ§çËß¶ÂèëÔºâ
          if (!project.isEditing) {
            return;
          }

          if (!project.editingName || project.editingName.trim() === '') {
            alert('‚ùå È°πÁõÆÂêçÁß∞‰∏çËÉΩ‰∏∫Á©∫');
            return;
          }

          if (project.editingName === project.name) {
            this.cancelEditProjectName(project);
            return;
          }

          try {
            const accountData = this.managedAccounts.find(acc => acc.name === account.name);
            if (!accountData || !accountData.token) {
              alert('‚ùå Êó†Ê≥ïËé∑ÂèñË¥¶Âè∑ tokenÔºåËØ∑ÈáçÊñ∞Ê∑ªÂä†Ë¥¶Âè∑');
              return;
            }

            const response = await fetch('/api/project/rename', {
              method: 'POST',
              headers: this.getAuthHeaders(),
              body: JSON.stringify({
                token: accountData.token,
                projectId: project._id,
                newName: project.editingName.trim()
              })
            });

            const result = await response.json();
            if (result.success) {
              project.name = project.editingName.trim();
              this.cancelEditProjectName(project);
              alert('‚úÖ È°πÁõÆÂêçÁß∞Â∑≤Êõ¥Êñ∞');
            } else {
              alert('‚ùå Êõ¥Êñ∞Â§±Ë¥•: ' + (result.error || 'Êú™Áü•ÈîôËØØ'));
            }
          } catch (error) {
            alert('‚ùå Êìç‰ΩúÂ§±Ë¥•: ' + error.message);
          }
        },
        // ÂºÄÂßãÁºñËæëË¥¶Âè∑ÂêçÁß∞
        startEditAccountName(account) {
          account.isEditingName = true;
          account.editingName = account.name;
          setTimeout(() => {
            try {
              const inputs = document.querySelectorAll('.account-name-edit .edit-input');
              if (inputs.length > 0) {
                inputs[inputs.length - 1].focus();
              }
            } catch (e) { console.error(e); }
          }, 50);
        },
        // ÂèñÊ∂àÁºñËæëË¥¶Âè∑ÂêçÁß∞
        cancelEditAccountName(account) {
          account.isEditingName = false;
          account.editingName = '';
        },
        // ‰øùÂ≠òË¥¶Âè∑ÂêçÁß∞
        async saveAccountName(account) {
          // Â¶ÇÊûú‰∏çÂú®ÁºñËæëÁä∂ÊÄÅÔºåÁõ¥Êé•ËøîÂõû
          if (!account.isEditingName) {
            return;
          }

          if (!account.editingName || account.editingName.trim() === '') {
            alert('‚ùå Ë¥¶Âè∑ÂêçÁß∞‰∏çËÉΩ‰∏∫Á©∫');
            return;
          }

          if (account.editingName === account.name) {
            this.cancelEditAccountName(account);
            return;
          }

          const newName = account.editingName.trim();
          const oldName = account.name;

          try {
            // Êõ¥Êñ∞ managedAccounts ‰∏≠ÁöÑË¥¶Âè∑ÂêçÁß∞
            const managedAccount = this.managedAccounts.find(acc => acc.name === oldName);
            if (managedAccount) {
              managedAccount.name = newName;
              account.name = newName;

              // ‰øùÂ≠òÂà∞ÊúçÂä°Âô®
              await this.saveManagedAccounts();

              this.cancelEditAccountName(account);
              console.log(`‚úÖ Ë¥¶Âè∑ÂêçÁß∞Â∑≤‰ªé "${oldName}" Êõ¥Êñ∞‰∏∫ "${newName}"`);
            } else {
              alert('‚ùå Êó†Ê≥ïÊâæÂà∞ÂØπÂ∫îÁöÑË¥¶Âè∑ÈÖçÁΩÆ');
            }
          } catch (error) {
            alert('‚ùå ‰øùÂ≠òÂ§±Ë¥•: ' + error.message);
          }
        },
        // ÂØºÂá∫ÊâÄÊúâË¥¶Âè∑‰∏∫JSONÊñá‰ª∂
        exportAllAccounts() {
          if (!this.managedAccounts || this.managedAccounts.length === 0) {
            alert('‚ùå Ê≤°ÊúâË¥¶Âè∑Êï∞ÊçÆÂèØÂØºÂá∫');
            return;
          }

          // ÂàõÂª∫ÂØºÂá∫Êï∞ÊçÆÁöÑÂâØÊú¨ÔºåÈÅøÂÖçÂåÖÂê´‰∏çÂøÖË¶ÅÁöÑVueÂìçÂ∫îÂºèÂ±ûÊÄß
          const exportData = this.managedAccounts.map(account => ({
            name: account.name,
            token: account.token,
            status: account.status,
            projects: account.projects || [],
            cost: account.cost || 0,
            lastUpdated: account.lastUpdated || null
          }));

          const dataStr = JSON.stringify(exportData, null, 2);
          const dataBlob = new Blob([dataStr], { type: 'application/json' });

          // ÂàõÂª∫‰∏ãËΩΩÈìæÊé•
          const url = URL.createObjectURL(dataBlob);
          const link = document.createElement('a');
          link.href = url;
          link.download = `zeabur-accounts-${new Date().toISOString().slice(0, 19).replace(/:/g, '-')}.json`;
          document.body.appendChild(link);
          link.click();
          document.body.removeChild(link);
          URL.revokeObjectURL(url);

          alert(`‚úÖ Â∑≤ÂØºÂá∫ ${exportData.length} ‰∏™Ë¥¶Âè∑`);
        },
        // ‰ªéJSONÊñá‰ª∂ÂØºÂÖ•ÊâÄÊúâË¥¶Âè∑
        importAllAccounts() {
          const input = document.createElement('input');
          input.type = 'file';
          input.accept = '.json';
          input.onchange = (event) => {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = (e) => {
              try {
                const importedData = JSON.parse(e.target.result);
                if (!Array.isArray(importedData)) {
                  alert('‚ùå Êó†ÊïàÁöÑJSONÊ†ºÂºèÔºöÊï∞ÊçÆÂ∫î‰∏∫Êï∞ÁªÑ');
                  return;
                }

                // È™åËØÅÂØºÂÖ•ÁöÑÊï∞ÊçÆÊ†ºÂºè
                const isValid = importedData.every(account =>
                  account.hasOwnProperty('name') && account.hasOwnProperty('token')
                );

                if (!isValid) {
                  alert('‚ùå JSONÊñá‰ª∂Ê†ºÂºè‰∏çÊ≠£Á°ÆÔºöÊØè‰∏™Ë¥¶Âè∑Â∫îÂåÖÂê´nameÂíåtokenÂ≠óÊÆµ');
                  return;
                }

                // Êõ¥Êñ∞managedAccountsÊï∞ÊçÆ
                this.managedAccounts = importedData.map(account => ({
                  name: account.name,
                  token: account.token,
                  status: account.status || 'unknown',
                  projects: account.projects || [],
                  cost: account.cost || 0,
                  lastUpdated: account.lastUpdated || null
                }));

                // ‰øùÂ≠òÂà∞ÊúçÂä°Âô®
                this.saveManagedAccounts();

                alert(`‚úÖ Â∑≤ÂØºÂÖ• ${importedData.length} ‰∏™Ë¥¶Âè∑`);
              } catch (error) {
                alert('‚ùå ÂØºÂÖ•Â§±Ë¥•: ' + error.message);
              }
            };
            reader.readAsText(file);
          };
          input.click();
        },

        // ==================== DNS ÁÆ°ÁêÜÁõ∏ÂÖ≥ÊñπÊ≥ï ====================

        // ÂàáÊç¢Âà∞ DNS Ê†áÁ≠æÈ°µ
        switchToDns() {
          this.mainActiveTab = 'dns';
          if (this.dnsAccounts.length === 0) {
            this.loadDnsAccounts();
          }
          this.loadDnsTemplates();
        },

        // ÊòæÁ§∫ Toast
        showDnsToast(message, type = 'success') {
          this.dnsToast = { show: true, message, type };
          setTimeout(() => {
            this.dnsToast.show = false;
          }, 3000);
        },

        // Âä†ËΩΩ CF Ë¥¶Âè∑ÂàóË°®
        async loadDnsAccounts() {
          try {
            const response = await fetch('/api/cf-dns/accounts', {
              headers: this.getAuthHeaders()
            });
            const data = await response.json();
            // API Áõ¥Êé•ËøîÂõûË¥¶Âè∑Êï∞ÁªÑ
            if (Array.isArray(data)) {
              this.dnsAccounts = data;
            } else if (data.error) {
              console.error('Âä†ËΩΩ CF Ë¥¶Âè∑Â§±Ë¥•:', data.error);
            }
          } catch (error) {
            console.error('Âä†ËΩΩ CF Ë¥¶Âè∑Â§±Ë¥•:', error);
          }
        },

        // Âä†ËΩΩÊ®°ÊùøÂàóË°®
        async loadDnsTemplates() {
          try {
            const response = await fetch('/api/cf-dns/templates', {
              headers: this.getAuthHeaders()
            });
            const data = await response.json();
            // API Áõ¥Êé•ËøîÂõûÊ®°ÊùøÊï∞ÁªÑ
            if (Array.isArray(data)) {
              this.dnsTemplates = data;
            } else if (data.error) {
              console.error('Âä†ËΩΩÊ®°ÊùøÂ§±Ë¥•:', data.error);
            }
          } catch (error) {
            console.error('Âä†ËΩΩÊ®°ÊùøÂ§±Ë¥•:', error);
          }
        },

        // ÊâìÂºÄÊ∑ªÂä† CF Ë¥¶Âè∑Ê®°ÊÄÅÊ°Ü
        openAddDnsAccountModal() {
          this.dnsAccountForm = { name: '', apiToken: '', email: '' };
          this.dnsAccountFormError = '';
          this.dnsAccountFormSuccess = '';
          this.showAddDnsAccountModal = true;
        },

        // Ê∑ªÂä† CF Ë¥¶Âè∑
        async addDnsAccount() {
          if (!this.dnsAccountForm.name || !this.dnsAccountForm.apiToken) {
            this.dnsAccountFormError = 'ËØ∑Â°´ÂÜôË¥¶Âè∑ÂêçÁß∞Âíå API Token';
            return;
          }

          this.dnsSavingAccount = true;
          this.dnsAccountFormError = '';
          this.dnsAccountFormSuccess = '';

          try {
            const response = await fetch('/api/cf-dns/accounts', {
              method: 'POST',
              headers: this.getAuthHeaders(),
              body: JSON.stringify(this.dnsAccountForm)
            });

            const data = await response.json();
            // API ËøîÂõû { success: true, account: {...} } Êàñ { error: '...' }
            if (response.ok && (data.success || data.account)) {
              this.dnsAccountFormSuccess = 'Ë¥¶Âè∑Ê∑ªÂä†ÊàêÂäüÔºÅ';
              await this.loadDnsAccounts();
              setTimeout(() => {
                this.showAddDnsAccountModal = false;
              }, 1000);
            } else {
              this.dnsAccountFormError = data.error || 'Ê∑ªÂä†Â§±Ë¥•';
            }
          } catch (error) {
            this.dnsAccountFormError = 'ÁΩëÁªúÈîôËØØ: ' + error.message;
          } finally {
            this.dnsSavingAccount = false;
          }
        },

        // È™åËØÅ CF Ë¥¶Âè∑
        async verifyDnsAccount(account) {
          try {
            const response = await fetch(`/api/cf-dns/accounts/${account.id}/verify`, {
              method: 'POST',
              headers: this.getAuthHeaders()
            });

            const data = await response.json();
            // API ËøîÂõû { valid: true/false, ... }
            if (data.valid) {
              this.showDnsToast('Token È™åËØÅÊàêÂäüÔºÅ', 'success');
            } else {
              this.showDnsToast('Token È™åËØÅÂ§±Ë¥•: ' + (data.error || 'Êó†ÊïàÁöÑ Token'), 'error');
            }
          } catch (error) {
            this.showDnsToast('È™åËØÅÂ§±Ë¥•: ' + error.message, 'error');
          }
        },

        // Âà†Èô§ CF Ë¥¶Âè∑
        async deleteDnsAccount(account) {
          if (!confirm(`Á°ÆÂÆöË¶ÅÂà†Èô§Ë¥¶Âè∑ "${account.name}" ÂêóÔºü`)) return;

          try {
            const response = await fetch(`/api/cf-dns/accounts/${account.id}`, {
              method: 'DELETE',
              headers: this.getAuthHeaders()
            });

            const data = await response.json();
            // API ËøîÂõû { success: true } Êàñ { error: '...' }
            if (response.ok && data.success) {
              this.showDnsToast('Ë¥¶Âè∑Â∑≤Âà†Èô§', 'success');
              await this.loadDnsAccounts();
              if (this.dnsSelectedAccountId === account.id) {
                this.dnsSelectedAccountId = '';
                this.dnsZones = [];
                this.dnsRecords = [];
              }
            } else {
              this.showDnsToast('Âà†Èô§Â§±Ë¥•: ' + (data.error || 'Êú™Áü•ÈîôËØØ'), 'error');
            }
          } catch (error) {
            this.showDnsToast('Âà†Èô§Â§±Ë¥•: ' + error.message, 'error');
          }
        },

        // Âä†ËΩΩÂüüÂêçÂàóË°®
        async loadDnsZones() {
          if (!this.dnsSelectedAccountId) {
            this.dnsZones = [];
            return;
          }

          this.dnsLoadingZones = true;
          this.dnsZones = [];
          this.dnsRecords = [];
          this.dnsSelectedZoneId = '';
          this.dnsSelectedZoneName = '';

          try {
            const response = await fetch(`/api/cf-dns/accounts/${this.dnsSelectedAccountId}/zones`, {
              headers: this.getAuthHeaders()
            });

            const data = await response.json();
            // API ËøîÂõû { zones: [...], pagination: {...} } Êàñ { error: '...' }
            if (data.zones) {
              this.dnsZones = data.zones;
            } else if (data.error) {
              this.showDnsToast('Âä†ËΩΩÂüüÂêçÂ§±Ë¥•: ' + data.error, 'error');
            }
          } catch (error) {
            this.showDnsToast('Âä†ËΩΩÂüüÂêçÂ§±Ë¥•: ' + error.message, 'error');
          } finally {
            this.dnsLoadingZones = false;
          }
        },

        // ÈÄâÊã©ÂüüÂêç
        selectDnsZone(zone) {
          this.dnsSelectedZoneId = zone.id;
          this.dnsSelectedZoneName = zone.name;
          this.loadDnsRecords();
        },

        // Âä†ËΩΩ DNS ËÆ∞ÂΩï
        async loadDnsRecords() {
          if (!this.dnsSelectedAccountId || !this.dnsSelectedZoneId) return;

          this.dnsLoadingRecords = true;
          this.dnsRecords = [];

          try {
            const response = await fetch(
              `/api/cf-dns/accounts/${this.dnsSelectedAccountId}/zones/${this.dnsSelectedZoneId}/records`,
              { headers: this.getAuthHeaders() }
            );

            const data = await response.json();
            // API ËøîÂõû { records: [...], pagination: {...} } Êàñ { error: '...' }
            if (data.records) {
              this.dnsRecords = data.records;
            } else if (data.error) {
              this.showDnsToast('Âä†ËΩΩËÆ∞ÂΩïÂ§±Ë¥•: ' + data.error, 'error');
            }
          } catch (error) {
            this.showDnsToast('Âä†ËΩΩËÆ∞ÂΩïÂ§±Ë¥•: ' + error.message, 'error');
          } finally {
            this.dnsLoadingRecords = false;
          }
        },

        // ÊâìÂºÄÊ∑ªÂä† DNS ËÆ∞ÂΩïÊ®°ÊÄÅÊ°Ü
        openAddDnsRecordModal() {
          this.dnsEditingRecord = null;
          this.dnsRecordForm = { type: 'A', name: '', content: '', ttl: 1, proxied: false, priority: 10 };
          this.dnsRecordFormError = '';
          this.showDnsRecordModal = true;
        },

        // ÁºñËæë DNS ËÆ∞ÂΩï
        editDnsRecord(record) {
          this.dnsEditingRecord = record;
          this.dnsRecordForm = {
            type: record.type,
            name: this.formatDnsRecordName(record.name),
            content: record.content,
            ttl: record.ttl,
            proxied: record.proxied || false,
            priority: record.priority || 10
          };
          this.dnsRecordFormError = '';
          this.showDnsRecordModal = true;
        },

        // ‰øùÂ≠ò DNS ËÆ∞ÂΩï
        async saveDnsRecord() {
          if (!this.dnsRecordForm.name || !this.dnsRecordForm.content) {
            this.dnsRecordFormError = 'ËØ∑Â°´ÂÜôÂêçÁß∞ÂíåÂÜÖÂÆπ';
            return;
          }

          this.dnsSavingRecord = true;
          this.dnsRecordFormError = '';

          try {
            const url = this.dnsEditingRecord
              ? `/api/cf-dns/accounts/${this.dnsSelectedAccountId}/zones/${this.dnsSelectedZoneId}/records/${this.dnsEditingRecord.id}`
              : `/api/cf-dns/accounts/${this.dnsSelectedAccountId}/zones/${this.dnsSelectedZoneId}/records`;

            const response = await fetch(url, {
              method: this.dnsEditingRecord ? 'PUT' : 'POST',
              headers: this.getAuthHeaders(),
              body: JSON.stringify(this.dnsRecordForm)
            });

            const data = await response.json();
            // API ËøîÂõû { success: true, record: {...} } Êàñ { error: '...' }
            if (response.ok && (data.success || data.record)) {
              this.showDnsToast(this.dnsEditingRecord ? 'ËÆ∞ÂΩïÂ∑≤Êõ¥Êñ∞' : 'ËÆ∞ÂΩïÂ∑≤Ê∑ªÂä†', 'success');
              this.showDnsRecordModal = false;
              await this.loadDnsRecords();
            } else {
              this.dnsRecordFormError = data.error || '‰øùÂ≠òÂ§±Ë¥•';
            }
          } catch (error) {
            this.dnsRecordFormError = '‰øùÂ≠òÂ§±Ë¥•: ' + error.message;
          } finally {
            this.dnsSavingRecord = false;
          }
        },

        // Âà†Èô§ DNS ËÆ∞ÂΩï
        async deleteDnsRecord(record) {
          if (!confirm(`Á°ÆÂÆöË¶ÅÂà†Èô§ËÆ∞ÂΩï "${record.name}" ÂêóÔºü`)) return;

          try {
            const response = await fetch(
              `/api/cf-dns/accounts/${this.dnsSelectedAccountId}/zones/${this.dnsSelectedZoneId}/records/${record.id}`,
              {
                method: 'DELETE',
                headers: this.getAuthHeaders()
              }
            );

            const data = await response.json();
            // API ËøîÂõû { success: true } Êàñ { error: '...' }
            if (response.ok && data.success) {
              this.showDnsToast('ËÆ∞ÂΩïÂ∑≤Âà†Èô§', 'success');
              await this.loadDnsRecords();
            } else {
              this.showDnsToast('Âà†Èô§Â§±Ë¥•: ' + (data.error || 'Êú™Áü•ÈîôËØØ'), 'error');
            }
          } catch (error) {
            this.showDnsToast('Âà†Èô§Â§±Ë¥•: ' + error.message, 'error');
          }
        },

        // Âø´ÈÄüÂàáÊç¢ DNS ËÆ∞ÂΩï
        async dnsQuickSwitch() {
          if (!this.dnsQuickSwitchName || !this.dnsQuickSwitchContent) {
            this.showDnsToast('ËØ∑Â°´ÂÜôËÆ∞ÂΩïÂêçÁß∞ÂíåÊñ∞ÂÜÖÂÆπ', 'error');
            return;
          }

          this.dnsSwitching = true;

          try {
            // ‰ΩøÁî®Ê≠£Á°ÆÁöÑ API Á´ØÁÇπ /switch
            const response = await fetch(
              `/api/cf-dns/accounts/${this.dnsSelectedAccountId}/zones/${this.dnsSelectedZoneId}/switch`,
              {
                method: 'POST',
                headers: this.getAuthHeaders(),
                body: JSON.stringify({
                  type: this.dnsQuickSwitchType,
                  name: this.dnsQuickSwitchName,
                  newContent: this.dnsQuickSwitchContent
                })
              }
            );

            const data = await response.json();
            // API ËøîÂõû { success: true, updated: n, records: [...] } Êàñ { error: '...' }
            if (response.ok && data.success) {
              this.showDnsToast(`ÂàáÊç¢ÊàêÂäüÔºÅÊõ¥Êñ∞‰∫Ü ${data.updated || 0} Êù°ËÆ∞ÂΩï`, 'success');
              this.dnsQuickSwitchName = '';
              this.dnsQuickSwitchContent = '';
              await this.loadDnsRecords();
            } else {
              this.showDnsToast('ÂàáÊç¢Â§±Ë¥•: ' + (data.error || 'Êú™Áü•ÈîôËØØ'), 'error');
            }
          } catch (error) {
            this.showDnsToast('ÂàáÊç¢Â§±Ë¥•: ' + error.message, 'error');
          } finally {
            this.dnsSwitching = false;
          }
        },

        // ÊâìÂºÄÊ∑ªÂä†Ê®°ÊùøÊ®°ÊÄÅÊ°Ü
        openAddDnsTemplateModal() {
          this.dnsEditingTemplate = null;
          this.dnsTemplateForm = { name: '', type: 'A', content: '', ttl: 1, proxied: false, description: '' };
          this.dnsTemplateFormError = '';
          this.showDnsTemplateModal = true;
        },

        // ÁºñËæëÊ®°Êùø
        editDnsTemplate(template) {
          this.dnsEditingTemplate = template;
          this.dnsTemplateForm = { ...template };
          this.dnsTemplateFormError = '';
          this.showDnsTemplateModal = true;
        },

        // ‰øùÂ≠òÊ®°Êùø
        async saveDnsTemplate() {
          if (!this.dnsTemplateForm.name || !this.dnsTemplateForm.content) {
            this.dnsTemplateFormError = 'ËØ∑Â°´ÂÜôÊ®°ÊùøÂêçÁß∞ÂíåÂÜÖÂÆπ';
            return;
          }

          this.dnsSavingTemplate = true;
          this.dnsTemplateFormError = '';

          try {
            const url = this.dnsEditingTemplate
              ? `/api/cf-dns/templates/${this.dnsEditingTemplate.id}`
              : '/api/cf-dns/templates';

            const response = await fetch(url, {
              method: this.dnsEditingTemplate ? 'PUT' : 'POST',
              headers: this.getAuthHeaders(),
              body: JSON.stringify(this.dnsTemplateForm)
            });

            const data = await response.json();
            // API ËøîÂõû { success: true, template: {...} } Êàñ { error: '...' }
            if (response.ok && (data.success || data.template)) {
              this.showDnsToast(this.dnsEditingTemplate ? 'Ê®°ÊùøÂ∑≤Êõ¥Êñ∞' : 'Ê®°ÊùøÂ∑≤Ê∑ªÂä†', 'success');
              this.showDnsTemplateModal = false;
              await this.loadDnsTemplates();
            } else {
              this.dnsTemplateFormError = data.error || '‰øùÂ≠òÂ§±Ë¥•';
            }
          } catch (error) {
            this.dnsTemplateFormError = '‰øùÂ≠òÂ§±Ë¥•: ' + error.message;
          } finally {
            this.dnsSavingTemplate = false;
          }
        },

        // Âà†Èô§Ê®°Êùø
        async deleteDnsTemplate(template) {
          if (!confirm(`Á°ÆÂÆöË¶ÅÂà†Èô§Ê®°Êùø "${template.name}" ÂêóÔºü`)) return;

          try {
            const response = await fetch(`/api/cf-dns/templates/${template.id}`, {
              method: 'DELETE',
              headers: this.getAuthHeaders()
            });

            const data = await response.json();
            // API ËøîÂõû { success: true } Êàñ { error: '...' }
            if (response.ok && data.success) {
              this.showDnsToast('Ê®°ÊùøÂ∑≤Âà†Èô§', 'success');
              await this.loadDnsTemplates();
            } else {
              this.showDnsToast('Âà†Èô§Â§±Ë¥•: ' + (data.error || 'Êú™Áü•ÈîôËØØ'), 'error');
            }
          } catch (error) {
            this.showDnsToast('Âà†Èô§Â§±Ë¥•: ' + error.message, 'error');
          }
        },

        // Ê†ºÂºèÂåñ DNS ËÆ∞ÂΩïÂêçÁß∞
        formatDnsRecordName(name) {
          if (!name || !this.dnsSelectedZoneName) return name;
          const suffix = '.' + this.dnsSelectedZoneName;
          if (name === this.dnsSelectedZoneName) return '@';
          if (name.endsWith(suffix)) {
            return name.slice(0, -suffix.length);
          }
          return name;
        },

        // Ê†ºÂºèÂåñÊó•Êúü
        formatDnsDate(dateStr) {
          if (!dateStr) return '-';
          const date = new Date(dateStr);
          return date.toLocaleDateString('zh-CN');
        },

        // Âà§Êñ≠ËÆ∞ÂΩïÁ±ªÂûãÊòØÂê¶ÂèØ‰ª•ÂºÄÂêØ‰ª£ÁêÜ
        canDnsBeProxied(type) {
          return ['A', 'AAAA', 'CNAME'].includes(type);
        },

        // ÂºÄÂßãÂèåÂáªÁºñËæë DNS ËÆ∞ÂΩïÂêçÁß∞
        startEditDnsName(record) {
          // ÂèñÊ∂àÂÖ∂‰ªñÊ≠£Âú®ÁºñËæëÁöÑËÆ∞ÂΩï
          this.dnsRecords.forEach(r => {
            if (r.isEditingName) {
              r.isEditingName = false;
            }
            if (r.isEditingContent) {
              r.isEditingContent = false;
            }
          });

          record.isEditingName = true;
          record.editingName = this.formatDnsRecordName(record.name);

          // Á≠âÂæÖ DOM Êõ¥Êñ∞ÂêéËÅöÁÑ¶ËæìÂÖ•Ê°Ü
          this.$nextTick(() => {
            const inputs = document.querySelectorAll('.inline-edit-input');
            if (inputs.length > 0) {
              inputs[inputs.length - 1].focus();
              inputs[inputs.length - 1].select();
            }
          });
        },

        // ÂèñÊ∂àÁºñËæë DNS ËÆ∞ÂΩïÂêçÁß∞
        cancelEditDnsName(record) {
          record.isEditingName = false;
          record.editingName = '';
        },

        // ‰øùÂ≠òÂèåÂáªÁºñËæëÁöÑ DNS ËÆ∞ÂΩïÂêçÁß∞
        async saveDnsName(record) {
          // Â¶ÇÊûú‰∏çÂú®ÁºñËæëÁä∂ÊÄÅÔºåÁõ¥Êé•ËøîÂõû
          if (!record.isEditingName) {
            return;
          }

          const originalName = this.formatDnsRecordName(record.name);

          // Â¶ÇÊûúÂêçÁß∞Ê≤°ÊúâÂèòÂåñÔºåÂèñÊ∂àÁºñËæë
          if (record.editingName === originalName) {
            this.cancelEditDnsName(record);
            return;
          }

          // È™åËØÅÂêçÁß∞‰∏ç‰∏∫Á©∫
          if (!record.editingName || record.editingName.trim() === '') {
            this.showDnsToast('ÂêçÁß∞‰∏çËÉΩ‰∏∫Á©∫', 'error');
            return;
          }

          try {
            const response = await fetch(
              `/api/cf-dns/accounts/${this.dnsSelectedAccountId}/zones/${this.dnsSelectedZoneId}/records/${record.id}`,
              {
                method: 'PUT',
                headers: this.getAuthHeaders(),
                body: JSON.stringify({
                  type: record.type,
                  name: record.editingName.trim(),
                  content: record.content,
                  ttl: record.ttl,
                  proxied: record.proxied || false
                })
              }
            );

            const data = await response.json();
            if (response.ok && (data.success || data.record)) {
              // ÈáçÊñ∞Âä†ËΩΩËÆ∞ÂΩï‰ª•Ëé∑ÂèñÊõ¥Êñ∞ÂêéÁöÑÂÆåÊï¥ÂêçÁß∞
              this.cancelEditDnsName(record);
              this.showDnsToast('ËÆ∞ÂΩïÂêçÁß∞Â∑≤Êõ¥Êñ∞', 'success');
              await this.loadDnsRecords();
            } else {
              this.showDnsToast('‰øùÂ≠òÂ§±Ë¥•: ' + (data.error || 'Êú™Áü•ÈîôËØØ'), 'error');
            }
          } catch (error) {
            this.showDnsToast('‰øùÂ≠òÂ§±Ë¥•: ' + error.message, 'error');
          }
        },

        // ÂºÄÂßãÂèåÂáªÁºñËæë DNS ËÆ∞ÂΩïÂÜÖÂÆπ
        startEditDnsContent(record) {
          // ÂèñÊ∂àÂÖ∂‰ªñÊ≠£Âú®ÁºñËæëÁöÑËÆ∞ÂΩï
          this.dnsRecords.forEach(r => {
            if (r.isEditingContent) {
              r.isEditingContent = false;
            }
          });

          record.isEditingContent = true;
          record.editingContent = record.content;

          // Á≠âÂæÖ DOM Êõ¥Êñ∞ÂêéËÅöÁÑ¶ËæìÂÖ•Ê°Ü
          this.$nextTick(() => {
            const inputs = document.querySelectorAll('.inline-edit-input');
            if (inputs.length > 0) {
              inputs[inputs.length - 1].focus();
              inputs[inputs.length - 1].select();
            }
          });
        },

        // ÂèñÊ∂àÁºñËæë DNS ËÆ∞ÂΩïÂÜÖÂÆπ
        cancelEditDnsContent(record) {
          record.isEditingContent = false;
          record.editingContent = '';
        },

        // ‰øùÂ≠òÂèåÂáªÁºñËæëÁöÑ DNS ËÆ∞ÂΩïÂÜÖÂÆπ
        async saveDnsContent(record) {
          // Â¶ÇÊûú‰∏çÂú®ÁºñËæëÁä∂ÊÄÅÔºåÁõ¥Êé•ËøîÂõû
          if (!record.isEditingContent) {
            return;
          }

          // Â¶ÇÊûúÂÜÖÂÆπÊ≤°ÊúâÂèòÂåñÔºåÂèñÊ∂àÁºñËæë
          if (record.editingContent === record.content) {
            this.cancelEditDnsContent(record);
            return;
          }

          // È™åËØÅÂÜÖÂÆπ‰∏ç‰∏∫Á©∫
          if (!record.editingContent || record.editingContent.trim() === '') {
            this.showDnsToast('ÂÜÖÂÆπ‰∏çËÉΩ‰∏∫Á©∫', 'error');
            return;
          }

          try {
            const response = await fetch(
              `/api/cf-dns/accounts/${this.dnsSelectedAccountId}/zones/${this.dnsSelectedZoneId}/records/${record.id}`,
              {
                method: 'PUT',
                headers: this.getAuthHeaders(),
                body: JSON.stringify({
                  type: record.type,
                  name: this.formatDnsRecordName(record.name),
                  content: record.editingContent.trim(),
                  ttl: record.ttl,
                  proxied: record.proxied || false
                })
              }
            );

            const data = await response.json();
            if (response.ok && (data.success || data.record)) {
              // Êõ¥Êñ∞Êú¨Âú∞ËÆ∞ÂΩï
              record.content = record.editingContent.trim();
              this.cancelEditDnsContent(record);
              this.showDnsToast('ËÆ∞ÂΩïÂ∑≤Êõ¥Êñ∞', 'success');
            } else {
              this.showDnsToast('‰øùÂ≠òÂ§±Ë¥•: ' + (data.error || 'Êú™Áü•ÈîôËØØ'), 'error');
            }
          } catch (error) {
            this.showDnsToast('‰øùÂ≠òÂ§±Ë¥•: ' + error.message, 'error');
          }
        }
      }
    }).mount('#app');
  </script>

</body>

</body>

</html>