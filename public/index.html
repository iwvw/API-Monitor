<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>API Monitor</title>
  <link rel="icon" type="image/png" href="/logo.png">
  <link rel="shortcut icon" href="/logo.png">
  <link rel="icon" href="/logo.png" sizes="32x32">
  <meta name="msapplication-TileImage" content="/logo.png">
  <script src="https://cdn.jsdelivr.net/npm/vue@3/dist/vue.global.prod.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <!-- xterm.js - SSH Terminal -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/xterm@5.3.0/css/xterm.min.css">
  <script src="https://cdn.jsdelivr.net/npm/xterm@5.3.0/lib/xterm.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/xterm-addon-fit@0.8.0/lib/xterm-addon-fit.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/xterm-addon-web-links@0.9.0/lib/xterm-addon-web-links.min.js"></script>

  <!-- Custom Styles - Modularized CSS -->
  <link rel="stylesheet" href="/css/styles.css">
  <link rel="stylesheet" href="/css/projects.css">
  <link rel="stylesheet" href="/css/modals.css">
  <link rel="stylesheet" href="/css/dns.css">
  <link rel="stylesheet" href="/css/tables.css">
  <link rel="stylesheet" href="/css/tabs.css">
  <link rel="stylesheet" href="/css/settings.css">
  <link rel="stylesheet" href="/css/logs.css">
  <link rel="stylesheet" href="/css/transitions.css">
  <link rel="stylesheet" href="/css/server.css">
</head>

<body>
  <!-- è‡ªå®šä¹‰ CSS -->
  <style id="custom-css"></style>

  <div id="app">
    <!-- è®¤è¯æ£€æŸ¥åŠ è½½çŠ¶æ€ -->
    <div v-if="isCheckingAuth" class="auth-loading">
      <div class="auth-loading-content">
        <div class="spinner"></div>
        <div style="margin-top: 16px; color: var(--text-secondary);">æ­£åœ¨åŠ è½½...</div>
      </div>
    </div>

    <!-- é¦–æ¬¡è®¾ç½®å¯†ç ç•Œé¢ -->
    <div v-if="!isCheckingAuth && showSetPasswordModal" class="modal-overlay">
      <div class="modal">
        <div class="modal-header">
          <div class="modal-title">ğŸ‰ æ¬¢è¿ä½¿ç”¨</div>
        </div>
        <p style="text-align: center; color: var(--text-secondary); margin-bottom: 24px;">è¯·è®¾ç½®ç®¡ç†å‘˜å¯†ç </p>
        <div class="form-group">
          <input v-model="setPassword" type="password" class="form-input" placeholder="è¯·è¾“å…¥å¯†ç ï¼ˆè‡³å°‘6ä½ï¼‰"
            @keyup.enter="setAdminPassword" />
        </div>
        <div class="form-group">
          <input v-model="setPasswordConfirm" type="password" class="form-input" placeholder="è¯·å†æ¬¡è¾“å…¥å¯†ç "
            @keyup.enter="setAdminPassword" />
        </div>
        <div v-if="setPasswordError" class="form-error">
          {{ setPasswordError }}
        </div>
        <button @click="setAdminPassword" class="btn btn-primary" style="width: 100%;">
          è®¾ç½®å¯†ç 
        </button>
      </div>
    </div>

    <!-- ç™»å½•ç•Œé¢ -->
    <div v-if="!isCheckingAuth && showLoginModal" class="modal-overlay">
      <div class="modal">
        <div class="modal-header">
          <div class="modal-title">ğŸ” ç®¡ç†å‘˜ç™»å½•</div>
        </div>
        <div class="form-group">
          <input v-model="loginPassword" type="password" class="form-input" placeholder="è¯·è¾“å…¥ç®¡ç†å‘˜å¯†ç "
            @keyup.enter="verifyPassword" />
        </div>
        <div v-if="loginError" class="form-error">
          {{ loginError }}
        </div>
        <button @click="verifyPassword" class="btn btn-primary" style="width: 100%;">
          ç™»å½•
        </button>
      </div>
    </div>

    <div v-if="isAuthenticated" class="container">
      <!-- é¡µé¢å¤´éƒ¨ - æ¨¡å—æ§åˆ¶å’Œè®¾ç½® -->
      <div class="header">
        <div class="title">
          <i class="fas fa-chart-line"></i>
          API Monitor
        </div>
        <div style="display: flex; gap: 10px; align-items: center;">
          <!-- è®¾ç½®æŒ‰é’® -->
          <button class="btn btn-secondary icon-only" @click="showSettingsModal = true" title="ç³»ç»Ÿè®¾ç½®">
            <i class="fas fa-cog"></i>
          </button>
        </div>
      </div>

      <!-- ä¸»æ ‡ç­¾é¡µå¯¼èˆª -->
      <div class="main-tabs">
        <template v-for="module in moduleOrder" :key="module">
          <button v-if="moduleVisibility[module]"
            class="main-tab"
            :class="[
              { active: mainActiveTab === module },
              module === 'dns' ? 'dns-tab' : '',
              module === 'openai' ? 'openai-tab' : ''
            ]"
            @click="handleTabSwitch(module)">
            <i class="fas" :class="getModuleIcon(module)"></i>
            <span> {{ getModuleName(module) }}</span>
          </button>
        </template>
      </div>

      <!-- ==================== Zeabur ç›‘æ§éƒ¨åˆ† ==================== -->
      <div v-if="mainActiveTab === 'zeabur'" class="tab-content" :class="getTabAnimationClass('zeabur')">
        <!-- Zeabur å­æ ‡ç­¾é¡µ -->
        <div class="sec-tabs">
          <button class="tab-btn" :class="{ active: zeaburCurrentTab === 'monitor' }"
            @click="zeaburCurrentTab = 'monitor'" style="background: var(--primary-color) !important;"
            v-if="zeaburCurrentTab === 'monitor'">
            <i class="fas fa-chart-line"></i> æœåŠ¡ç›‘æ§
          </button>
          <button class="tab-btn" :class="{ active: zeaburCurrentTab === 'monitor' }"
            @click="zeaburCurrentTab = 'monitor'" v-else>
            <i class="fas fa-chart-line"></i> æœåŠ¡ç›‘æ§
          </button>
          <button class="tab-btn" :class="{ active: zeaburCurrentTab === 'accounts' }"
            @click="zeaburCurrentTab = 'accounts'" style="background: var(--primary-color) !important;"
            v-if="zeaburCurrentTab === 'accounts'">
            <i class="fas fa-users"></i> è´¦å·ç®¡ç†
          </button>
          <button class="tab-btn" :class="{ active: zeaburCurrentTab === 'accounts' }"
            @click="zeaburCurrentTab = 'accounts'" v-else>
            <i class="fas fa-users"></i> è´¦å·ç®¡ç†
          </button>
        </div>

        <!-- æœåŠ¡ç›‘æ§æ ‡ç­¾é¡µ -->
        <div v-if="zeaburCurrentTab === 'monitor'" class="sub-tab-content quick-fade-in">
          <div class="info-card">
            <div class="info-card-title">ğŸ’¡ ä½¿ç”¨è¯´æ˜</div>
            <div class="info-card-content">
              æ•°æ®æ¯30ç§’è‡ªåŠ¨åˆ·æ–°
            </div>
          </div>

          <div class="controls" style="justify-content: space-between;">
            <div style="display: flex; gap: 10px; align-items: center;">
              <button class="btn btn-primary" @click="fetchData" :disabled="loading">
                <i class="fas fa-sync-alt"></i>
                {{ loading ? 'æ•°æ®æ›´æ–°' : 'åˆ·æ–°æ•°æ®' }}
              </button>
              <button class="btn btn-secondary" @click="toggleDataRefresh"
                :class="dataRefreshPaused ? 'btn-success' : 'btn-warning'">
                <i class="fas" :class="dataRefreshPaused ? 'fa-play' : 'fa-pause'"></i>
                {{ dataRefreshPaused ? 'ç»§ç»­æ›´æ–°' : 'æš‚åœæ›´æ–°' }}
              </button>
              <button class="btn btn-danger" @click="clearCache">
                <i class="fas fa-trash"></i>
                æ¸…é™¤ç¼“å­˜
              </button>
            </div>
            <div class="refresh-info">
              <div class="last-update">{{ refreshCountdown }} ç§’ååˆ·æ–°</div>
              <div class="refresh-progress">
                <div class="refresh-progress-bar" :style="{ width: refreshProgress + '%' }"></div>
              </div>
            </div>
          </div>

          <div v-if="accounts.length > 0" class="stats-grid">
            <div class="stat-card">
              <div class="stat-label">è´¦å·æ•°</div>
              <div class="stat-value">{{ accounts.length }}</div>
            </div>
            <div class="stat-card">
              <div class="stat-label">é¡¹ç›®æ€»æ•°</div>
              <div class="stat-value">{{ totalProjects }}</div>
            </div>
            <div class="stat-card">
              <div class="stat-label">æœåŠ¡æ€»æ•°</div>
              <div class="stat-value">{{ totalServices }}</div>
            </div>
            <div class="stat-card">
              <div class="stat-label">è¿è¡Œä¸­</div>
              <div class="stat-value">{{ runningServices }}</div>
            </div>
            <div class="stat-card">
              <div class="stat-label">æ€»è´¹ç”¨</div>
              <div class="stat-value">${{ totalCost.toFixed(2) }}</div>
            </div>
          </div>

          <div v-if="loading && accounts.length === 0" class="loading">
            âš¡ æ­£åœ¨åŠ è½½æ•°æ®...
          </div>

          <div v-for="account in accounts" :key="account.name" class="account-card">
            <div class="account-header" @click="toggleAccount(account.name)">
              <div class="account-info">
                <span style="font-size: 20px; transition: transform 0.3s; display: inline-flex; align-items: center;"
                  :style="{ 
          /* ä¿æŒ span ä½œä¸ºä¸€ä¸ªå®¹å™¨ï¼Œä¸æ—‹è½¬æˆ–æ—‹è½¬åˆ°ç‰¹å®šè§’åº¦ */
          transform: isAccountExpanded(account.name) ? 'rotate(0deg)' : 'rotate(0deg)' 
      }">

                  <i class="fas fa-chevron-right toggle-icon" :style="{ 
           transition: 'transform 0.4s cubic-bezier(0.4, 0, 0.2, 1)', 
           // é€»è¾‘è°ƒæ•´ï¼š
           // å±•å¼€ (true) -> 0deg (å‘ä¸‹)
           // æ”¶èµ· (false) -> 90deg (å‘å³)
           transform: isAccountExpanded(account.name) ? 'rotate(90deg)' : 'rotate(0deg)' 
       }">
                  </i>
                </span>
                <div>
                  <div class="account-name" v-if="!account.isEditingName"
                    @dblclick.stop="startEditAccountName(account)">
                    {{ account.name }}
                  </div>
                  <div v-else class="account-name-edit" @click.stop>
                    <input v-model="account.editingName" @keyup.enter="saveAccountName(account)"
                      @keyup.esc="cancelEditAccountName(account)" @blur="saveAccountName(account)" class="edit-input"
                      ref="accountNameInput" style="width: 150px;" />
                    <button @click.stop="cancelEditAccountName(account)" class="cancel-btn" title="å–æ¶ˆ"
                      style="margin-left: 4px;">
                      âœ–ï¸
                    </button>
                  </div>
                  <div v-if="account.data" class="account-email">
                    {{ maskEmail(account.data.email) || account.data.username }}
                  </div>
                </div>
              </div>
              <div class="account-balance">
                <div style="display: flex; flex-direction: column; gap: 3px;">
                  <div class="balance-card credit-balance-card">
                    <div class="balance-icon">ğŸ’°</div>
                    <div class="balance-amount" :class="account.data?.credit ? getBalanceClass(account.data.credit) : ''">
                      <span v-if="account.data?.credit">${{ (account.data.credit / 100).toFixed(2) }}</span>
                      <span v-else>-</span>
                    </div>
                  </div>
                  <div class="balance-card ai-balance-card">
                    <div class="balance-icon">ğŸ¤–</div>
                    <div class="balance-amount">
                      {{ account.aihub && account.aihub.balance ? '$' + (account.aihub.balance / 100000).toFixed(2) :
                      'æ— '
                      }}
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div v-if="account.error" class="error">
              âŒ é”™è¯¯: {{ account.error }}
            </div>

            <div v-if="account.projects" class="projects-grid"
              :class="{ 'collapsed': !isAccountExpanded(account.name) }">
              <div v-for="project in account.projects" :key="project._id" :id="'proj-' + project._id"
                class="project-card">
                <div class="project-header">
                  <div class="project-name-wrapper">
                    <span class="project-name-icon">ğŸ“¦</span>
                    <span v-if="!project.isEditing" class="project-name-text">{{ project.name }}</span>
                    <input v-else v-model="project.editingName" @keyup.enter="saveProjectName(account, project)"
                      @keyup.esc="cancelEditProjectName(project)" @blur="saveProjectName(account, project)"
                      class="project-name-input" ref="projectNameInput" />
                  </div>
                  <div class="project-actions">
                    <button v-if="!project.isEditing" @click="deleteProject(account, project)" class="project-delete-btn"
                      title="åˆ é™¤é¡¹ç›®">
                      <i class="fas fa-trash"></i>
                    </button>
                    <button v-if="!project.isEditing" @click="startEditProjectName(project)" class="project-edit-btn"
                      title="é‡å‘½åé¡¹ç›®">
                      <i class="fas fa-pen"></i>
                    </button>
                    <button v-if="project.isEditing" @click="cancelEditProjectName(project)" class="project-cancel-btn" title="å–æ¶ˆ">
                      <i class="fas fa-times"></i>
                    </button>
                  </div>
                </div>
                <div class="project-mini-cards">
                  <div class="mini-card region-card">
                    <span class="mini-card-icon">åœ°åŒºğŸ“</span>
                    <span class="mini-card-value">{{ formatRegion(project.region) }}</span>
                  </div>
                  <div class="mini-card cost-card">
                    <span class="mini-card-icon">å·²ç”¨ğŸ’°</span>
                    <span class="mini-card-value">${{ formatCost(project.cost) }}</span>
                  </div>
                </div>
                <div class="services-container">
                  <div v-for="service in project.services" :key="service._id" :id="'service-' + service._id"
                    :class="['service-item', service.status.toLowerCase()]">
                    <div class="service-header">
                      <div class="service-name-container">
                        <span v-if="!service.isEditing" class="service-name" :title="service.name">
                          {{ service.name }}
                        </span>
                        <input v-else v-model="service.editingName" @keyup.enter="saveServiceName(account, project, service)"
                          @keyup.esc="cancelEditServiceName(service)" @blur="saveServiceName(account, project, service)"
                          class="service-name-input" />
                        <button v-if="!service.isEditing" @click="startEditServiceName(service)" class="service-edit-btn"
                          title="é‡å‘½åæœåŠ¡">
                          <i class="fas fa-pen"></i>
                        </button>
                        <button v-else @click="cancelEditServiceName(service)" class="service-cancel-btn" title="å–æ¶ˆ">
                          <i class="fas fa-times"></i>
                        </button>
                      </div>
                      <div :class="['service-status', service.status.toLowerCase()]">
                        {{ service.status === 'RUNNING' ? 'è¿è¡Œä¸­' : service.status === 'SUSPENDED' ? 'å·²æš‚åœ' :
                        service.status
                        }}
                      </div>
                    </div>
                    <div v-if="service.resourceLimit" class="service-info">
                      <span style="display: inline-flex; align-items: center; gap: 4px; margin-right: 12px;">
                        <i class="fas fa-microchip"></i>
                        {{ service.resourceLimit.cpu }}m
                      </span>
                      <span style="display: inline-flex; align-items: center; gap: 4px;">
                        <i class="fas fa-memory"></i>
                        {{ service.resourceLimit.memory }}MB
                      </span>
                    </div>
                    <div class="service-actions">
                      <button v-if="service.status === 'RUNNING'" @click="pauseService(account, project, service)"
                        class="service-btn btn-pause">
                        <i class="fas fa-pause"></i>
                        æš‚åœ
                      </button>
                      <button @click="restartService(account, project, service)" class="service-btn btn-restart">
                        <i class="fas fa-redo"></i>
                        {{ service.status === 'SUSPENDED' ? 'å¯åŠ¨' : 'é‡å¯' }}
                      </button>
                      <button @click="showServiceLogs(account, project, service)" class="service-btn btn-logs">
                        <i class="fas fa-file-alt"></i>
                        æ—¥å¿—
                      </button>
                      <button @click="deleteService(account, project, service)" class="service-btn btn-delete">
                        <i class="fas fa-trash"></i>
                        åˆ é™¤
                      </button>
                    </div>
                  </div>
                  <div v-if="project.services.length === 0" class="empty-state">
                    æš‚æ— æœåŠ¡
                  </div>
                </div>

                <!-- é¡¹ç›®åŸŸå -->
                <div v-if="getProjectDomains(project).length > 0" class="domains-container">
                  <a v-for="domainInfo in getProjectDomains(project)" :key="domainInfo.domain"
                    :href="'https://' + domainInfo.domain" target="_blank" class="domain-link">
                    <i class="fas fa-globe"></i>
                    <span>{{ domainInfo.domain }}</span>
                    <span v-if="domainInfo.isGenerated" class="domain-badge">è‡ªåŠ¨</span>
                  </a>
                </div>
              </div>
            </div>
          </div>

          <div v-if="!loading && accounts.length === 0" class="error">
            æœªé…ç½®è´¦å·æˆ–æ— æ³•è·å–æ•°æ®ã€‚è¯·æ£€æŸ¥ .env é…ç½®æ–‡ä»¶ã€‚
          </div>
        </div>
        <!-- æœåŠ¡ç›‘æ§æ ‡ç­¾é¡µç»“æŸ -->

        <!-- è´¦å·ç®¡ç†æ ‡ç­¾é¡µ -->
        <div v-if="zeaburCurrentTab === 'accounts'" class="sub-tab-content quick-fade-in">
          <div class="panel">
            <div class="panel-header">
              <div class="panel-title"></div>
              <div style="display: flex; gap: 8px;">
                <button class="btn btn-success" style="padding: 6px 12px;" @click="showAddZeaburAccountModal = true">
                  <i class="fas fa-plus"></i> æ·»åŠ è´¦å·
                </button>
                <button class="btn btn-secondary" @click="exportAllAccounts" style="padding: 6px 12px;">
                  <i class="fas fa-upload"></i> å¯¼å‡º
                </button>
                <button class="btn btn-secondary" @click="importAllAccounts" style="padding: 6px 12px;">
                  <i class="fas fa-download"></i> å¯¼å…¥
                </button>
              </div>
            </div>

            <div class="table-container">
              <table class="data-table">
                <thead>
                  <tr>
                    <th>åç§°</th>
                    <th>é‚®ç®±</th>
                    <th>ä½™é¢</th>
                    <th>çŠ¶æ€</th>
                    <th style="width: 150px;">æ“ä½œ</th>
                  </tr>
                </thead>
                <tbody>
                  <tr v-for="(account, index) in managedAccounts" :key="'local-' + index">
                    <td>{{ account.name }}</td>
                    <td>{{ account.email || '-' }}</td>
                    <td>
                      <span v-if="account.balance !== null && account.balance !== undefined">
                        ${{ account.balance.toFixed(2) }}
                      </span>
                      <span v-else>-</span>
                    </td>
                    <td>
                      <span class="proxied-badge" :class="account.status === 'active' ? 'proxied-on' : 'proxied-off'">
                        {{ account.status === 'active' ? 'æ­£å¸¸' : 'æœªçŸ¥' }}
                      </span>
                    </td>
                    <td class="actions">
                      <button class="btn btn-danger" style="padding: 4px 8px; font-size: 12px;"
                        @click="removeAccount(index)" title="åˆ é™¤">
                        <i class="fas fa-trash"></i>
                      </button>
                    </td>
                  </tr>
                  <!-- æ˜¾ç¤ºæœåŠ¡å™¨é…ç½®çš„è´¦å·ï¼ˆåªè¯»ï¼‰ -->
                  <tr v-if="managedAccounts.length === 0 && accounts.length > 0" v-for="account in accounts"
                    :key="'server-' + account.name">
                    <td>{{ account.name }}</td>
                    <td>{{ account.data?.email || '-' }}</td>
                    <td>
                      <span v-if="account.data?.credit">
                        ${{ (account.data.credit / 100).toFixed(2) }}
                      </span>
                      <span v-else>-</span>
                    </td>
                    <td>
                      <span class="proxied-badge proxied-off">
                        æœåŠ¡å™¨é…ç½®
                      </span>
                    </td>
                    <td class="actions">
                      <span style="font-size: 12px; color: var(--text-tertiary);">
                        ğŸ”’ åªè¯»
                      </span>
                    </td>
                  </tr>
                </tbody>
              </table>
              <div v-if="managedAccounts.length === 0 && accounts.length === 0" class="empty-state">
                <i class="fas fa-user-plus" style="font-size: 48px; margin-bottom: 16px;"></i>
                <div>æš‚æ— è´¦å·ï¼Œç‚¹å‡»ä¸Šæ–¹æŒ‰é’®æ·»åŠ </div>
              </div>
            </div>
          </div>

          <!-- æ‰¹é‡æ·»åŠ  -->
          <div class="panel" style="margin-top: 16px;">
            <div class="panel-header">
              <div class="panel-title">æ‰¹é‡æ·»åŠ è´¦å·</div>
            </div>
            <div>
              <p style="color: var(--text-secondary); font-size: 13px; margin-bottom: 12px;">
                æ¯è¡Œä¸€ä¸ªè´¦å·ï¼Œæ ¼å¼ï¼š<code>åç§°:Token</code> æˆ– <code>åç§°ï¼šToken</code> æˆ– <code>åç§°(Token)</code> æˆ–
                <code>åç§°ï¼ˆTokenï¼‰</code>
              </p>
              <div style="position: relative; min-height: 150px;">
                <div
                  style="width: 100%; min-height: 150px; padding: 12px; border: 1px solid var(--border-color); border-radius: 8px; font-size: 13px; font-family: monospace; white-space: pre-wrap; word-break: break-all; pointer-events: none; color: var(--text-primary); line-height: 1.5; background-color: var(--input-bg);">
                  {{ maskedBatchAccounts }}</div>
                <textarea v-model="batchAccounts" @input="updateBatchDisplay" placeholder="æ¯è¡Œä¸€ä¸ªè´¦å·ï¼Œæ ¼å¼ï¼šè´¦å·åç§°:API_Token"
                  class="form-textarea"
                  style="position: absolute; top: 0; left: 0; color: transparent; caret-color: var(--text-primary); background: transparent; line-height: 1.5; min-height: 150px;"></textarea>
              </div>
              <div v-if="batchAddError" class="form-error" style="margin-top: 8px;">{{ batchAddError }}</div>
              <div v-if="batchAddSuccess" class="form-success" style="margin-top: 8px;">{{ batchAddSuccess }}</div>
              <button class="btn btn-primary" @click="batchAddAccounts" :disabled="addingAccount"
                style="width: 100%; margin-top: 12px;">
                {{ addingAccount ? 'æ·»åŠ ä¸­...' : 'æ‰¹é‡æ·»åŠ ' }}
              </button>
            </div>
          </div>
        </div>
        <!-- è´¦å·ç®¡ç†æ ‡ç­¾é¡µç»“æŸ -->

        <!-- æ·»åŠ  Zeabur è´¦å·æ¨¡æ€æ¡† -->
        <div v-if="showAddZeaburAccountModal" class="modal-overlay" @keydown.esc="showAddZeaburAccountModal = false" @keydown.enter="addAccountToList" tabindex="-1">
          <div class="modal">
            <div class="modal-header">
              <div class="modal-title"></div>
              <button class="modal-close" @click="showAddZeaburAccountModal = false">&times;</button>
            </div>

            <div class="form-group">
              <label class="form-label">è´¦å·åç§° *</label>
              <input v-model="newAccount.name" class="form-input" placeholder="ä¾‹å¦‚: æˆ‘çš„è´¦å·" />
            </div>

            <div class="form-group">
              <label class="form-label">API Token *</label>
              <input v-model="newAccount.token" type="password" class="form-input" placeholder="sk-xxxxxxxxxxxxxxxx" />
              <div class="form-help">åœ¨ Zeabur æ§åˆ¶å°çš„è®¾ç½®ä¸­åˆ›å»º API Token</div>
            </div>

            <div v-if="addAccountError" class="form-error">{{ addAccountError }}</div>
            <div v-if="addAccountSuccess" class="form-success">{{ addAccountSuccess }}</div>

            <div style="display: flex; gap: 12px; margin-top: 20px;">
              <button class="btn btn-primary" @click="addAccountToList" :disabled="addingAccount" style="flex: 1;">
                {{ addingAccount ? 'éªŒè¯ä¸­...' : 'æ·»åŠ è´¦å·' }}
              </button>
              <button class="btn btn-secondary" @click="showAddZeaburAccountModal = false" style="flex: 1;">å–æ¶ˆ</button>
            </div>
          </div>
        </div>

      </div>
      <!-- ==================== Zeabur ç›‘æ§éƒ¨åˆ†ç»“æŸ ==================== -->

      <!-- ==================== DNS ç®¡ç†éƒ¨åˆ† ==================== -->
      <div v-if="mainActiveTab === 'dns'" class="tab-content" :class="getTabAnimationClass('dns')">
        <!-- DNS å­æ ‡ç­¾é¡µ -->
        <div class="sec-tabs">
          <button class="tab-btn" :class="{ active: dnsCurrentTab === 'dns' }" @click="dnsCurrentTab = 'dns'">
            <i class="fas fa-globe"></i> DNS è®°å½•
          </button>
          <button class="tab-btn" :class="{ active: dnsCurrentTab === 'accounts' }" @click="dnsCurrentTab = 'accounts'">
            <i class="fas fa-users"></i> è´¦å·ç®¡ç†
          </button>
          <!-- <button class="tab-btn" :class="{ active: dnsCurrentTab === 'templates' }"
            @click="dnsCurrentTab = 'templates'">
            <i class="fas fa-copy"></i> æ¨¡æ¿
          </button> -->
        </div>

        <!-- DNS è®°å½•æ ‡ç­¾é¡µ -->
        <div v-if="dnsCurrentTab === 'dns'" class="sub-tab-content quick-fade-in">
          <!-- è´¦å·é€‰æ‹© - å¡ç‰‡å¼ -->
          <div style="margin-bottom: 16px;">
            <!-- <label style="font-weight: 500; margin-bottom: 12px; display: block;">é€‰æ‹©è´¦å·ï¼š</label> -->
            <div class="zones-grid">
              <div v-for="acc in dnsAccounts" :key="acc.id" class="zone-card"
                :class="{ active: dnsSelectedAccountId === acc.id }" @click="selectDnsAccount(acc)">
                <div style="flex: 1;">
                  <div class="zone-name">
                    <i class="fas fa-user-circle" style="margin-right: 6px; color: var(--cf-color);"></i>
                    {{ acc.name }}
                  </div>
                  <div class="zone-status" style="font-size: 11px;">{{ acc.email || 'è´¦å·' }}</div>
                </div>
                <div style="display: flex; align-items: center; gap: 8px;">
                  <i v-if="dnsSelectedAccountId === acc.id" class="fas fa-check-circle"
                    style="color: var(--cf-color);"></i>
                  <button v-if="dnsSelectedAccountId === acc.id" class="btn btn-secondary"
                    style="padding: 4px 8px; font-size: 12px;" @click.stop="loadDnsZones" :disabled="dnsLoadingZones">
                    <i class="fas fa-sync-alt" :class="{ 'fa-spin': dnsLoadingZones }"></i>
                  </button>
                </div>
              </div>
            </div>
          </div>

          <div v-if="dnsLoadingZones" class="loading">
            <div class="spinner"></div>
            <div style="margin-top: 12px;">åŠ è½½åŸŸååˆ—è¡¨...</div>
          </div>

          <!-- åŸŸåç½‘æ ¼ -->
          <div v-if="dnsSelectedAccountId && dnsZones.length > 0 && !dnsLoadingZones" class="zones-grid">
            <div v-for="zone in dnsZones" :key="zone.id" class="zone-card"
              :class="{ active: dnsSelectedZoneId === zone.id }" @click="selectDnsZone(zone)">
              <div>
                <div class="zone-name">{{ zone.name }}</div>
                <div class="zone-status" :class="zone.status">{{ zone.status }}</div>
              </div>
              <i class="fas fa-chevron-right" style="color: var(--text-tertiary);"></i>
            </div>
          </div>

          <div v-if="dnsSelectedAccountId && dnsZones.length === 0 && !dnsLoadingZones" class="empty-state">
            <i class="fas fa-globe" style="font-size: 48px; margin-bottom: 16px;"></i>
            <div>è¯¥è´¦å·ä¸‹æ²¡æœ‰åŸŸå</div>
          </div>

          <!-- å¿«é€Ÿåˆ‡æ¢ -->
          <div v-if="dnsSelectedZoneId" class="quick-switch">
            <i class="fas fa-bolt" style="color: var(--cf-color);"></i>
            <span style="font-weight: 500; white-space: nowrap;">å¿«é€Ÿåˆ‡æ¢ï¼š</span>
            <select v-model="dnsQuickSwitchType"
              style="color: #f38020; padding: 6px 10px; border-radius: 4px; border: 1px solid var(--input-border); background: var(--input-bg); min-width: 80px;">
              <option value="A">A</option>
              <option value="AAAA">AAAA</option>
              <option value="CNAME">CNAME</option>
            </select>
            <input v-model="dnsQuickSwitchName" placeholder="è®°å½•åç§° (å¦‚ @, www, *)" />
            <input v-model="dnsQuickSwitchContent" placeholder="æ–°çš„å†…å®¹ (IP æˆ–åŸŸå)" />
            <button class="btn btn-cf" style="padding: 6px 12px;" @click="dnsQuickSwitch" :disabled="dnsSwitching">
              {{ dnsSwitching ? 'åˆ‡æ¢ä¸­...' : 'åˆ‡æ¢' }}
            </button>
          </div>

          <!-- DNS è®°å½•è¡¨æ ¼ -->
          <div v-if="dnsSelectedZoneId" class="panel">
            <div class="panel-header">
              <div class="panel-title"></div>
              <div style="display: flex; gap: 8px;">
                <button class="btn btn-success" style="padding: 6px 12px;" @click="openAddDnsRecordModal">
                  <i class="fas fa-plus"></i> æ·»åŠ 
                </button>
                <button v-if="dnsSelectedRecords.length > 0" class="btn btn-danger" style="padding: 6px 12px;"
                  @click="batchDeleteDnsRecords">
                  <i class="fas fa-trash-alt"></i> åˆ é™¤ ({{ dnsSelectedRecords.length }})
                </button>
                <button class="btn btn-secondary" style="padding: 6px 12px;" @click="exportDnsRecords">
                  <i class="fas fa-upload"></i> å¯¼å‡º
                </button>
                <button class="btn btn-secondary" style="padding: 6px 12px;" @click="importDnsRecords">
                  <i class="fas fa-download"></i> å¯¼å…¥
                </button>
                <button class="btn btn-secondary" style="padding: 6px 10px;" @click="loadDnsRecords"
                  :disabled="dnsLoadingRecords">
                  <i class="fas fa-sync-alt" :class="{ 'fa-spin': dnsLoadingRecords }"></i>
                </button>
              </div>
            </div>

            <div v-if="dnsLoadingRecords" class="loading">
              <div class="spinner"></div>
              <div style="margin-top: 12px;">åŠ è½½ä¸­...</div>
            </div>

            <div v-else class="table-container">
              <table class="data-table">
                <thead>
                  <tr>
                    <th style="width: 5%;">
                      <input type="checkbox" @change="toggleSelectAllDnsRecords"
                        :checked="dnsSelectedRecords.length === dnsRecords.length && dnsRecords.length > 0"
                        style="width: 16px; height: 16px; cursor: pointer;">
                    </th>
                    <th style="width: 12%;">ç±»å‹</th>
                    <th style="width: 18%;">åç§°</th>
                    <th style="width: 28%;">å†…å®¹</th>
                    <th style="width: 8%;">ä»£ç†</th>
                    <th style="width: 8%;">TTL</th>
                    <th style="width: 10%;">æ“ä½œ</th>
                  </tr>
                </thead>
                <tbody>
                  <tr v-for="record in dnsRecords" :key="record.id">
                    <td>
                      <input type="checkbox" :value="record.id" v-model="dnsSelectedRecords"
                        style="width: 16px; height: 16px; cursor: pointer;">
                    </td>
                    <td><span class="record-type" :class="record.type">{{ record.type }}</span></td>
                    <td>
                      <div v-if="!record.isEditingName" class="editable-cell"
                        :title="formatDnsRecordName(record.name) + ' (åŒå‡»ç¼–è¾‘)'" @dblclick="startEditDnsName(record)">
                        {{ formatDnsRecordName(record.name) }}
                      </div>
                      <div v-else class="inline-edit-container" @click.stop>
                        <input v-model="record.editingName" class="inline-edit-input" @keyup.enter="saveDnsName(record)"
                          @keyup.esc="cancelEditDnsName(record)" @blur="saveDnsName(record)" ref="dnsNameInput" />
                        <button @click.stop="cancelEditDnsName(record)" class="inline-edit-cancel" title="å–æ¶ˆ">
                          âœ–ï¸
                        </button>
                      </div>
                    </td>
                    <td>
                      <div v-if="!record.isEditingContent" class="content-truncate editable-cell"
                        :title="record.content + ' (åŒå‡»ç¼–è¾‘)'" @dblclick="startEditDnsContent(record)">
                        {{ record.content }}
                      </div>
                      <div v-else class="inline-edit-container" @click.stop>
                        <input v-model="record.editingContent" class="inline-edit-input"
                          @keyup.enter="saveDnsContent(record)" @keyup.esc="cancelEditDnsContent(record)"
                          @blur="saveDnsContent(record)" ref="dnsContentInput" />
                        <button @click.stop="cancelEditDnsContent(record)" class="inline-edit-cancel" title="å–æ¶ˆ">
                          âœ–ï¸
                        </button>
                      </div>
                    </td>
                    <td>
                      <span class="proxied-badge" :class="record.proxied ? 'proxied-on' : 'proxied-off'">
                        {{ record.proxied ? 'å¼€å¯' : 'å…³é—­' }}
                      </span>
                    </td>
                    <td>{{ record.ttl === 1 ? 'Auto' : record.ttl }}</td>
                    <td class="actions">
                      <button class="btn btn-secondary" style="padding: 4px 8px; font-size: 12px;"
                        @click="editDnsRecord(record)" title="ç¼–è¾‘">
                        <i class="fas fa-edit"></i>
                      </button>
                      <button class="btn btn-danger" style="padding: 4px 8px; font-size: 12px;"
                        @click="deleteDnsRecord(record)" title="åˆ é™¤">
                        <i class="fas fa-trash"></i>
                      </button>
                    </td>
                  </tr>
                </tbody>
              </table>
              <div v-if="dnsRecords.length === 0" class="empty-state">æš‚æ—  DNS è®°å½•</div>
            </div>
          </div>
        </div>

        <!-- CF è´¦å·ç®¡ç†æ ‡ç­¾é¡µ -->
        <div v-if="dnsCurrentTab === 'accounts'" class="sub-tab-content quick-fade-in">
          <div class="panel">
            <div class="panel-header">
              <div class="panel-title"></div>
              <div style="display: flex; gap: 8px;">
                <button class="btn btn-success" style="padding: 6px 12px;" @click="openAddDnsAccountModal">
                  <i class="fas fa-plus"></i> æ·»åŠ è´¦å·
                </button>
                <button class="btn btn-secondary" style="padding: 6px 12px;" @click="exportDnsAccounts">
                  <i class="fas fa-upload"></i> å¯¼å‡º
                </button>
                <button class="btn btn-secondary" style="padding: 6px 12px;" @click="importDnsAccounts">
                  <i class="fas fa-download"></i> å¯¼å…¥
                </button>
              </div>
            </div>

            <div class="table-container">
              <table class="data-table">
                <thead>
                  <tr>
                    <th>åç§°</th>
                    <th>é‚®ç®±</th>
                    <th>API Token</th>
                    <th>æ·»åŠ æ—¶é—´</th>
                    <th>æœ€åä½¿ç”¨</th>
                    <th style="width: 150px;">æ“ä½œ</th>
                  </tr>
                </thead>
                <tbody>
                  <tr v-for="acc in dnsAccounts" :key="acc.id">
                    <td>{{ acc.name }}</td>
                    <td>{{ acc.email || '-' }}</td>
                    <td>
                      <div style="display: flex; align-items: center; gap: 8px;">
                        <span v-if="!acc.showToken" style="color: var(--text-secondary);">
                          {{ acc.hasToken ? 'â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢' : '-' }}
                        </span>
                        <span v-else style="font-family: monospace; font-size: 12px; word-break: break-all;">
                          {{ acc.apiToken || '-' }}
                        </span>
                        <button v-if="acc.hasToken" class="btn btn-secondary"
                          style="padding: 2px 6px; font-size: 11px; min-width: auto;"
                          @click="toggleDnsTokenVisibility(acc)"
                          :title="acc.showToken ? 'éšè—' : 'æ˜¾ç¤º'">
                          <i :class="acc.showToken ? 'fas fa-eye-slash' : 'fas fa-eye'"></i>
                        </button>
                      </div>
                    </td>
                    <td>{{ formatDnsDate(acc.createdAt) }}</td>
                    <td>{{ acc.lastUsed ? formatDnsDate(acc.lastUsed) : '-' }}</td>
                    <td class="actions">
                      <button class="btn btn-secondary" style="padding: 4px 8px; font-size: 12px;"
                        @click="verifyDnsAccount(acc)" title="éªŒè¯Token">
                        <i class="fas fa-check"></i>
                      </button>
                      <button class="btn btn-primary" style="padding: 4px 8px; font-size: 12px;"
                        @click="editDnsAccount(acc)" title="ç¼–è¾‘">
                        <i class="fas fa-edit"></i>
                      </button>
                      <button class="btn btn-danger" style="padding: 4px 8px; font-size: 12px;"
                        @click="deleteDnsAccount(acc)" title="åˆ é™¤">
                        <i class="fas fa-trash"></i>
                      </button>
                    </td>
                  </tr>
                </tbody>
              </table>
              <div v-if="dnsAccounts.length === 0" class="empty-state">
                <i class="fas fa-key" style="font-size: 48px; margin-bottom: 16px;"></i>
                <div>æš‚æ— è´¦å·ï¼Œè¯·æ·»åŠ  Cloudflare API Token</div>
              </div>
            </div>
          </div>
        </div>

        <!-- æ¨¡æ¿æ ‡ç­¾é¡µ -->
        <div v-if="dnsCurrentTab === 'templates'">
          <div class="panel">
            <div class="panel-header">
              <div class="panel-title">DNS æ¨¡æ¿</div>
              <button class="btn btn-success" style="padding: 6px 12px;" @click="openAddDnsTemplateModal">
                <i class="fas fa-plus"></i> æ·»åŠ æ¨¡æ¿
              </button>
            </div>

            <div class="table-container">
              <table class="data-table">
                <thead>
                  <tr>
                    <th>åç§°</th>
                    <th style="width: 60px;">ç±»å‹</th>
                    <th>å†…å®¹</th>
                    <th style="width: 70px;">ä»£ç†</th>
                    <th>æè¿°</th>
                    <th style="width: 120px;">æ“ä½œ</th>
                  </tr>
                </thead>
                <tbody>
                  <tr v-for="tpl in dnsTemplates" :key="tpl.id">
                    <td>{{ tpl.name }}</td>
                    <td><span class="record-type" :class="tpl.type">{{ tpl.type }}</span></td>
                    <td>
                      <div class="content-truncate" :title="tpl.content">{{ tpl.content }}</div>
                    </td>
                    <td>
                      <span class="proxied-badge" :class="tpl.proxied ? 'proxied-on' : 'proxied-off'">
                        {{ tpl.proxied ? 'å¼€å¯' : 'å…³é—­' }}
                      </span>
                    </td>
                    <td>{{ tpl.description || '-' }}</td>
                    <td class="actions">
                      <button class="btn btn-secondary" style="padding: 4px 8px; font-size: 12px;"
                        @click="editDnsTemplate(tpl)" title="ç¼–è¾‘">
                        <i class="fas fa-edit"></i>
                      </button>
                      <button class="btn btn-danger" style="padding: 4px 8px; font-size: 12px;"
                        @click="deleteDnsTemplate(tpl)" title="åˆ é™¤">
                        <i class="fas fa-trash"></i>
                      </button>
                    </td>
                  </tr>
                </tbody>
              </table>
              <div v-if="dnsTemplates.length === 0" class="empty-state">
                <i class="fas fa-copy" style="font-size: 48px; margin-bottom: 16px;"></i>
                <div>æš‚æ— æ¨¡æ¿ï¼Œæ·»åŠ å¸¸ç”¨ DNS é…ç½®æ¨¡æ¿ä»¥å¿«é€Ÿåº”ç”¨</div>
              </div>
            </div>
          </div>
        </div>

        <!-- æ·»åŠ  CF è´¦å·æ¨¡æ€æ¡† -->
        <div v-if="showAddDnsAccountModal" class="modal-overlay" @keydown.esc="showAddDnsAccountModal = false" @keydown.enter="addDnsAccount" tabindex="-1">
          <div class="modal">
            <div class="modal-header">
              <div class="modal-title">æ·»åŠ  Cloudflare è´¦å·</div>
              <button class="modal-close" @click="showAddDnsAccountModal = false">&times;</button>
            </div>

            <div class="form-group">
              <label class="form-label">è´¦å·åç§° *</label>
              <input v-model="dnsAccountForm.name" class="form-input" placeholder="ä¾‹å¦‚: ä¸»è´¦å·" />
            </div>

            <div class="form-group">
              <label class="form-label">API Token *</label>
              <input v-model="dnsAccountForm.apiToken" type="password" class="form-input"
                placeholder="Cloudflare API Token" />
              <div class="form-help">åœ¨ Cloudflare æ§åˆ¶å° â†’ My Profile â†’ API Tokens åˆ›å»º</div>
            </div>

            <div class="form-group">
              <label class="form-label">é‚®ç®±ï¼ˆå¯é€‰ï¼‰</label>
              <input v-model="dnsAccountForm.email" class="form-input" placeholder="ç”¨äºæ ‡è¯†è´¦å·" />
            </div>

            <div v-if="dnsAccountFormError" class="form-error">{{ dnsAccountFormError }}</div>
            <div v-if="dnsAccountFormSuccess" class="form-success">{{ dnsAccountFormSuccess }}</div>

            <div style="display: flex; gap: 12px; margin-top: 20px;">
              <button class="btn btn-primary" @click="addDnsAccount" :disabled="dnsSavingAccount" style="flex: 1;">
                {{ dnsSavingAccount ? 'éªŒè¯ä¸­...' : 'æ·»åŠ è´¦å·' }}
              </button>
              <button class="btn btn-secondary" @click="showAddDnsAccountModal = false" style="flex: 1;">å–æ¶ˆ</button>
            </div>
          </div>
        </div>

        <!-- ç¼–è¾‘ CF è´¦å·æ¨¡æ€æ¡† -->
        <div v-if="showEditDnsAccountModal" class="modal-overlay" @keydown.esc="showEditDnsAccountModal = false" @keydown.enter="updateDnsAccount" tabindex="-1">
          <div class="modal">
            <div class="modal-header">
              <div class="modal-title">ç¼–è¾‘ Cloudflare è´¦å·</div>
              <button class="modal-close" @click="showEditDnsAccountModal = false">&times;</button>
            </div>

            <div class="form-group">
              <label class="form-label">è´¦å·åç§° *</label>
              <input v-model="dnsEditAccountForm.name" class="form-input" placeholder="ä¾‹å¦‚: ä¸»è´¦å·" />
            </div>

            <div class="form-group">
              <label class="form-label">API Token *</label>
              <input v-model="dnsEditAccountForm.apiToken" type="password" class="form-input"
                placeholder="Cloudflare API Token" />
              <div class="form-help">ç•™ç©ºè¡¨ç¤ºä¸ä¿®æ”¹ Token</div>
            </div>

            <div class="form-group">
              <label class="form-label">é‚®ç®±ï¼ˆå¯é€‰ï¼‰</label>
              <input v-model="dnsEditAccountForm.email" class="form-input" placeholder="ç”¨äºæ ‡è¯†è´¦å·" />
            </div>

            <div v-if="dnsEditAccountFormError" class="form-error">{{ dnsEditAccountFormError }}</div>
            <div v-if="dnsEditAccountFormSuccess" class="form-success">{{ dnsEditAccountFormSuccess }}</div>

            <div style="display: flex; gap: 12px; margin-top: 20px;">
              <button class="btn btn-primary" @click="updateDnsAccount" :disabled="dnsSavingAccount" style="flex: 1;">
                {{ dnsSavingAccount ? 'ä¿å­˜ä¸­...' : 'ä¿å­˜ä¿®æ”¹' }}
              </button>
              <button class="btn btn-secondary" @click="showEditDnsAccountModal = false" style="flex: 1;">å–æ¶ˆ</button>
            </div>
          </div>
        </div>

        <!-- æ·»åŠ /ç¼–è¾‘ DNS è®°å½•æ¨¡æ€æ¡† -->
        <div v-if="showDnsRecordModal" class="modal-overlay" @keydown.esc="showDnsRecordModal = false" @keydown.enter="saveDnsRecord" tabindex="-1">
          <div class="modal">
            <div class="modal-header">
              <div class="modal-title">{{ dnsEditingRecord ? 'ç¼–è¾‘ DNS è®°å½•' : 'æ·»åŠ  DNS è®°å½•' }}</div>
              <button class="modal-close" @click="showDnsRecordModal = false">&times;</button>
            </div>

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
              <div class="form-group">
                <label class="form-label">ç±»å‹ *</label>
                <select v-model="dnsRecordForm.type" class="form-input" :disabled="!!dnsEditingRecord">
                  <option v-for="t in dnsRecordTypes" :key="t" :value="t">{{ t }}</option>
                </select>
              </div>
              <div class="form-group">
                <label class="form-label">åç§° *</label>
                <input v-model="dnsRecordForm.name" class="form-input" placeholder="@ æˆ– www" />
                <div class="form-help">@ è¡¨ç¤ºæ ¹åŸŸå</div>
              </div>
            </div>

            <div class="form-group">
              <label class="form-label">å†…å®¹ *</label>
              <input v-model="dnsRecordForm.content" class="form-input" placeholder="IP åœ°å€æˆ–ç›®æ ‡åŸŸå" />
            </div>

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
              <div class="form-group">
                <label class="form-label">TTL</label>
                <select v-model="dnsRecordForm.ttl" class="form-input">
                  <option :value="1">Auto</option>
                  <option :value="60">1 åˆ†é’Ÿ</option>
                  <option :value="300">5 åˆ†é’Ÿ</option>
                  <option :value="600">10 åˆ†é’Ÿ</option>
                  <option :value="3600">1 å°æ—¶</option>
                  <option :value="86400">1 å¤©</option>
                </select>
              </div>
              <div class="form-group" v-if="dnsRecordForm.type === 'MX'">
                <label class="form-label">ä¼˜å…ˆçº§</label>
                <input v-model.number="dnsRecordForm.priority" type="number" class="form-input" placeholder="10" />
              </div>
            </div>

            <div class="form-group" v-if="canDnsBeProxied(dnsRecordForm.type)">
              <label style="display: flex; align-items: center; gap: 8px; font-size: 14px; cursor: pointer;">
                <input type="checkbox" v-model="dnsRecordForm.proxied" style="width: 16px; height: 16px;" />
                å¯ç”¨ Cloudflare ä»£ç† (æ©™äº‘)
              </label>
              <div class="form-help">å¯ç”¨åæµé‡å°†é€šè¿‡ Cloudflare CDN</div>
            </div>

            <div v-if="dnsRecordFormError" class="form-error">{{ dnsRecordFormError }}</div>

            <div style="display: flex; gap: 12px; margin-top: 20px;">
              <button class="btn btn-primary" @click="saveDnsRecord" :disabled="dnsSavingRecord" style="flex: 1;">
                {{ dnsSavingRecord ? 'ä¿å­˜ä¸­...' : 'ä¿å­˜' }}
              </button>
              <button class="btn btn-secondary" @click="showDnsRecordModal = false" style="flex: 1;">å–æ¶ˆ</button>
            </div>
          </div>
        </div>

        <!-- æ·»åŠ /ç¼–è¾‘æ¨¡æ¿æ¨¡æ€æ¡† -->
        <div v-if="showDnsTemplateModal" class="modal-overlay" @keydown.esc="showDnsTemplateModal = false" @keydown.enter="saveDnsTemplate" tabindex="-1">
          <div class="modal">
            <div class="modal-header">
              <div class="modal-title">{{ dnsEditingTemplate ? 'ç¼–è¾‘æ¨¡æ¿' : 'æ·»åŠ æ¨¡æ¿' }}</div>
              <button class="modal-close" @click="showDnsTemplateModal = false">&times;</button>
            </div>

            <div class="form-group">
              <label class="form-label">æ¨¡æ¿åç§° *</label>
              <input v-model="dnsTemplateForm.name" class="form-input" placeholder="ä¾‹å¦‚: CDN è®°å½•" />
            </div>

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
              <div class="form-group">
                <label class="form-label">è®°å½•ç±»å‹ *</label>
                <select v-model="dnsTemplateForm.type" class="form-input">
                  <option v-for="t in dnsRecordTypes" :key="t" :value="t">{{ t }}</option>
                </select>
              </div>
              <div class="form-group">
                <label class="form-label">TTL</label>
                <select v-model="dnsTemplateForm.ttl" class="form-input">
                  <option :value="1">Auto</option>
                  <option :value="300">5 åˆ†é’Ÿ</option>
                  <option :value="3600">1 å°æ—¶</option>
                </select>
              </div>
            </div>

            <div class="form-group">
              <label class="form-label">å†…å®¹ *</label>
              <input v-model="dnsTemplateForm.content" class="form-input" placeholder="IP åœ°å€æˆ–ç›®æ ‡åŸŸå" />
            </div>

            <div class="form-group">
              <label class="form-label">æè¿°ï¼ˆå¯é€‰ï¼‰</label>
              <input v-model="dnsTemplateForm.description" class="form-input" placeholder="æ¨¡æ¿ç”¨é€”è¯´æ˜" />
            </div>

            <div class="form-group" v-if="canDnsBeProxied(dnsTemplateForm.type)">
              <label style="display: flex; align-items: center; gap: 8px; font-size: 14px; cursor: pointer;">
                <input type="checkbox" v-model="dnsTemplateForm.proxied" style="width: 16px; height: 16px;" />
                å¯ç”¨ Cloudflare ä»£ç†
              </label>
            </div>

            <div v-if="dnsTemplateFormError" class="form-error">{{ dnsTemplateFormError }}</div>

            <div style="display: flex; gap: 12px; margin-top: 20px;">
              <button class="btn btn-primary" @click="saveDnsTemplate" :disabled="dnsSavingTemplate" style="flex: 1;">
                {{ dnsSavingTemplate ? 'ä¿å­˜ä¸­...' : 'ä¿å­˜' }}
              </button>
              <button class="btn btn-secondary" @click="showDnsTemplateModal = false" style="flex: 1;">å–æ¶ˆ</button>
            </div>
          </div>
        </div>

      </div>
      <!-- ==================== DNS ç®¡ç†éƒ¨åˆ†ç»“æŸ ==================== -->

      <!-- ==================== OpenAI API ç®¡ç†éƒ¨åˆ† ==================== -->
      <div v-if="mainActiveTab === 'openai'" class="tab-content" :class="getTabAnimationClass('openai')">
        <!-- OpenAI å­æ ‡ç­¾é¡µ -->
        <div class="sec-tabs">
          <button class="tab-btn" :class="{ active: openaiCurrentTab === 'endpoints' }"
            @click="openaiCurrentTab = 'endpoints'">
            <i class="fas fa-server"></i> API ç«¯ç‚¹
          </button>
          <button class="tab-btn" :class="{ active: openaiCurrentTab === 'accounts' }"
            @click="openaiCurrentTab = 'accounts'">
            <i class="fas fa-users"></i> è´¦å·ç®¡ç†
          </button>
        </div>

        <!-- API ç«¯ç‚¹æ ‡ç­¾é¡µ -->
        <div v-if="openaiCurrentTab === 'endpoints'" class="sub-tab-content quick-fade-in">
          <div v-if="openaiLoading" class="loading">
            <div class="spinner"></div>
            <div style="margin-top: 12px;">åŠ è½½ä¸­...</div>
          </div>

          <!-- ç«¯ç‚¹å¡ç‰‡åˆ—è¡¨ -->
          <div v-else>
            <div v-for="endpoint in openaiEndpoints" :key="endpoint.id" class="account-card"
              style="margin-bottom: 12px;">
              <!-- ç«¯ç‚¹å¤´éƒ¨ - å¯ç‚¹å‡»å±•å¼€æ¨¡å‹åˆ—è¡¨ -->
              <div class="account-header" @click="toggleOpenaiModels(endpoint.id)"
                style="cursor: pointer; align-items: center; padding-right: 10px;">
                <div class="account-info" style="flex: 1; align-items: center; padding-right: 0;">
                  <span style="font-size: 20px; display: inline-flex; align-items: center;">
                    <i class="fas fa-chevron-right toggle-icon" :style="{
                        transition: 'transform 0.4s cubic-bezier(0.4, 0, 0.2, 1)',
                        transform: isOpenaiEndpointExpanded(endpoint.id) ? 'rotate(90deg)' : 'rotate(0deg)'
                      }"></i>
                  </span>
                  <div style="flex: 1;">
                    <div style="display: flex; align-items: center; gap: 8px; flex-wrap: wrap; margin-bottom: 4px;">
                      <strong style="font-size: 16px;">{{ endpoint.name || 'æœªå‘½å' }}</strong>
                      <span class="proxied-badge"
                        :class="endpoint.status === 'valid' ? 'proxied-on' : (endpoint.status === 'invalid' ? 'proxied-off' : '')">
                        {{ endpoint.status === 'valid' ? 'æœ‰æ•ˆ' : (endpoint.status === 'invalid' ? 'æ— æ•ˆ' : 'æœªéªŒè¯') }}
                      </span>
                      <span v-if="endpoint.models && endpoint.models.length > 0"
                        style="font-size: 12px; color: var(--text-tertiary);">
                        {{ endpoint.models.length }} ä¸ªæ¨¡å‹
                      </span>
                    </div>
                    <div class="account-email" style="font-size: 12px;">
                      {{ endpoint.baseUrl }}
                    </div>
                  </div>
                </div>
              </div>

              <!-- æ¨¡å‹åˆ—è¡¨ - å¯å±•å¼€/æ”¶èµ· -->
              <div class="openai-models-container" :class="{ 'collapsed': !isOpenaiEndpointExpanded(endpoint.id) }">
                <div v-if="endpoint.models && endpoint.models.length > 0" class="models-grid">
                  <div v-for="model in endpoint.models" :key="getModelName(model)" class="model-tag-item"
                    @click="copyToClipboard(getModelName(model))" :title="'ç‚¹å‡»å¤åˆ¶: ' + getModelName(model)">
                    {{ getModelName(model) }}
                  </div>
                </div>
                <div v-else style="padding: 20px; text-align: center; color: var(--text-tertiary);">
                  <i class="fas fa-cube" style="font-size: 20px; margin-bottom: 8px; display: block;"></i>
                  æš‚æ— æ¨¡å‹æ•°æ®ï¼Œç‚¹å‡»åˆ·æ–°æŒ‰é’®è·å–
                </div>
              </div>
            </div>

            <div v-if="openaiEndpoints.length === 0" class="empty-state" style="padding: 40px;">
              <i class="fas fa-robot" style="font-size: 48px; margin-bottom: 16px;"></i>
              <div>æš‚æ—  API ç«¯ç‚¹ï¼Œç‚¹å‡»ä¸Šæ–¹æŒ‰é’®æ·»åŠ </div>
            </div>
          </div>
          <!-- </div> -->
        </div>

        <!-- è´¦å·ç®¡ç†æ ‡ç­¾é¡µ -->
        <div v-if="openaiCurrentTab === 'accounts'" class="sub-tab-content quick-fade-in">
          <div class="panel">
            <div class="panel-header">
              <div class="panel-title"></div>
              <div style="display: flex; gap: 8px;">
                <button class="btn btn-success" style="padding: 6px 12px;" @click="openAddOpenaiEndpointModal">
                  <i class="fas fa-plus"></i> æ·»åŠ è´¦å·
                </button>
                <button class="btn btn-secondary" style="padding: 6px 10px;" @click="refreshAllOpenaiEndpoints"
                  :disabled="openaiRefreshing">
                  <i class="fas fa-sync-alt" :class="{ 'fa-spin': openaiRefreshing }"></i> åˆ·æ–°å…¨éƒ¨
                </button>
                <button class="btn btn-secondary" @click="exportOpenaiEndpoints" style="padding: 6px 12px;">
                  <i class="fas fa-upload"></i> å¯¼å‡º
                </button>
                <button class="btn btn-secondary" @click="importOpenaiEndpointsFromFile" style="padding: 6px 12px;">
                  <i class="fas fa-download"></i> å¯¼å…¥
                </button>
              </div>
            </div>

            <div v-if="openaiLoading" class="loading">
              <div class="spinner"></div>
              <div style="margin-top: 12px;">åŠ è½½ä¸­...</div>
            </div>

            <div v-else class="table-container">
              <table class="data-table">
                <thead>
                  <tr>
                    <th>åç§°</th>
                    <th>API åœ°å€</th>
                    <th>API Key</th>
                    <th>çŠ¶æ€</th>
                    <th>æ¨¡å‹æ•°é‡</th>
                    <th>æ“ä½œ</th>
                  </tr>
                </thead>
                <tbody>
                  <tr v-for="endpoint in openaiEndpoints" :key="endpoint.id">
                    <td>{{ endpoint.name || 'æœªå‘½å' }}</td>
                    <td>
                      <div style="display: flex; align-items: center; gap: 4px;">
                        <span style="font-family: monospace; font-size: 12px;">{{ endpoint.baseUrl }}</span>
                        <button class="copy-btn" @click.stop="copyToClipboard(endpoint.baseUrl)" title="å¤åˆ¶åœ°å€"
                          style="padding: 2px 4px;">
                          <i class="fas fa-copy"></i>
                        </button>
                        <a :href="endpoint.baseUrl" target="_blank" rel="noopener noreferrer" title="åœ¨æ–°æ ‡ç­¾é¡µæ‰“å¼€"
                          class="copy-btn" style="padding: 2px 4px;">
                          <i class="fas fa-external-link-alt"></i>
                        </a>
                      </div>
                    </td>
                    <td>
                      <div style="display: flex; align-items: center; gap: 4px;">
                        <span style="font-family: monospace; font-size: 12px;">
                          {{ endpoint.showKey ? endpoint.apiKey : maskApiKey(endpoint.apiKey) }}
                        </span>
                        <button class="copy-btn" @click.stop="endpoint.showKey = !endpoint.showKey"
                          :title="endpoint.showKey ? 'éšè—' : 'æ˜¾ç¤º'" style="padding: 2px 4px;">
                          <i class="fas" :class="endpoint.showKey ? 'fa-eye-slash' : 'fa-eye'"></i>
                        </button>
                        <button class="copy-btn" @click.stop="copyToClipboard(endpoint.apiKey)" title="å¤åˆ¶ Key"
                          style="padding: 2px 4px;">
                          <i class="fas fa-copy"></i>
                        </button>
                      </div>
                    </td>
                    <td>
                      <span class="proxied-badge"
                        :class="endpoint.status === 'valid' ? 'proxied-on' : (endpoint.status === 'invalid' ? 'proxied-off' : '')">
                        {{ endpoint.status === 'valid' ? 'æœ‰æ•ˆ' : (endpoint.status === 'invalid' ? 'æ— æ•ˆ' : 'æœªéªŒè¯') }}
                      </span>
                    </td>
                    <td>
                      <span v-if="endpoint.models && endpoint.models.length > 0">
                        {{ endpoint.models.length }} ä¸ª
                      </span>
                      <span v-else style="color: var(--text-tertiary);">-</span>
                    </td>
                    <td class="actions">
                      <button class="btn btn-secondary" style="padding: 4px 8px; font-size: 12px;"
                        @click="verifyOpenaiEndpoint(endpoint)" title="éªŒè¯">
                        <i class="fas fa-sync-alt"></i>
                      </button>
                      <button class="btn btn-primary" style="padding: 4px 8px; font-size: 12px;"
                        @click="editOpenaiEndpoint(endpoint)" title="ç¼–è¾‘">
                        <i class="fas fa-edit"></i>
                      </button>
                      <button class="btn btn-danger" style="padding: 4px 8px; font-size: 12px;"
                        @click="deleteOpenaiEndpoint(endpoint)" title="åˆ é™¤">
                        <i class="fas fa-trash"></i>
                      </button>
                    </td>
                  </tr>
                </tbody>
              </table>
              <div v-if="openaiEndpoints.length === 0" class="empty-state">
                <i class="fas fa-robot" style="font-size: 48px; margin-bottom: 16px;"></i>
                <div>æš‚æ—  API è´¦å·ï¼Œç‚¹å‡»ä¸Šæ–¹æŒ‰é’®æ·»åŠ </div>
              </div>
            </div>
          </div>

          <!-- æ‰¹é‡æ·»åŠ  -->
          <div class="panel" style="margin-top: 16px;">
            <div class="panel-header">
              <div class="panel-title">æ‰¹é‡æ·»åŠ ç«¯ç‚¹</div>
            </div>
            <div>
              <p style="color: var(--text-secondary); font-size: 13px; margin-bottom: 12px;">
                æ¯è¡Œä¸€ä¸ªç«¯ç‚¹ï¼Œæ ¼å¼ï¼š<code>åç§°:APIåœ°å€:API_Key</code> æˆ– JSON æ ¼å¼
              </p>
              <textarea v-model="openaiBatchText" class="form-textarea" placeholder='æ¯è¡Œä¸€ä¸ªï¼Œæ ¼å¼: åç§°:https://api.example.com:sk-xxx
æˆ– JSON æ ¼å¼:
[{"name": "ç¤ºä¾‹", "baseUrl": "https://api.example.com", "apiKey": "sk-xxx"}]'
                style="min-height: 150px; font-family: monospace; font-size: 12px;"></textarea>
              <div v-if="openaiBatchError" class="form-error" style="margin-top: 8px;">{{ openaiBatchError }}</div>
              <div v-if="openaiBatchSuccess" class="form-success" style="margin-top: 8px;">{{ openaiBatchSuccess }}
              </div>
              <button class="btn btn-primary" @click="batchAddOpenaiEndpoints" :disabled="openaiAdding"
                style="width: 100%; margin-top: 12px;">
                {{ openaiAdding ? 'æ·»åŠ ä¸­...' : 'æ‰¹é‡æ·»åŠ ' }}
              </button>
            </div>
          </div>
        </div>

        <!-- æ·»åŠ /ç¼–è¾‘ç«¯ç‚¹æ¨¡æ€æ¡† -->
        <div v-if="showOpenaiEndpointModal" class="modal-overlay" @keydown.esc="showOpenaiEndpointModal = false" @keydown.ctrl.enter="saveOpenaiEndpoint" tabindex="-1">
          <div class="modal">
            <div class="modal-header">
              <div class="modal-title">{{ openaiEditingEndpoint ? 'ç¼–è¾‘ API ç«¯ç‚¹' : 'æ·»åŠ  API ç«¯ç‚¹' }}</div>
              <button class="modal-close" @click="showOpenaiEndpointModal = false">&times;</button>
            </div>

            <div class="form-group">
              <label class="form-label">åç§°</label>
              <input v-model="openaiEndpointForm.name" class="form-input" placeholder="ä¾‹å¦‚: OpenAI å®˜æ–¹" />
            </div>

            <div class="form-group">
              <label class="form-label">API åœ°å€ *</label>
              <input v-model="openaiEndpointForm.baseUrl" class="form-input" placeholder="https://api.openai.com" />
              <div class="form-help">OpenAI å…¼å®¹çš„ API åŸºç¡€åœ°å€ï¼ˆä¸éœ€è¦ /v1ï¼‰</div>
            </div>

            <div class="form-group">
              <label class="form-label">API Key *</label>
              <input v-model="openaiEndpointForm.apiKey" type="text" class="form-input" placeholder="sk-xxxxxxxx"
                style="font-family: monospace;" />
            </div>

            <div class="form-group">
              <label class="form-label">å¤‡æ³¨</label>
              <textarea v-model="openaiEndpointForm.notes" class="form-textarea" placeholder="å¯é€‰å¤‡æ³¨ä¿¡æ¯"
                style="min-height: 60px;"></textarea>
            </div>

            <div v-if="openaiEndpointFormError" class="form-error">{{ openaiEndpointFormError }}</div>

            <div style="display: flex; gap: 12px; margin-top: 20px;">
              <button class="btn btn-primary" @click="saveOpenaiEndpoint" :disabled="openaiSaving" style="flex: 1;">
                {{ openaiSaving ? 'ä¿å­˜ä¸­...' : 'ä¿å­˜' }}
              </button>
              <button class="btn btn-secondary" @click="showOpenaiEndpointModal = false" style="flex: 1;">å–æ¶ˆ</button>
            </div>
          </div>
        </div>

      </div>
      <!-- ==================== OpenAI API ç®¡ç†éƒ¨åˆ†ç»“æŸ ==================== -->

      <!-- ==================== æœåŠ¡å™¨ç®¡ç†éƒ¨åˆ† ==================== -->
      <div v-if="mainActiveTab === 'server'" class="tab-content" :class="getTabAnimationClass('server')">
        <!-- æœåŠ¡å™¨å­æ ‡ç­¾é¡µ -->
        <div class="sec-tabs">
          <button class="tab-btn" :class="{ active: serverCurrentTab === 'list' }"
            @click="serverCurrentTab = 'list'" style="background: var(--primary-color) !important;"
            v-if="serverCurrentTab === 'list'">
            <i class="fas fa-server"></i> æœåŠ¡å™¨åˆ—è¡¨
          </button>
          <button class="tab-btn" :class="{ active: serverCurrentTab === 'list' }"
            @click="serverCurrentTab = 'list'" v-else>
            <i class="fas fa-server"></i> æœåŠ¡å™¨åˆ—è¡¨
          </button>
          <button class="tab-btn" :class="{ active: serverCurrentTab === 'management' }"
            @click="serverCurrentTab = 'management'" style="background: var(--primary-color) !important;"
            v-if="serverCurrentTab === 'management'">
            <i class="fas fa-cog"></i> åå°ç®¡ç†
          </button>
          <button class="tab-btn" :class="{ active: serverCurrentTab === 'management' }"
            @click="serverCurrentTab = 'management'" v-else>
            <i class="fas fa-cog"></i> åå°ç®¡ç†
          </button>
        </div>

        <!-- æœåŠ¡å™¨åˆ—è¡¨æ ‡ç­¾é¡µ -->
        <div v-if="serverCurrentTab === 'list'" class="sub-tab-content quick-fade-in">
          <div class="server-list-container">
            <div class="server-list-header">
              <h2>æœåŠ¡å™¨åˆ—è¡¨</h2>
              <div class="server-list-actions">
                <button id="add-server-btn" class="btn btn-primary">
                  <i class="fas fa-plus"></i> æ·»åŠ æœåŠ¡å™¨
                </button>
                <button id="refresh-servers-btn" class="btn btn-secondary">
                  <i class="fas fa-sync-alt"></i> åˆ·æ–°
                </button>
                <button id="probe-all-servers-btn" class="btn btn-secondary">
                  <i class="fas fa-heartbeat"></i> æ‰‹åŠ¨æ¢æµ‹
                </button>
                <button id="import-servers-btn" class="btn btn-secondary">
                  <i class="fas fa-file-import"></i> å¯¼å…¥
                </button>
                <button id="export-servers-btn" class="btn btn-secondary">
                  <i class="fas fa-file-export"></i> å¯¼å‡º
                </button>
              </div>
            </div>
            <div id="server-list-container"></div>
          </div>
        </div>

        <!-- åå°ç®¡ç†æ ‡ç­¾é¡µ -->
        <div v-if="serverCurrentTab === 'management'" class="sub-tab-content quick-fade-in">
          <div class="server-management-container">
            <!-- ç›‘æ§é…ç½® -->
            <div class="management-section">
              <div class="management-section-header">
                <h3><i class="fas fa-cog"></i> ç›‘æ§é…ç½®</h3>
              </div>
              <div class="management-section-body">
                <div class="form-row">
                  <div class="form-group">
                    <label class="form-label">æ¢æµ‹é—´éš”ï¼ˆç§’ï¼‰</label>
                    <input v-model.number="monitorConfig.interval" type="number" class="form-input" min="10"
                      placeholder="60" />
                    <div class="form-help">æœåŠ¡å™¨å¥åº·æ£€æŸ¥çš„æ—¶é—´é—´éš”ï¼Œå»ºè®®ä¸ä½äº 10 ç§’</div>
                  </div>
                  <div class="form-group">
                    <label class="form-label">æ¢æµ‹è¶…æ—¶ï¼ˆç§’ï¼‰</label>
                    <input v-model.number="monitorConfig.timeout" type="number" class="form-input" min="5"
                      placeholder="10" />
                    <div class="form-help">å•æ¬¡æ¢æµ‹çš„è¶…æ—¶æ—¶é—´</div>
                  </div>
                  <div class="form-group">
                    <label class="form-label">æ—¥å¿—ä¿ç•™å¤©æ•°</label>
                    <input v-model.number="monitorConfig.logRetentionDays" type="number" class="form-input" min="1"
                      placeholder="7" />
                    <div class="form-help">è‡ªåŠ¨æ¸…ç†è¶…è¿‡æŒ‡å®šå¤©æ•°çš„æ—¥å¿—</div>
                  </div>
                </div>
                <div class="form-actions">
                  <button class="btn btn-primary" @click="saveMonitorConfig" :disabled="monitorConfigSaving">
                    <i class="fas fa-save"></i>
                    {{ monitorConfigSaving ? 'ä¿å­˜ä¸­...' : 'ä¿å­˜é…ç½®' }}
                  </button>
                  <button class="btn btn-secondary" @click="loadMonitorConfig">
                    <i class="fas fa-sync-alt"></i> é‡ç½®
                  </button>
                </div>
                <div v-if="monitorConfigError" class="form-error">
                  {{ monitorConfigError }}
                </div>
                <div v-if="monitorConfigSuccess" class="form-success">
                  {{ monitorConfigSuccess }}
                </div>
              </div>
            </div>

            <!-- æ¢æµ‹æ—¥å¿— -->
            <div class="management-section">
              <div class="management-section-header">
                <h3><i class="fas fa-history"></i> æ¢æµ‹æ—¥å¿—</h3>
                <div class="management-section-actions">
                  <select v-model="logFilter.serverId" class="form-select" @change="loadMonitorLogs">
                    <option value="">å…¨éƒ¨æœåŠ¡å™¨</option>
                    <option v-for="server in serverList" :key="server.id" :value="server.id">
                      {{ server.name }}
                    </option>
                  </select>
                  <select v-model="logFilter.status" class="form-select" @change="loadMonitorLogs">
                    <option value="">å…¨éƒ¨çŠ¶æ€</option>
                    <option value="online">åœ¨çº¿</option>
                    <option value="offline">ç¦»çº¿</option>
                  </select>
                  <button class="btn btn-sm btn-secondary" @click="loadMonitorLogs">
                    <i class="fas fa-sync-alt"></i> åˆ·æ–°
                  </button>
                </div>
              </div>
              <div class="management-section-body">
                <div v-if="monitorLogsLoading" class="loading-state">
                  <div class="spinner"></div>
                  <p>åŠ è½½ä¸­...</p>
                </div>
                <div v-else-if="monitorLogs.length === 0" class="empty-state">
                  <p>æš‚æ— æ¢æµ‹æ—¥å¿—</p>
                </div>
                <div v-else class="monitor-logs-table">
                  <table class="table">
                    <thead>
                      <tr>
                        <th>æ—¶é—´</th>
                        <th>æœåŠ¡å™¨</th>
                        <th>çŠ¶æ€</th>
                        <th>å“åº”æ—¶é—´</th>
                        <th>é”™è¯¯ä¿¡æ¯</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr v-for="log in monitorLogs" :key="log.id">
                        <td>{{ formatDateTime(log.check_time) }}</td>
                        <td>{{ log.server_name }}</td>
                        <td>
                          <span class="status-badge" :class="'status-' + log.status">
                            {{ log.status === 'online' ? 'åœ¨çº¿' : 'ç¦»çº¿' }}
                          </span>
                        </td>
                        <td>{{ log.response_time ? log.response_time + 'ms' : '-' }}</td>
                        <td>
                          <span class="error-message">{{ log.error_message || '-' }}</span>
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </div>
                <div v-if="monitorLogs.length > 0" class="pagination">
                  <button class="btn btn-sm btn-secondary" @click="loadMonitorLogs(logPage - 1)"
                    :disabled="logPage <= 1">
                    ä¸Šä¸€é¡µ
                  </button>
                  <span class="pagination-info">ç¬¬ {{ logPage }} é¡µ</span>
                  <button class="btn btn-sm btn-secondary" @click="loadMonitorLogs(logPage + 1)"
                    :disabled="monitorLogs.length < logPageSize">
                    ä¸‹ä¸€é¡µ
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>

      </div>
      <!-- ==================== æœåŠ¡å™¨ç®¡ç†éƒ¨åˆ†ç»“æŸ ==================== -->

    </div>

    <!-- ==================== æœåŠ¡å™¨ç®¡ç†æ¨¡æ€æ¡† ==================== -->
    <!-- æ·»åŠ /ç¼–è¾‘æœåŠ¡å™¨æ¨¡æ€æ¡† -->
    <div v-if="showServerModal" class="modal-overlay" @keydown.esc="closeServerModal" @keydown.ctrl.enter="saveServer" tabindex="-1">
      <div class="modal modal-lg">
        <div class="modal-header">
          <div class="modal-title">
            <i class="fas fa-server"></i>
            {{ serverModalMode === 'add' ? 'æ·»åŠ æœåŠ¡å™¨' : 'ç¼–è¾‘æœåŠ¡å™¨' }}
          </div>
          <button class="modal-close" @click="closeServerModal">&times;</button>
        </div>
        <div class="modal-body">
          <div class="form-group">
            <label class="form-label">æœåŠ¡å™¨åç§° *</label>
            <input v-model="serverForm.name" type="text" class="form-input" placeholder="ä¾‹å¦‚ï¼šç”Ÿäº§æœåŠ¡å™¨" />
          </div>
          <div class="form-row">
            <div class="form-group" style="flex: 2;">
              <label class="form-label">ä¸»æœºåœ°å€ *</label>
              <input v-model="serverForm.host" type="text" class="form-input" placeholder="IP åœ°å€æˆ–åŸŸå" />
            </div>
            <div class="form-group" style="flex: 1;">
              <label class="form-label">ç«¯å£ *</label>
              <input v-model.number="serverForm.port" type="number" class="form-input" placeholder="22" />
            </div>
          </div>
          <div class="form-group">
            <label class="form-label">ç”¨æˆ·å *</label>
            <input v-model="serverForm.username" type="text" class="form-input" placeholder="root" />
          </div>
          <div class="form-group">
            <label class="form-label">è®¤è¯æ–¹å¼ *</label>
            <div class="form-radio-group">
              <label class="form-radio">
                <input type="radio" v-model="serverForm.authType" value="password" />
                <span>å¯†ç è®¤è¯</span>
              </label>
              <label class="form-radio">
                <input type="radio" v-model="serverForm.authType" value="privateKey" />
                <span>å¯†é’¥è®¤è¯</span>
              </label>
            </div>
          </div>
          <div v-if="serverForm.authType === 'password'" class="form-group">
            <label class="form-label">å¯†ç  *</label>
            <input v-model="serverForm.password" type="password" class="form-input" placeholder="è¯·è¾“å…¥å¯†ç " />
          </div>
          <div v-if="serverForm.authType === 'privateKey'" class="form-group">
            <label class="form-label">ç§é’¥ *</label>
            <textarea v-model="serverForm.privateKey" class="form-textarea" rows="6"
              placeholder="è¯·ç²˜è´´ SSH ç§é’¥å†…å®¹ï¼ˆPEM æ ¼å¼ï¼‰"></textarea>
            <div class="form-help">æ”¯æŒ RSAã€ECDSAã€Ed25519 ç­‰æ ¼å¼çš„ç§é’¥</div>
          </div>
          <div v-if="serverForm.authType === 'privateKey'" class="form-group">
            <label class="form-label">ç§é’¥å¯†ç ï¼ˆå¯é€‰ï¼‰</label>
            <input v-model="serverForm.passphrase" type="password" class="form-input"
              placeholder="å¦‚æœç§é’¥æœ‰å¯†ç ä¿æŠ¤ï¼Œè¯·è¾“å…¥" />
          </div>
          <div class="form-group">
            <label class="form-label">æ ‡ç­¾ï¼ˆå¯é€‰ï¼‰</label>
            <input v-model="serverForm.tagsInput" type="text" class="form-input"
              placeholder="å¤šä¸ªæ ‡ç­¾ç”¨é€—å·åˆ†éš”ï¼Œä¾‹å¦‚ï¼šç”Ÿäº§,WebæœåŠ¡å™¨" />
            <div class="form-help">æ ‡ç­¾ç”¨äºåˆ†ç±»å’Œç­›é€‰æœåŠ¡å™¨</div>
          </div>
          <div class="form-group">
            <label class="form-label">å¤‡æ³¨ï¼ˆå¯é€‰ï¼‰</label>
            <textarea v-model="serverForm.description" class="form-textarea" rows="3"
              placeholder="æœåŠ¡å™¨ç”¨é€”ã€é…ç½®ç­‰å¤‡æ³¨ä¿¡æ¯"></textarea>
          </div>
          <div v-if="serverModalError" class="form-error">
            {{ serverModalError }}
          </div>
        </div>
        <div class="modal-footer">
          <button class="btn btn-secondary" @click="closeServerModal" :disabled="serverModalSaving">
            å–æ¶ˆ
          </button>
          <button class="btn btn-primary" @click="testServerConnection" :disabled="serverModalSaving">
            <i class="fas fa-plug"></i> æµ‹è¯•è¿æ¥
          </button>
          <button class="btn btn-primary" @click="saveServer" :disabled="serverModalSaving">
            <i class="fas fa-save"></i>
            {{ serverModalSaving ? 'ä¿å­˜ä¸­...' : 'ä¿å­˜' }}
          </button>
        </div>
      </div>
    </div>

    <!-- æ‰¹é‡å¯¼å…¥æœåŠ¡å™¨æ¨¡æ€æ¡† -->
    <div v-if="showImportServerModal" class="modal-overlay" @keydown.esc="closeImportServerModal" @keydown.enter="confirmImportServers" tabindex="-1">
      <div class="modal modal-lg">
        <div class="modal-header">
          <div class="modal-title">
            <i class="fas fa-file-import"></i>
            æ‰¹é‡å¯¼å…¥æœåŠ¡å™¨
          </div>
          <button class="modal-close" @click="closeImportServerModal">&times;</button>
        </div>
        <div class="modal-body">
          <div class="form-group">
            <label class="form-label">é€‰æ‹© JSON æ–‡ä»¶</label>
            <input type="file" ref="importFileInput" accept=".json" class="form-input"
              @change="handleImportFileChange" />
            <div class="form-help">è¯·é€‰æ‹©ä¹‹å‰å¯¼å‡ºçš„æœåŠ¡å™¨é…ç½® JSON æ–‡ä»¶</div>
          </div>
          <div v-if="importPreview" class="form-group">
            <label class="form-label">é¢„è§ˆï¼ˆå°†å¯¼å…¥ {{ importPreview.length }} å°æœåŠ¡å™¨ï¼‰</label>
            <div class="import-preview-list">
              <div v-for="(server, index) in importPreview" :key="index" class="import-preview-item">
                <i class="fas fa-server"></i>
                <span>{{ server.name }} ({{ server.username }}@{{ server.host }}:{{ server.port }})</span>
              </div>
            </div>
          </div>
          <div v-if="importModalError" class="form-error">
            {{ importModalError }}
          </div>
        </div>
        <div class="modal-footer">
          <button class="btn btn-secondary" @click="closeImportServerModal" :disabled="importModalSaving">
            å–æ¶ˆ
          </button>
          <button class="btn btn-primary" @click="confirmImportServers"
            :disabled="importModalSaving || !importPreview || importPreview.length === 0">
            <i class="fas fa-check"></i>
            {{ importModalSaving ? 'å¯¼å…¥ä¸­...' : 'ç¡®è®¤å¯¼å…¥' }}
          </button>
        </div>
      </div>
    </div>
    <!-- Docker å®¹å™¨è¯¦æƒ…æ¨¡æ€æ¡† -->
    <div v-if="showDockerModal" class="modal-overlay" @keydown.esc="closeDockerModal" tabindex="-1">
      <div class="modal modal-lg">
        <div class="modal-header">
          <div class="modal-title">
            <i class="fas fa-docker"></i>
            Docker å®¹å™¨ - {{ dockerModalServer?.name }}
          </div>
          <button class="modal-close" @click="closeDockerModal">&times;</button>
        </div>
        <div class="modal-body">
          <div v-if="dockerModalData" class="docker-modal-content">
            <div class="docker-info-header">
              <div class="docker-info-item">
                <span class="docker-info-label">Docker ç‰ˆæœ¬</span>
                <span class="docker-info-value">{{ dockerModalData.version }}</span>
              </div>
              <div class="docker-info-item">
                <span class="docker-info-label">å®¹å™¨æ€»æ•°</span>
                <span class="docker-info-value">{{ dockerModalData.containers?.length || 0 }}</span>
              </div>
              <div class="docker-info-item">
                <span class="docker-info-label">è¿è¡Œä¸­</span>
                <span class="docker-info-value">
                  {{ dockerModalData.containers?.filter(c => c.status.includes('Up')).length || 0 }}
                </span>
              </div>
            </div>
            <div class="docker-container-table">
              <table class="table">
                <thead>
                  <tr>
                    <th>å®¹å™¨åç§°</th>
                    <th>é•œåƒ</th>
                    <th>çŠ¶æ€</th>
                    <th>ç«¯å£</th>
                  </tr>
                </thead>
                <tbody>
                  <tr v-for="(container, index) in dockerModalData.containers" :key="index">
                    <td>
                      <span class="docker-container-name-badge">{{ container.name }}</span>
                    </td>
                    <td>
                      <span class="docker-image-name">{{ container.image || '-' }}</span>
                    </td>
                    <td>
                      <span class="docker-status-badge"
                        :class="container.status.includes('Up') ? 'status-running' : 'status-exited'">
                        {{ container.status }}
                      </span>
                    </td>
                    <td>
                      <span class="docker-ports">{{ container.ports || '-' }}</span>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button class="btn btn-secondary" @click="closeDockerModal">
            å…³é—­
          </button>
        </div>
      </div>
    </div>
    <!-- ==================== æœåŠ¡å™¨ç®¡ç†æ¨¡æ€æ¡†ç»“æŸ ==================== -->

    <!-- SSH ç»ˆç«¯æ¨¡æ€æ¡†ï¼ˆæ”¯æŒå¤šæ ‡ç­¾é¡µï¼‰ -->
    <div v-if="showSSHTerminalModal" class="modal-overlay" @keydown.esc="closeSSHTerminal" tabindex="-1">
      <div class="modal modal-xl ssh-terminal-modal">
        <div class="modal-header ssh-terminal-header">
          <div class="ssh-tabs">
            <div v-for="session in sshSessions" :key="session.id"
                 class="ssh-tab" :class="{ active: session.id === activeSessionId }"
                 @click="switchSession(session.id)">
              <span class="ssh-tab-name">{{ session.server.name }}</span>
              <button class="ssh-tab-close" @click.stop="closeSession(session.id)" title="å…³é—­">
                <i class="fas fa-times"></i>
              </button>
            </div>
            <button class="ssh-tab-add" @click="showAddSessionModal" title="æ–°å»ºç»ˆç«¯">
              <i class="fas fa-plus"></i>
            </button>
          </div>
          <button class="modal-close" @click="closeSSHTerminal">&times;</button>
        </div>
        <div class="modal-body" style="padding: 0; background: #1e1e1e;">
          <div v-for="session in sshSessions" :key="'term-' + session.id"
               :id="'ssh-terminal-' + session.id"
               class="ssh-terminal-pane"
               :style="{ display: session.id === activeSessionId ? 'block' : 'none' }">
          </div>
        </div>
        <div class="modal-footer" style="background: #2d2d2d; border-top: 1px solid #444;">
          <div style="flex: 1; color: #888; font-size: 12px;">
            <i class="fas fa-info-circle"></i>
            æç¤º: ä½¿ç”¨ Ctrl+C ä¸­æ–­å‘½ä»¤ï¼Œä¸Šä¸‹ç®­å¤´æµè§ˆå†å²å‘½ä»¤
          </div>
          <button class="btn btn-secondary" @click="closeSSHTerminal">
            <i class="fas fa-times"></i> å…³é—­æ‰€æœ‰
          </button>
        </div>
      </div>
    </div>

    <!-- æ–°å»ºç»ˆç«¯ä¼šè¯é€‰æ‹©æ¨¡æ€æ¡† -->
    <div v-if="showAddSessionSelectModal" class="modal-overlay" @keydown.esc="showAddSessionSelectModal = false" tabindex="-1">
      <div class="modal modal-sm">
        <div class="modal-header">
          <div class="modal-title">
            <i class="fas fa-terminal"></i>
            é€‰æ‹©æœåŠ¡å™¨
          </div>
          <button class="modal-close" @click="showAddSessionSelectModal = false">&times;</button>
        </div>
        <div class="modal-body" style="max-height: 400px; overflow-y: auto;">
          <div v-if="serverList.length === 0" class="empty-state">
            <p>æš‚æ— å¯ç”¨æœåŠ¡å™¨</p>
          </div>
          <div v-else class="server-select-list">
            <div v-for="server in serverList" :key="server.id"
                 class="server-select-item" @click="addSessionForServer(server)">
              <div class="server-status-indicator" :class="server.status || 'unknown'"></div>
              <div class="server-select-info">
                <div class="server-select-name">{{ server.name }}</div>
                <div class="server-select-host">{{ server.host }}:{{ server.port }}</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- SFTP æ–‡ä»¶ç®¡ç†æ¨¡æ€æ¡† -->
    <div v-if="showFileManagerModal" class="modal-overlay" @keydown.esc="closeFileManager" tabindex="-1">
      <div class="modal modal-xl file-manager-modal">
        <div class="modal-header">
          <div class="modal-title">
            <i class="fas fa-folder-open"></i>
            æ–‡ä»¶ç®¡ç† - {{ fileManagerServer?.name }}
          </div>
          <button class="modal-close" @click="closeFileManager">&times;</button>
        </div>
        <div class="modal-body" style="padding: 0;">
          <!-- å·¥å…·æ  -->
          <div class="file-manager-toolbar">
            <div class="file-manager-breadcrumb">
              <button class="btn btn-sm btn-secondary" @click="navigateToParent" :disabled="fileManagerPath === '/'">
                <i class="fas fa-arrow-up"></i>
              </button>
              <button class="btn btn-sm btn-secondary" @click="navigateToHome">
                <i class="fas fa-home"></i>
              </button>
              <div class="breadcrumb-path">
                <span v-for="(segment, index) in fileManagerBreadcrumbs" :key="index"
                      class="breadcrumb-segment" @click="navigateToPath(segment.path)">
                  {{ segment.name }}<span v-if="index < fileManagerBreadcrumbs.length - 1"> / </span>
                </span>
              </div>
            </div>
            <div class="file-manager-actions">
              <button class="btn btn-sm btn-success" @click="showCreateFolderDialog">
                <i class="fas fa-folder-plus"></i> æ–°å»ºæ–‡ä»¶å¤¹
              </button>
              <label class="btn btn-sm btn-primary" style="margin: 0;">
                <i class="fas fa-upload"></i> ä¸Šä¼ æ–‡ä»¶
                <input type="file" ref="uploadFileInput" @change="handleFileUpload" style="display: none;" multiple />
              </label>
              <button class="btn btn-sm btn-secondary" @click="refreshFileList" :disabled="fileManagerLoading">
                <i class="fas fa-sync-alt" :class="{ 'fa-spin': fileManagerLoading }"></i>
              </button>
            </div>
          </div>

          <!-- æ–‡ä»¶åˆ—è¡¨ -->
          <div class="file-manager-content">
            <div v-if="fileManagerLoading" class="file-manager-loading">
              <div class="spinner"></div>
              <p>åŠ è½½ä¸­...</p>
            </div>
            <div v-else-if="fileManagerError" class="file-manager-error">
              <i class="fas fa-exclamation-triangle"></i>
              <p>{{ fileManagerError }}</p>
              <button class="btn btn-sm btn-primary" @click="refreshFileList">é‡è¯•</button>
            </div>
            <div v-else class="file-list">
              <div class="file-list-header">
                <div class="file-col file-name">åç§°</div>
                <div class="file-col file-size">å¤§å°</div>
                <div class="file-col file-modified">ä¿®æ”¹æ—¶é—´</div>
                <div class="file-col file-permissions">æƒé™</div>
                <div class="file-col file-actions">æ“ä½œ</div>
              </div>
              <div v-if="fileManagerFiles.length === 0" class="file-list-empty">
                <i class="fas fa-folder-open"></i>
                <p>ç©ºæ–‡ä»¶å¤¹</p>
              </div>
              <div v-for="file in fileManagerFiles" :key="file.name"
                   class="file-list-item" :class="{ 'is-directory': file.type === 'directory' }"
                   @dblclick="handleFileDoubleClick(file)">
                <div class="file-col file-name">
                  <i class="fas" :class="getFileIcon(file)"></i>
                  <span>{{ file.name }}</span>
                </div>
                <div class="file-col file-size">{{ file.type === 'directory' ? '-' : formatFileSize(file.size) }}</div>
                <div class="file-col file-modified">{{ formatFileTime(file.modifyTime) }}</div>
                <div class="file-col file-permissions">{{ formatPermissions(file.rights) }}</div>
                <div class="file-col file-actions">
                  <button v-if="file.type !== 'directory'" class="btn btn-xs btn-primary"
                          @click.stop="downloadFile(file)" title="ä¸‹è½½">
                    <i class="fas fa-download"></i>
                  </button>
                  <button class="btn btn-xs btn-secondary" @click.stop="showRenameDialog(file)" title="é‡å‘½å">
                    <i class="fas fa-edit"></i>
                  </button>
                  <button class="btn btn-xs btn-danger" @click.stop="deleteFileItem(file)" title="åˆ é™¤">
                    <i class="fas fa-trash"></i>
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <div style="flex: 1; color: var(--text-secondary); font-size: 12px;">
            <span v-if="fileManagerFiles.length > 0">
              {{ fileManagerFiles.filter(f => f.type === 'directory').length }} ä¸ªæ–‡ä»¶å¤¹ï¼Œ
              {{ fileManagerFiles.filter(f => f.type !== 'directory').length }} ä¸ªæ–‡ä»¶
            </span>
          </div>
          <button class="btn btn-secondary" @click="closeFileManager">
            <i class="fas fa-times"></i> å…³é—­
          </button>
        </div>
      </div>
    </div>

    <!-- è®¾ç½®ä¾§è¾¹æ  -->
    <div v-if="showSettingsModal" @keydown.esc="showSettingsModal = false" tabindex="-1">
      <div class="settings-sidebar-overlay"></div>
      <div class="settings-sidebar">
        <!-- ä¾§è¾¹æ å¤´éƒ¨ -->
        <div class="settings-sidebar-header">
          <div class="settings-sidebar-title">
            <i class="fas fa-cog"></i>
            <span>ç³»ç»Ÿè®¾ç½®</span>
          </div>
          <button class="settings-sidebar-close" @click="showSettingsModal = false">&times;</button>
        </div>

        <!-- ä¾§è¾¹æ å†…å®¹ -->
        <div class="settings-sidebar-content">
          <!-- æ¨¡å—ç®¡ç† -->
          <div class="settings-section">
            <div class="settings-section-title">æ¨¡å—ç®¡ç†</div>
            <div>
              <div v-for="(module, index) in moduleOrder" :key="module" class="draggable-module-item" draggable="true"
                @dragstart="handleDragStart($event, index)" @dragend="handleDragEnd"
                @dragover.prevent="handleDragOver($event, index)" @drop="handleDrop($event, index)">
                <i class="fas fa-grip-vertical drag-handle"></i>
                <i class="draggable-module-icon fas" :class="getModuleIcon(module)"></i>
                <span class="draggable-module-name">{{ getModuleName(module) }}</span>
                <!-- æ˜¾ç¤º/éšè—åˆ‡æ¢æŒ‰é’® -->
                <button class="btn btn-sm" :class="moduleVisibility[module] ? 'btn-success' : 'btn-secondary'"
                  @click.stop="toggleModuleVisibility(module)" style="padding: 4px 8px; font-size: 12px;">
                  <i class="fas" :class="moduleVisibility[module] ? 'fa-eye' : 'fa-eye-slash'"></i>
                </button>
              </div>
            </div>
            <div class="form-help" style="margin-top: 8px;">æ‹–æ‹½è°ƒæ•´é¡ºåºï¼Œç‚¹å‡»çœ¼ç›å›¾æ ‡åˆ‡æ¢æ˜¾ç¤º/éšè—</div>
          </div>

          <!-- ä¿®æ”¹å¯†ç  -->
          <div class="settings-section">
            <div class="settings-section-title">ä¿®æ”¹ç™»å½•å¯†ç </div>
            <div class="form-group">
              <input v-model="newPassword" type="password" class="form-input" placeholder="è¾“å…¥æ–°å¯†ç ï¼ˆè‡³å°‘6ä½ï¼‰" />
            </div>
            <div class="form-group">
              <input v-model="confirmPassword" type="password" class="form-input" placeholder="ç¡®è®¤æ–°å¯†ç " />
            </div>
            <div v-if="passwordError" class="form-error">{{ passwordError }}</div>
            <div v-if="passwordSuccess" class="form-success">{{ passwordSuccess }}</div>
            <button class="btn btn-primary" @click="changePassword" style="width: 100%;">
              <i class="fas fa-key"></i> ä¿®æ”¹å¯†ç 
            </button>
          </div>

          <!-- æ•°æ®å¯¼å…¥å¯¼å‡º -->
          <div class="settings-section">
            <div class="settings-section-title">æ•°æ®å¤‡ä»½ä¸æ¢å¤</div>
            <div style="display: flex; gap: 8px; margin-bottom: 8px;">
              <button class="btn btn-success" @click="exportAllData" style="flex: 1;">
                <i class="fas fa-upload"></i> å¯¼å‡ºæ•°æ®
              </button>
              <button class="btn btn-warning" @click="importAllData" style="flex: 1;">
                <i class="fas fa-download"></i> å¯¼å…¥æ•°æ®
              </button>
            </div>
            <div class="form-help">å¯¼å‡ºåŒ…å«æ‰€æœ‰æ¨¡å—çš„é…ç½®å’Œæ•°æ®</div>
          </div>

          <!-- è‡ªå®šä¹‰ CSS -->
          <div class="settings-section">
            <div class="settings-section-title">è‡ªå®šä¹‰ CSS</div>
            <div class="form-help" style="margin-bottom: 8px;">
              å¯ä»¥è‡ªå®šä¹‰å­—ä½“ã€é¢œè‰²ç­‰æ ·å¼ã€‚ä¾‹å¦‚ï¼š
              <code style="display: block; margin-top: 4px;">body { font-family: 'Microsoft YaHei', sans-serif; }</code>
            </div>
            <textarea v-model="customCss" class="form-textarea" placeholder="è¾“å…¥è‡ªå®šä¹‰ CSS ä»£ç ..."
              style="min-height: 150px; font-family: 'Consolas', 'Monaco', monospace; font-size: 12px;"></textarea>
            <div v-if="customCssError" class="form-error" style="margin-top: 8px;">{{ customCssError }}</div>
            <div v-if="customCssSuccess" class="form-success" style="margin-top: 8px;">{{ customCssSuccess }}</div>
            <div style="display: flex; gap: 8px; margin-top: 8px;">
              <button class="btn btn-primary" @click="saveCustomCss" style="flex: 1;">
                <i class="fas fa-save"></i> åº”ç”¨ CSS
              </button>
              <button class="btn btn-secondary" @click="resetCustomCss" style="flex: 1;">
                <i class="fas fa-undo"></i> é‡ç½®
              </button>
            </div>
          </div>

          <!-- ä¿å­˜æŒ‰é’® -->
          <div
            style="bottom: 0; background: var(--card-bg); padding-top: 16px; border-top: 1px solid var(--border-color); margin-top: 20px;">
            <button class="btn btn-primary" @click="saveSettings" style="width: 100%;">
              <i class="fas fa-save"></i> ä¿å­˜è®¾ç½®
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- æ—¥å¿—æ¨¡æ€æ¡† -->
    <div v-if="showLogsModal" class="modal-overlay" :class="{ 'logs-fullscreen-overlay': logsFullscreen }"
      @keydown.esc="showLogsModal = false" tabindex="-1">
      <div class="modal logs-modal" :class="{ 'logs-modal-fullscreen': logsFullscreen }">
        <div class="logs-header">
          <div class="logs-title">ğŸ“‹ {{ logsModalTitle }}</div>
          <div class="logs-controls">
            <button class="btn btn-secondary" @click="toggleRealTimeRefresh"
              style="margin-right: 8px; padding: 6px 10px; font-size: 12px;">
              <i class="fas" :class="logsRealTime ? 'fa-stop' : 'fa-play'"></i>
              {{ logsRealTime ? 'åœæ­¢å®æ—¶' : 'å®æ—¶åˆ·æ–°' }}
            </button>
            <button class="btn btn-secondary" @click="toggleAutoScroll"
              style="margin-right: 8px; padding: 6px 10px; font-size: 12px;">
              <i class="fas" :class="logsAutoScroll ? 'fa-pause' : 'fa-play'"></i>
              {{ logsAutoScroll ? 'åœæ­¢æ»šåŠ¨' : 'è‡ªåŠ¨æ»šåŠ¨' }}
            </button>
            <button class="btn btn-secondary" @click="toggleFullscreen"
              style="margin-right: 8px; padding: 6px 10px; font-size: 12px;">
              <i class="fas" :class="logsFullscreen ? 'fa-compress' : 'fa-expand'"></i>
              {{ logsFullscreen ? 'é€€å‡ºå…¨å±' : 'å…¨å±' }}
            </button>
            <button class="btn btn-danger" @click="showLogsModal = false" style="padding: 6px 10px; font-size: 12px;">
              <i class="fas fa-times"></i>
              å…³é—­
            </button>
          </div>
        </div>
        <div class="logs-info">
          <span>é¡¹ç›®: {{ logsModalInfo.project }}</span>
          <span>è´¦å·: {{ logsModalInfo.account }}</span>
          <span>æ—¥å¿—: {{ logsModalInfo.count }} æ¡</span>
          <span>æ—¶é—´: {{ logsModalInfo.time }}</span>
        </div>
        <div class="logs-content" ref="logsContent" @wheel.stop @touchmove.stop>
          <div v-if="logsLoading" style="text-align: center; padding: 40px;">â³ æ­£åœ¨åŠ è½½æ—¥å¿—...</div>
          <div v-else class="logs-text-container" ref="logsTextContainer">
            <pre class="logs-text" ref="logsText">{{ logsContent || 'æš‚æ— æ—¥å¿—' }}</pre>
            <div class="logs-horizontal-scrollbar" ref="logsScrollbar">
              <div class="logs-scrollbar-thumb" ref="logsScrollbarThumb"></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Toast æç¤ºå®¹å™¨ -->
    <div v-if="globalToast.show" class="custom-toast" :class="globalToast.type">
      <i class="fas" :class="{
        'fa-check-circle': globalToast.type === 'success',
        'fa-exclamation-circle': globalToast.type === 'error',
        'fa-exclamation-triangle': globalToast.type === 'warning',
        'fa-info-circle': globalToast.type === 'info'
      }"></i>
      <span>{{ globalToast.message }}</span>
    </div>

    <!-- DNS Toast -->
    <div v-if="dnsToast.show" class="custom-toast" :class="dnsToast.type">
      <i class="fas" :class="{
        'fa-check-circle': dnsToast.type === 'success',
        'fa-exclamation-circle': dnsToast.type === 'error',
        'fa-exclamation-triangle': dnsToast.type === 'warning',
        'fa-info-circle': dnsToast.type === 'info'
      }"></i>
      <span>{{ dnsToast.message }}</span>
    </div>

    <!-- OpenAI Toast -->
    <div v-if="openaiToast.show" class="custom-toast" :class="openaiToast.type">
      <i class="fas" :class="{
        'fa-check-circle': openaiToast.type === 'success',
        'fa-exclamation-circle': openaiToast.type === 'error',
        'fa-exclamation-triangle': openaiToast.type === 'warning',
        'fa-info-circle': openaiToast.type === 'info'
      }"></i>
      <span>{{ openaiToast.message }}</span>
    </div>

    <!-- è‡ªå®šä¹‰ç¡®è®¤å¯¹è¯æ¡† -->
    <div v-if="customDialog.show" class="custom-dialog-overlay"
      @keydown.esc="customDialog.onCancel ? customDialog.onCancel() : (customDialog.show = false)"
      @keydown.enter="customDialog.onConfirm"
      tabindex="-1">
      <div class="custom-dialog">
        <div class="custom-dialog-title">
          <i class="fas" :class="customDialog.icon || 'fa-question-circle'"></i>
          {{ customDialog.title || 'ç¡®è®¤' }}
        </div>
        <div class="custom-dialog-message">{{ customDialog.message }}</div>
        <input v-if="customDialog.isPrompt" v-model="customDialog.promptValue"
          :placeholder="customDialog.placeholder"
          @keyup.enter="customDialog.onConfirm"
          class="custom-dialog-input"
          ref="promptInput" />
        <div class="custom-dialog-buttons">
          <button v-if="customDialog.cancelText" class="btn btn-secondary"
            @click="customDialog.onCancel ? customDialog.onCancel() : (customDialog.show = false)">
            {{ customDialog.cancelText }}
          </button>
          <button class="btn" :class="customDialog.confirmClass || 'btn-primary'" @click="customDialog.onConfirm">
            {{ customDialog.confirmText || 'ç¡®å®š' }}
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- æ¨¡å—åŒ– JavaScript -->
  <script type="module" src="/js/main.js"></script>

</body>

</body>

</html>