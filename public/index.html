<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>API Monitor</title>
  <link rel="icon" type="image/png" href="/logo.png">
  <link rel="shortcut icon" href="/logo.png">
  <link rel="icon" href="/logo.png" sizes="32x32">
  <meta name="msapplication-TileImage" content="/logo.png">
  <script src="https://cdn.jsdelivr.net/npm/vue@3/dist/vue.global.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <!-- xterm.js - SSH Terminal -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/xterm@5.3.0/css/xterm.min.css">
  <script src="https://cdn.jsdelivr.net/npm/xterm@5.3.0/lib/xterm.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/xterm-addon-fit@0.8.0/lib/xterm-addon-fit.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/xterm-addon-web-links@0.9.0/lib/xterm-addon-web-links.min.js"></script>

  <!-- Custom Styles - Modularized CSS -->
  <link rel="stylesheet" href="/css/styles.css">
  <link rel="stylesheet" href="/css/projects.css">
  <link rel="stylesheet" href="/css/modals.css">
  <link rel="stylesheet" href="/css/dns.css">
  <link rel="stylesheet" href="/css/tables.css">
  <link rel="stylesheet" href="/css/tabs.css">
  <link rel="stylesheet" href="/css/settings.css">
  <link rel="stylesheet" href="/css/logs.css">
  <link rel="stylesheet" href="/css/transitions.css">
  <link rel="stylesheet" href="/css/server.css">
  <link rel="stylesheet" href="/css/antigravity.css">
</head>

<body>
  <!-- è‡ªå®šä¹‰ CSS -->
  <style id="custom-css"></style>
  <style>
    [v-cloak] {
      display: none !important;
    }
  </style>

  <div id="app" v-cloak :class="{ 'app-has-fullscreen-ssh': hasFullscreenSSH }">
    <!-- è®¤è¯æ£€æŸ¥åŠ è½½çŠ¶æ€ -->
    <div v-if="isCheckingAuth" class="auth-loading">
      <div class="auth-loading-content">
        <div class="spinner"></div>
        <div style="margin-top: 16px; color: var(--text-secondary);">æ­£åœ¨åŠ è½½...</div>
      </div>
    </div>

    <!-- é¦–æ¬¡è®¾ç½®å¯†ç ç•Œé¢ -->
    <div v-if="!isCheckingAuth && showSetPasswordModal" class="modal-overlay">
      <div class="modal">
        <div class="modal-header">
          <div class="modal-title">ğŸ‰ æ¬¢è¿ä½¿ç”¨</div>
        </div>
        <p style="text-align: center; color: var(--text-secondary); margin-bottom: 24px;">è¯·è®¾ç½®ç®¡ç†å‘˜å¯†ç </p>
        <div class="form-group">
          <input v-model="setPassword" type="password" class="form-input" placeholder="è¯·è¾“å…¥å¯†ç ï¼ˆè‡³å°‘6ä½ï¼‰"
            @keyup.enter="setAdminPassword" />
        </div>
        <div class="form-group">
          <input v-model="setPasswordConfirm" type="password" class="form-input" placeholder="è¯·å†æ¬¡è¾“å…¥å¯†ç "
            @keyup.enter="setAdminPassword" />
        </div>
        <div v-if="setPasswordError" class="form-error">
          {{ setPasswordError }}
        </div>
        <button @click="setAdminPassword" class="btn btn-primary" style="width: 100%;">
          è®¾ç½®å¯†ç 
        </button>
      </div>
    </div>

    <!-- ç™»å½•ç•Œé¢ -->
    <div v-if="!isCheckingAuth && showLoginModal" class="modal-overlay">
      <div class="modal">
        <div class="modal-header">
          <div class="modal-title">ğŸ” ç®¡ç†å‘˜ç™»å½•</div>
        </div>
        <div class="form-group">
          <input v-model="loginPassword" type="password" class="form-input" placeholder="è¯·è¾“å…¥ç®¡ç†å‘˜å¯†ç "
            @keyup.enter="verifyPassword" />
        </div>
        <div v-if="loginError" class="form-error">
          {{ loginError }}
        </div>
        <button @click="verifyPassword" class="btn btn-primary" style="width: 100%;">
          ç™»å½•
        </button>
      </div>
    </div>

    <div v-if="isAuthenticated" class="container">
      <!-- é¡µé¢å¤´éƒ¨ - æ¨¡å—æ§åˆ¶å’Œè®¾ç½® -->
      <div class="header">
        <div class="title">
          <i class="fas fa-chart-line"></i>
          API Monitor
        </div>
        <div style="display: flex; gap: 10px; align-items: center;">
          <!-- è®¾ç½®æŒ‰é’® -->
          <button class="btn btn-secondary icon-only" @click="showSettingsModal = true" title="ç³»ç»Ÿè®¾ç½®">
            <i class="fas fa-cog"></i>
          </button>
        </div>
      </div>

      <!-- ä¸»æ ‡ç­¾é¡µå¯¼èˆª -->
      <div class="main-tabs">
        <template v-for="module in moduleOrder" :key="module">
          <button v-if="moduleVisibility[module]" class="main-tab" :class="[
              { active: mainActiveTab === module },
              module === 'zeabur' ? 'zeabur-tab' : '',
              module === 'dns' ? 'dns-tab' : '',
              module === 'openai' ? 'openai-tab' : '',
              module === 'server' ? 'server-tab' : '',
              module === 'antigravity' ? 'antigravity-tab' : ''
            ]" @click="handleTabSwitch(module)">
            <i class="fas" :class="getModuleIcon(module)"></i>
            <span> {{ getModuleName(module) }}</span>
          </button>
        </template>
      </div>

      <!-- ==================== Zeabur ç›‘æ§éƒ¨åˆ† ==================== -->
      <div v-if="mainActiveTab === 'zeabur'" class="tab-content zeabur-tab-content"
        :class="getTabAnimationClass('zeabur')">
        <!-- Zeabur å­æ ‡ç­¾é¡µ -->
        <div class="sec-tabs">
          <button class="tab-btn" :class="{ active: zeaburCurrentTab === 'monitor' }"
            @click="zeaburCurrentTab = 'monitor'" style="background: var(--primary-color) !important;"
            v-if="zeaburCurrentTab === 'monitor'">
            <i class="fas fa-chart-line"></i> æœåŠ¡ç›‘æ§
          </button>
          <button class="tab-btn" :class="{ active: zeaburCurrentTab === 'monitor' }"
            @click="zeaburCurrentTab = 'monitor'" v-else>
            <i class="fas fa-chart-line"></i> æœåŠ¡ç›‘æ§
          </button>
          <button class="tab-btn" :class="{ active: zeaburCurrentTab === 'accounts' }"
            @click="zeaburCurrentTab = 'accounts'" style="background: var(--primary-color) !important;"
            v-if="zeaburCurrentTab === 'accounts'">
            <i class="fas fa-users"></i> è´¦å·ç®¡ç†
          </button>
          <button class="tab-btn" :class="{ active: zeaburCurrentTab === 'accounts' }"
            @click="zeaburCurrentTab = 'accounts'" v-else>
            <i class="fas fa-users"></i> è´¦å·ç®¡ç†
          </button>
          <button class="tab-btn" :class="{ active: zeaburCurrentTab === 'settings' }"
            @click="zeaburCurrentTab = 'settings'" style="background: var(--primary-color) !important;"
            v-if="zeaburCurrentTab === 'settings'">
            <i class="fas fa-cog"></i> æ¨¡å—é…ç½®
          </button>
          <button class="tab-btn" :class="{ active: zeaburCurrentTab === 'settings' }"
            @click="zeaburCurrentTab = 'settings'" v-else>
            <i class="fas fa-cog"></i> æ¨¡å—é…ç½®
          </button>
        </div>

        <!-- æœåŠ¡ç›‘æ§æ ‡ç­¾é¡µ -->
        <div v-if="zeaburCurrentTab === 'monitor'" class="sub-tab-content quick-fade-in">
          <div class="info-card">
            <div class="info-card-title">ğŸ’¡ ä½¿ç”¨è¯´æ˜</div>
            <div class="info-card-content">
              æ•°æ®æ¯30ç§’è‡ªåŠ¨åˆ·æ–°
            </div>
          </div>

          <div class="controls" style="justify-content: space-between;">
            <div style="display: flex; gap: 10px; align-items: center;">
              <button class="btn btn-primary" @click="fetchData" :disabled="loading">
                <i class="fas fa-sync-alt"></i>
                {{ loading ? 'æ•°æ®æ›´æ–°' : 'åˆ·æ–°æ•°æ®' }}
              </button>
              <button class="btn btn-secondary" @click="toggleDataRefresh"
                :class="dataRefreshPaused ? 'btn-success' : 'btn-warning'">
                <i class="fas" :class="dataRefreshPaused ? 'fa-play' : 'fa-pause'"></i>
                {{ dataRefreshPaused ? 'ç»§ç»­æ›´æ–°' : 'æš‚åœæ›´æ–°' }}
              </button>
              <button class="btn btn-danger" @click="clearCache">
                <i class="fas fa-trash"></i>
                æ¸…é™¤ç¼“å­˜
              </button>
            </div>
            <div class="refresh-info">
              <div class="last-update">{{ refreshCountdown }} ç§’ååˆ·æ–°</div>
              <div class="refresh-progress">
                <div class="refresh-progress-bar" :style="{ width: refreshProgress + '%' }"></div>
              </div>
            </div>
          </div>

          <div v-if="accounts.length > 0" class="stats-grid">
            <div class="stat-card">
              <div class="stat-label">è´¦å·æ•°</div>
              <div class="stat-value">{{ accounts.length }}</div>
            </div>
            <div class="stat-card">
              <div class="stat-label">é¡¹ç›®æ€»æ•°</div>
              <div class="stat-value">{{ totalProjects }}</div>
            </div>
            <div class="stat-card">
              <div class="stat-label">æœåŠ¡æ€»æ•°</div>
              <div class="stat-value">{{ totalServices }}</div>
            </div>
            <div class="stat-card">
              <div class="stat-label">è¿è¡Œä¸­</div>
              <div class="stat-value">{{ runningServices }}</div>
            </div>
            <div class="stat-card">
              <div class="stat-label">æ€»è´¹ç”¨</div>
              <div class="stat-value">${{ totalCost.toFixed(2) }}</div>
            </div>
          </div>

          <div v-if="loading && accounts.length === 0" class="loading">
            âš¡ æ­£åœ¨åŠ è½½æ•°æ®...
          </div>

          <div v-for="account in accounts" :key="account.name" class="account-card">
            <div class="account-header" @click="toggleAccount(account.name)">
              <div class="account-info">
                <span style="font-size: 20px; transition: transform 0.3s; display: inline-flex; align-items: center;"
                  :style="{ 
          /* ä¿æŒ span ä½œä¸ºä¸€ä¸ªå®¹å™¨ï¼Œä¸æ—‹è½¬æˆ–æ—‹è½¬åˆ°ç‰¹å®šè§’åº¦ */
          transform: isAccountExpanded(account.name) ? 'rotate(0deg)' : 'rotate(0deg)' 
      }">

                  <i class="fas fa-chevron-right toggle-icon" :style="{ 
           transition: 'transform 0.4s cubic-bezier(0.4, 0, 0.2, 1)', 
           // é€»è¾‘è°ƒæ•´ï¼š
           // å±•å¼€ (true) -> 0deg (å‘ä¸‹)
           // æ”¶èµ· (false) -> 90deg (å‘å³)
           transform: isAccountExpanded(account.name) ? 'rotate(90deg)' : 'rotate(0deg)' 
       }">
                  </i>
                </span>
                <div>
                  <div class="account-name" v-if="!account.isEditingName"
                    @dblclick.stop="startEditAccountName(account)">
                    {{ account.name }}
                  </div>
                  <div v-else class="account-name-edit" @click.stop>
                    <input v-model="account.editingName" @keyup.enter="saveAccountName(account)"
                      @keyup.esc="cancelEditAccountName(account)" @blur="saveAccountName(account)" class="edit-input"
                      ref="accountNameInput" style="width: 150px;" />
                    <button @click.stop="cancelEditAccountName(account)" class="cancel-btn" title="å–æ¶ˆ"
                      style="margin-left: 4px;">
                      âœ–ï¸
                    </button>
                  </div>
                  <div v-if="account.data" class="account-email">
                    {{ maskEmail(account.data.email) || account.data.username }}
                  </div>
                </div>
              </div>
              <div class="account-balance">
                <div style="display: flex; flex-direction: column; gap: 3px;">
                  <div class="balance-card credit-balance-card">
                    <div class="balance-icon">ğŸ’°</div>
                    <div class="balance-amount"
                      :class="account.data?.credit ? getBalanceClass(account.data.credit) : ''">
                      <span v-if="account.data?.credit">${{ (account.data.credit / 100).toFixed(2) }}</span>
                      <span v-else>-</span>
                    </div>
                  </div>
                  <div class="balance-card ai-balance-card">
                    <div class="balance-icon">ğŸ¤–</div>
                    <div class="balance-amount">
                      {{ account.aihub && account.aihub.balance ? '$' + (account.aihub.balance / 100000).toFixed(2) :
                      'æ— '
                      }}
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div v-if="account.error" class="error">
              âŒ é”™è¯¯: {{ account.error }}
            </div>

            <div v-if="account.projects" class="projects-grid"
              :class="{ 'collapsed': !isAccountExpanded(account.name) }">
              <div v-for="project in account.projects" :key="project._id" :id="'proj-' + project._id"
                class="project-card">
                <div class="project-header">
                  <div class="project-name-wrapper">
                    <span class="project-name-icon">ğŸ“¦</span>
                    <span v-if="!project.isEditing" class="project-name-text">{{ project.name }}</span>
                    <input v-else v-model="project.editingName" @keyup.enter="saveProjectName(account, project)"
                      @keyup.esc="cancelEditProjectName(project)" @blur="saveProjectName(account, project)"
                      class="project-name-input" ref="projectNameInput" />
                  </div>
                  <div class="project-actions">
                    <button v-if="!project.isEditing" @click="deleteProject(account, project)"
                      class="project-delete-btn" title="åˆ é™¤é¡¹ç›®">
                      <i class="fas fa-trash"></i>
                    </button>
                    <button v-if="!project.isEditing" @click="startEditProjectName(project)" class="project-edit-btn"
                      title="é‡å‘½åé¡¹ç›®">
                      <i class="fas fa-pen"></i>
                    </button>
                    <button v-if="project.isEditing" @click="cancelEditProjectName(project)" class="project-cancel-btn"
                      title="å–æ¶ˆ">
                      <i class="fas fa-times"></i>
                    </button>
                  </div>
                </div>
                <div class="project-mini-cards">
                  <div class="mini-card region-card">
                    <span class="mini-card-icon">åœ°åŒºğŸ“</span>
                    <span class="mini-card-value">{{ formatRegion(project.region) }}</span>
                  </div>
                  <div class="mini-card cost-card">
                    <span class="mini-card-icon">å·²ç”¨ğŸ’°</span>
                    <span class="mini-card-value">${{ formatCost(project.cost) }}</span>
                  </div>
                </div>
                <div class="services-container">
                  <div v-for="service in project.services" :key="service._id" :id="'service-' + service._id"
                    :class="['service-item', service.status.toLowerCase()]">
                    <div class="service-header">
                      <div class="service-name-container">
                        <span v-if="!service.isEditing" class="service-name" :title="service.name">
                          {{ service.name }}
                        </span>
                        <input v-else v-model="service.editingName"
                          @keyup.enter="saveServiceName(account, project, service)"
                          @keyup.esc="cancelEditServiceName(service)" @blur="saveServiceName(account, project, service)"
                          class="service-name-input" />
                        <button v-if="!service.isEditing" @click="startEditServiceName(service)"
                          class="service-edit-btn" title="é‡å‘½åæœåŠ¡">
                          <i class="fas fa-pen"></i>
                        </button>
                        <button v-else @click="cancelEditServiceName(service)" class="service-cancel-btn" title="å–æ¶ˆ">
                          <i class="fas fa-times"></i>
                        </button>
                      </div>
                      <div :class="['service-status', service.status.toLowerCase()]">
                        {{ service.status === 'RUNNING' ? 'è¿è¡Œä¸­' : service.status === 'SUSPENDED' ? 'å·²æš‚åœ' :
                        service.status
                        }}
                      </div>
                    </div>
                    <div v-if="service.resourceLimit" class="service-info">
                      <span style="display: inline-flex; align-items: center; gap: 4px; margin-right: 12px;">
                        <i class="fas fa-microchip"></i>
                        {{ service.resourceLimit.cpu }}m
                      </span>
                      <span style="display: inline-flex; align-items: center; gap: 4px;">
                        <i class="fas fa-memory"></i>
                        {{ service.resourceLimit.memory }}MB
                      </span>
                    </div>
                    <div class="service-actions">
                      <button v-if="service.status === 'RUNNING'" @click="pauseService(account, project, service)"
                        class="service-btn btn-pause">
                        <i class="fas fa-pause"></i>
                        æš‚åœ
                      </button>
                      <button @click="restartService(account, project, service)" class="service-btn btn-restart">
                        <i class="fas fa-redo"></i>
                        {{ service.status === 'SUSPENDED' ? 'å¯åŠ¨' : 'é‡å¯' }}
                      </button>
                      <button @click="showServiceLogs(account, project, service)" class="service-btn btn-logs">
                        <i class="fas fa-file-alt"></i>
                        æ—¥å¿—
                      </button>
                      <button @click="deleteService(account, project, service)" class="service-btn btn-delete">
                        <i class="fas fa-trash"></i>
                        åˆ é™¤
                      </button>
                    </div>
                  </div>
                  <div v-if="project.services.length === 0" class="empty-state">
                    æš‚æ— æœåŠ¡
                  </div>
                </div>

                <!-- é¡¹ç›®åŸŸå -->
                <div v-if="getProjectDomains(project).length > 0" class="domains-container">
                  <a v-for="domainInfo in getProjectDomains(project)" :key="domainInfo.domain"
                    :href="'https://' + domainInfo.domain" target="_blank" class="domain-link">
                    <i class="fas fa-globe"></i>
                    <span>{{ domainInfo.domain }}</span>
                    <span v-if="domainInfo.isGenerated" class="domain-badge">è‡ªåŠ¨</span>
                  </a>
                </div>
              </div>
            </div>
          </div>

          <div v-if="!loading && accounts.length === 0" class="error">
            æœªé…ç½®è´¦å·æˆ–æ— æ³•è·å–æ•°æ®ã€‚è¯·æ£€æŸ¥ .env é…ç½®æ–‡ä»¶ã€‚
          </div>
        </div>
        <!-- æœåŠ¡ç›‘æ§æ ‡ç­¾é¡µç»“æŸ -->

        <!-- è´¦å·ç®¡ç†æ ‡ç­¾é¡µ -->
        <div v-if="zeaburCurrentTab === 'accounts'" class="sub-tab-content quick-fade-in">
          <div class="panel">
            <div class="panel-header">
              <div class="panel-title"></div>
              <div style="display: flex; gap: 8px;">
                <button class="btn btn-success" style="padding: 6px 12px;" @click="showAddZeaburAccountModal = true">
                  <i class="fas fa-plus"></i> æ·»åŠ è´¦å·
                </button>
                <button class="btn btn-secondary" @click="exportAllAccounts" style="padding: 6px 12px;">
                  <i class="fas fa-upload"></i> å¯¼å‡º
                </button>
                <button class="btn btn-secondary" @click="importAllAccounts" style="padding: 6px 12px;">
                  <i class="fas fa-download"></i> å¯¼å…¥
                </button>
              </div>
            </div>

            <div class="table-container">
              <table class="data-table">
                <thead>
                  <tr>
                    <th>åç§°</th>
                    <th>é‚®ç®±</th>
                    <th>ä½™é¢</th>
                    <th>çŠ¶æ€</th>
                    <th style="width: 150px;">æ“ä½œ</th>
                  </tr>
                </thead>
                <tbody>
                  <tr v-for="(account, index) in managedAccounts" :key="'local-' + index">
                    <td>{{ account.name }}</td>
                    <td>{{ account.email || '-' }}</td>
                    <td>
                      <span v-if="account.balance !== null && account.balance !== undefined">
                        ${{ account.balance.toFixed(2) }}
                      </span>
                      <span v-else>-</span>
                    </td>
                    <td>
                      <span class="proxied-badge" :class="account.status === 'active' ? 'proxied-on' : 'proxied-off'">
                        {{ account.status === 'active' ? 'æ­£å¸¸' : 'æœªçŸ¥' }}
                      </span>
                    </td>
                    <td class="actions">
                      <button class="btn btn-danger" style="padding: 4px 8px; font-size: 12px;"
                        @click="removeAccount(index)" title="åˆ é™¤">
                        <i class="fas fa-trash"></i>
                      </button>
                    </td>
                  </tr>
                  <!-- æ˜¾ç¤ºä¸»æœºé…ç½®çš„è´¦å·ï¼ˆåªè¯»ï¼‰ -->
                  <tr v-if="managedAccounts.length === 0 && accounts.length > 0" v-for="account in accounts"
                    :key="'server-' + account.name">
                    <td>{{ account.name }}</td>
                    <td>{{ account.data?.email || '-' }}</td>
                    <td>
                      <span v-if="account.data?.credit">
                        ${{ (account.data.credit / 100).toFixed(2) }}
                      </span>
                      <span v-else>-</span>
                    </td>
                    <td>
                      <span class="proxied-badge proxied-off">
                        ä¸»æœºé…ç½®
                      </span>
                    </td>
                    <td class="actions">
                      <span style="font-size: 12px; color: var(--text-tertiary);">
                        ğŸ”’ åªè¯»
                      </span>
                    </td>
                  </tr>
                </tbody>
              </table>
              <div v-if="managedAccounts.length === 0 && accounts.length === 0" class="empty-state">
                <i class="fas fa-user-plus" style="font-size: 48px; margin-bottom: 16px;"></i>
                <div>æš‚æ— è´¦å·ï¼Œç‚¹å‡»ä¸Šæ–¹æŒ‰é’®æ·»åŠ </div>
              </div>
            </div>
          </div>

          <!-- æ‰¹é‡æ·»åŠ  -->
          <div class="panel" style="margin-top: 16px;">
            <div class="panel-header">
              <div class="panel-title">æ‰¹é‡æ·»åŠ è´¦å·</div>
            </div>
            <div>
              <p style="color: var(--text-secondary); font-size: 13px; margin-bottom: 12px;">
                æ¯è¡Œä¸€ä¸ªè´¦å·ï¼Œæ ¼å¼ï¼š<code>åç§°:Token</code> æˆ– <code>åç§°ï¼šToken</code> æˆ– <code>åç§°(Token)</code> æˆ–
                <code>åç§°ï¼ˆTokenï¼‰</code>
              </p>
              <div style="position: relative; min-height: 150px;">
                <div
                  style="width: 100%; min-height: 150px; padding: 12px; border: 1px solid var(--border-color); border-radius: 8px; font-size: 13px; font-family: monospace; white-space: pre-wrap; word-break: break-all; pointer-events: none; color: var(--text-primary); line-height: 1.5; background-color: var(--input-bg);">
                  {{ maskedBatchAccounts }}</div>
                <textarea v-model="batchAccounts" @input="updateBatchDisplay" placeholder="æ¯è¡Œä¸€ä¸ªè´¦å·ï¼Œæ ¼å¼ï¼šè´¦å·åç§°:API_Token"
                  class="form-textarea"
                  style="position: absolute; top: 0; left: 0; color: transparent; caret-color: var(--text-primary); background: transparent; line-height: 1.5; min-height: 150px;"></textarea>
              </div>
              <div v-if="batchAddError" class="form-error" style="margin-top: 8px;">{{ batchAddError }}</div>
              <div v-if="batchAddSuccess" class="form-success" style="margin-top: 8px;">{{ batchAddSuccess }}</div>
              <button class="btn btn-primary" @click="batchAddAccounts" :disabled="addingAccount"
                style="width: 100%; margin-top: 12px;">
                {{ addingAccount ? 'æ·»åŠ ä¸­...' : 'æ‰¹é‡æ·»åŠ ' }}
              </button>
            </div>
          </div>
        </div>
        <!-- è´¦å·ç®¡ç†æ ‡ç­¾é¡µç»“æŸ -->

        <!-- æ¨¡å—é…ç½®æ ‡ç­¾é¡µ -->
        <div v-if="zeaburCurrentTab === 'settings'" class="sub-tab-content quick-fade-in">
          <div class="panel">
            <div class="panel-header" style="border-bottom: 1px solid var(--border-color);">
               <div class="panel-title">æ¨¡å—è®¾ç½®</div>
               <button class="btn btn-primary btn-sm" @click="saveZeaburSettings">
                 <i class="fas fa-save"></i> ä¿å­˜è®¾ç½®
               </button>
            </div>
            
            <div style="padding: 10px 3px 3px 3px;">
              <div class="form-group">
                <label class="form-label">è‡ªåŠ¨åˆ·æ–°é—´éš” (ç§’)</label>
                <input type="number" :value="zeaburRefreshInterval / 1000" @input="zeaburRefreshInterval = Math.max(5, parseInt($event.target.value)) * 1000" class="form-input" min="5" placeholder="30" />
                <div class="form-help">è®¾ç½® Zeabur ç›‘æ§æ•°æ®çš„è‡ªåŠ¨åˆ·æ–°é¢‘ç‡ï¼ˆæœ€å°‘5ç§’ï¼‰</div>
              </div>
            </div>
          </div>
        </div>

        <!-- æ·»åŠ  Zeabur è´¦å·æ¨¡æ€æ¡† -->
        <div v-if="showAddZeaburAccountModal" class="modal-overlay" @keydown.esc="showAddZeaburAccountModal = false"
          @keydown.enter="addAccountToList" tabindex="-1">
          <div class="modal">
            <div class="modal-header">
              <div class="modal-title"></div>
              <button class="modal-close" @click="showAddZeaburAccountModal = false">&times;</button>
            </div>

            <div class="form-group">
              <label class="form-label">è´¦å·åç§° *</label>
              <input v-model="newAccount.name" class="form-input" placeholder="ä¾‹å¦‚: æˆ‘çš„è´¦å·" />
            </div>

            <div class="form-group">
              <label class="form-label">API Token *</label>
              <input v-model="newAccount.token" type="password" class="form-input" placeholder="sk-xxxxxxxxxxxxxxxx" />
              <div class="form-help">åœ¨ Zeabur æ§åˆ¶å°çš„è®¾ç½®ä¸­åˆ›å»º API Token</div>
            </div>

            <div v-if="addAccountError" class="form-error">{{ addAccountError }}</div>
            <div v-if="addAccountSuccess" class="form-success">{{ addAccountSuccess }}</div>

            <div style="display: flex; gap: 12px; margin-top: 20px;">
              <button class="btn btn-primary" @click="addAccountToList" :disabled="addingAccount" style="flex: 1;">
                {{ addingAccount ? 'éªŒè¯ä¸­...' : 'æ·»åŠ è´¦å·' }}
              </button>
              <button class="btn btn-secondary" @click="showAddZeaburAccountModal = false" style="flex: 1;">å–æ¶ˆ</button>
            </div>
          </div>
        </div>

      </div>
      <!-- ==================== Zeabur ç›‘æ§éƒ¨åˆ†ç»“æŸ ==================== -->

      <!-- ==================== DNS ç®¡ç†éƒ¨åˆ† ==================== -->
      <div v-if="mainActiveTab === 'dns'" class="tab-content dns-tab-content" :class="getTabAnimationClass('dns')">
        <!-- DNS å­æ ‡ç­¾é¡µ -->
        <div class="sec-tabs">
          <button class="tab-btn" :class="{ active: dnsCurrentTab === 'dns' }" @click="dnsCurrentTab = 'dns'">
            <i class="fas fa-globe"></i> DNS è®°å½•
          </button>
          <button class="tab-btn" :class="{ active: dnsCurrentTab === 'accounts' }" @click="dnsCurrentTab = 'accounts'">
            <i class="fas fa-users"></i> è´¦å·ç®¡ç†
          </button>
          <!-- <button class="tab-btn" :class="{ active: dnsCurrentTab === 'templates' }"
            @click="dnsCurrentTab = 'templates'">
            <i class="fas fa-copy"></i> æ¨¡æ¿
          </button> -->
        </div>

        <!-- DNS è®°å½•æ ‡ç­¾é¡µ -->
        <div v-if="dnsCurrentTab === 'dns'" class="sub-tab-content quick-fade-in">
          <!-- è´¦å·é€‰æ‹© - å¡ç‰‡å¼ -->
          <div style="margin-bottom: 16px;">
            <!-- <label style="font-weight: 500; margin-bottom: 12px; display: block;">é€‰æ‹©è´¦å·ï¼š</label> -->
            <div class="zones-grid">
              <div v-for="acc in dnsAccounts" :key="acc.id" class="zone-card"
                :class="{ active: dnsSelectedAccountId === acc.id }" @click="selectDnsAccount(acc)">
                <div style="flex: 1;">
                  <div class="zone-name">
                    <i class="fas fa-user-circle" style="margin-right: 6px; color: var(--cf-color);"></i>
                    {{ acc.name }}
                  </div>
                  <div class="zone-status" style="font-size: 11px;">{{ acc.email || 'è´¦å·' }}</div>
                </div>
                <div style="display: flex; align-items: center; gap: 8px;">
                  <i v-if="dnsSelectedAccountId === acc.id" class="fas fa-check-circle"
                    style="color: var(--cf-color);"></i>
                  <button v-if="dnsSelectedAccountId === acc.id" class="btn btn-secondary"
                    style="padding: 4px 8px; font-size: 12px;" @click.stop="loadDnsZones" :disabled="dnsLoadingZones">
                    <i class="fas fa-sync-alt" :class="{ 'fa-spin': dnsLoadingZones }"></i>
                  </button>
                </div>
              </div>
            </div>
          </div>

          <div v-if="dnsLoadingZones" class="loading">
            <div class="spinner"></div>
            <div style="margin-top: 12px;">åŠ è½½åŸŸååˆ—è¡¨...</div>
          </div>

          <!-- åŸŸåç½‘æ ¼ -->
          <div v-if="dnsSelectedAccountId && dnsZones.length > 0 && !dnsLoadingZones" class="zones-grid">
            <div v-for="zone in dnsZones" :key="zone.id" class="zone-card"
              :class="{ active: dnsSelectedZoneId === zone.id }" @click="selectDnsZone(zone)">
              <div>
                <div class="zone-name">{{ zone.name }}</div>
                <div class="zone-status" :class="zone.status">{{ zone.status }}</div>
              </div>
              <i class="fas fa-chevron-right" style="color: var(--text-tertiary);"></i>
            </div>
          </div>

          <div v-if="dnsSelectedAccountId && dnsZones.length === 0 && !dnsLoadingZones" class="empty-state">
            <i class="fas fa-globe" style="font-size: 48px; margin-bottom: 16px;"></i>
            <div>è¯¥è´¦å·ä¸‹æ²¡æœ‰åŸŸå</div>
          </div>

          <!-- å¿«é€Ÿåˆ‡æ¢ -->
          <div v-if="dnsSelectedZoneId" class="quick-switch">
            <i class="fas fa-bolt" style="color: var(--cf-color);"></i>
            <span style="font-weight: 500; white-space: nowrap;">å¿«é€Ÿåˆ‡æ¢ï¼š</span>
            <select v-model="dnsQuickSwitchType"
              style="color: #f38020; padding: 6px 10px; border-radius: 4px; border: 1px solid var(--input-border); background: var(--input-bg); min-width: 80px;">
              <option value="A">A</option>
              <option value="AAAA">AAAA</option>
              <option value="CNAME">CNAME</option>
            </select>
            <input v-model="dnsQuickSwitchName" placeholder="è®°å½•åç§° (å¦‚ @, www, *)" />
            <input v-model="dnsQuickSwitchContent" placeholder="æ–°çš„å†…å®¹ (IP æˆ–åŸŸå)" />
            <button class="btn btn-cf" style="padding: 6px 12px;" @click="dnsQuickSwitch" :disabled="dnsSwitching">
              {{ dnsSwitching ? 'åˆ‡æ¢ä¸­...' : 'åˆ‡æ¢' }}
            </button>
          </div>

          <!-- DNS è®°å½•è¡¨æ ¼ -->
          <div v-if="dnsSelectedZoneId" class="panel">
            <div class="panel-header">
              <div class="panel-title"></div>
              <div style="display: flex; gap: 8px;">
                <button class="btn btn-success" style="padding: 6px 12px;" @click="openAddDnsRecordModal">
                  <i class="fas fa-plus"></i> æ·»åŠ 
                </button>
                <button v-if="dnsSelectedRecords.length > 0" class="btn btn-danger" style="padding: 6px 12px;"
                  @click="batchDeleteDnsRecords">
                  <i class="fas fa-trash-alt"></i> åˆ é™¤ ({{ dnsSelectedRecords.length }})
                </button>
                <button class="btn btn-secondary" style="padding: 6px 12px;" @click="exportDnsRecords">
                  <i class="fas fa-upload"></i> å¯¼å‡º
                </button>
                <button class="btn btn-secondary" style="padding: 6px 12px;" @click="importDnsRecords">
                  <i class="fas fa-download"></i> å¯¼å…¥
                </button>
                <button class="btn btn-secondary" style="padding: 6px 10px;" @click="loadDnsRecords"
                  :disabled="dnsLoadingRecords">
                  <i class="fas fa-sync-alt" :class="{ 'fa-spin': dnsLoadingRecords }"></i>
                </button>
              </div>
            </div>

            <div v-if="dnsLoadingRecords" class="loading">
              <div class="spinner"></div>
              <div style="margin-top: 12px;">åŠ è½½ä¸­...</div>
            </div>

            <div v-else class="table-container">
              <table class="data-table">
                <thead>
                  <tr>
                    <th style="width: 5%;">
                      <input type="checkbox" @change="toggleSelectAllDnsRecords"
                        :checked="dnsSelectedRecords.length === dnsRecords.length && dnsRecords.length > 0"
                        style="width: 16px; height: 16px; cursor: pointer;">
                    </th>
                    <th style="width: 12%;">ç±»å‹</th>
                    <th style="width: 18%;">åç§°</th>
                    <th style="width: 28%;">å†…å®¹</th>
                    <th style="width: 8%;">ä»£ç†</th>
                    <th style="width: 8%;">TTL</th>
                    <th style="width: 10%;">æ“ä½œ</th>
                  </tr>
                </thead>
                <tbody>
                  <tr v-for="record in dnsRecords" :key="record.id">
                    <td>
                      <input type="checkbox" :value="record.id" v-model="dnsSelectedRecords"
                        style="width: 16px; height: 16px; cursor: pointer;">
                    </td>
                    <td><span class="record-type" :class="record.type">{{ record.type }}</span></td>
                    <td>
                      <div v-if="!record.isEditingName" class="editable-cell"
                        :title="formatDnsRecordName(record.name) + ' (åŒå‡»ç¼–è¾‘)'" @dblclick="startEditDnsName(record)">
                        {{ formatDnsRecordName(record.name) }}
                      </div>
                      <div v-else class="inline-edit-container" @click.stop>
                        <input v-model="record.editingName" class="inline-edit-input" @keyup.enter="saveDnsName(record)"
                          @keyup.esc="cancelEditDnsName(record)" @blur="saveDnsName(record)" ref="dnsNameInput" />
                        <button @click.stop="cancelEditDnsName(record)" class="inline-edit-cancel" title="å–æ¶ˆ">
                          âœ–ï¸
                        </button>
                      </div>
                    </td>
                    <td>
                      <div v-if="!record.isEditingContent" class="content-truncate editable-cell"
                        :title="record.content + ' (åŒå‡»ç¼–è¾‘)'" @dblclick="startEditDnsContent(record)">
                        {{ record.content }}
                      </div>
                      <div v-else class="inline-edit-container" @click.stop>
                        <input v-model="record.editingContent" class="inline-edit-input"
                          @keyup.enter="saveDnsContent(record)" @keyup.esc="cancelEditDnsContent(record)"
                          @blur="saveDnsContent(record)" ref="dnsContentInput" />
                        <button @click.stop="cancelEditDnsContent(record)" class="inline-edit-cancel" title="å–æ¶ˆ">
                          âœ–ï¸
                        </button>
                      </div>
                    </td>
                    <td>
                      <span class="proxied-badge" :class="record.proxied ? 'proxied-on' : 'proxied-off'">
                        {{ record.proxied ? 'å¼€å¯' : 'å…³é—­' }}
                      </span>
                    </td>
                    <td>{{ record.ttl === 1 ? 'Auto' : record.ttl }}</td>
                    <td class="actions">
                      <button class="btn btn-secondary" style="padding: 4px 8px; font-size: 12px;"
                        @click="editDnsRecord(record)" title="ç¼–è¾‘">
                        <i class="fas fa-edit"></i>
                      </button>
                      <button class="btn btn-danger" style="padding: 4px 8px; font-size: 12px;"
                        @click="deleteDnsRecord(record)" title="åˆ é™¤">
                        <i class="fas fa-trash"></i>
                      </button>
                    </td>
                  </tr>
                </tbody>
              </table>
              <div v-if="dnsRecords.length === 0" class="empty-state">æš‚æ—  DNS è®°å½•</div>
            </div>
          </div>
        </div>

        <!-- CF è´¦å·ç®¡ç†æ ‡ç­¾é¡µ -->
        <div v-if="dnsCurrentTab === 'accounts'" class="sub-tab-content quick-fade-in">
          <div class="panel">
            <div class="panel-header">
              <div class="panel-title"></div>
              <div style="display: flex; gap: 8px;">
                <button class="btn btn-success" style="padding: 6px 12px;" @click="openAddDnsAccountModal">
                  <i class="fas fa-plus"></i> æ·»åŠ è´¦å·
                </button>
                <button class="btn btn-secondary" style="padding: 6px 12px;" @click="exportDnsAccounts">
                  <i class="fas fa-upload"></i> å¯¼å‡º
                </button>
                <button class="btn btn-secondary" style="padding: 6px 12px;" @click="importDnsAccounts">
                  <i class="fas fa-download"></i> å¯¼å…¥
                </button>
              </div>
            </div>

            <div class="table-container">
              <table class="data-table">
                <thead>
                  <tr>
                    <th>åç§°</th>
                    <th>é‚®ç®±</th>
                    <th>API Token</th>
                    <th>æ·»åŠ æ—¶é—´</th>
                    <th>æœ€åä½¿ç”¨</th>
                    <th style="width: 150px;">æ“ä½œ</th>
                  </tr>
                </thead>
                <tbody>
                  <tr v-for="acc in dnsAccounts" :key="acc.id">
                    <td>{{ acc.name }}</td>
                    <td>{{ acc.email || '-' }}</td>
                    <td>
                      <div style="display: flex; align-items: center; gap: 8px;">
                        <span v-if="!acc.showToken" style="color: var(--text-secondary);">
                          {{ acc.hasToken ? 'â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢' : '-' }}
                        </span>
                        <span v-else style="font-family: monospace; font-size: 12px; word-break: break-all;">
                          {{ acc.apiToken || '-' }}
                        </span>
                        <button v-if="acc.hasToken" class="btn btn-secondary"
                          style="padding: 2px 6px; font-size: 11px; min-width: auto;"
                          @click="toggleDnsTokenVisibility(acc)" :title="acc.showToken ? 'éšè—' : 'æ˜¾ç¤º'">
                          <i :class="acc.showToken ? 'fas fa-eye-slash' : 'fas fa-eye'"></i>
                        </button>
                      </div>
                    </td>
                    <td>{{ formatDnsDate(acc.createdAt) }}</td>
                    <td>{{ acc.lastUsed ? formatDnsDate(acc.lastUsed) : '-' }}</td>
                    <td class="actions">
                      <button class="btn btn-secondary" style="padding: 4px 8px; font-size: 12px;"
                        @click="verifyDnsAccount(acc)" title="éªŒè¯Token">
                        <i class="fas fa-check"></i>
                      </button>
                      <button class="btn btn-primary" style="padding: 4px 8px; font-size: 12px;"
                        @click="editDnsAccount(acc)" title="ç¼–è¾‘">
                        <i class="fas fa-edit"></i>
                      </button>
                      <button class="btn btn-danger" style="padding: 4px 8px; font-size: 12px;"
                        @click="deleteDnsAccount(acc)" title="åˆ é™¤">
                        <i class="fas fa-trash"></i>
                      </button>
                    </td>
                  </tr>
                </tbody>
              </table>
              <div v-if="dnsAccounts.length === 0" class="empty-state">
                <i class="fas fa-key" style="font-size: 48px; margin-bottom: 16px;"></i>
                <div>æš‚æ— è´¦å·ï¼Œè¯·æ·»åŠ  Cloudflare API Token</div>
              </div>
            </div>
          </div>
        </div>

        <!-- æ¨¡æ¿æ ‡ç­¾é¡µ -->
        <div v-if="dnsCurrentTab === 'templates'">
          <div class="panel">
            <div class="panel-header">
              <div class="panel-title">DNS æ¨¡æ¿</div>
              <button class="btn btn-success" style="padding: 6px 12px;" @click="openAddDnsTemplateModal">
                <i class="fas fa-plus"></i> æ·»åŠ æ¨¡æ¿
              </button>
            </div>

            <div class="table-container">
              <table class="data-table">
                <thead>
                  <tr>
                    <th>åç§°</th>
                    <th style="width: 60px;">ç±»å‹</th>
                    <th>å†…å®¹</th>
                    <th style="width: 70px;">ä»£ç†</th>
                    <th>æè¿°</th>
                    <th style="width: 120px;">æ“ä½œ</th>
                  </tr>
                </thead>
                <tbody>
                  <tr v-for="tpl in dnsTemplates" :key="tpl.id">
                    <td>{{ tpl.name }}</td>
                    <td><span class="record-type" :class="tpl.type">{{ tpl.type }}</span></td>
                    <td>
                      <div class="content-truncate" :title="tpl.content">{{ tpl.content }}</div>
                    </td>
                    <td>
                      <span class="proxied-badge" :class="tpl.proxied ? 'proxied-on' : 'proxied-off'">
                        {{ tpl.proxied ? 'å¼€å¯' : 'å…³é—­' }}
                      </span>
                    </td>
                    <td>{{ tpl.description || '-' }}</td>
                    <td class="actions">
                      <button class="btn btn-secondary" style="padding: 4px 8px; font-size: 12px;"
                        @click="editDnsTemplate(tpl)" title="ç¼–è¾‘">
                        <i class="fas fa-edit"></i>
                      </button>
                      <button class="btn btn-danger" style="padding: 4px 8px; font-size: 12px;"
                        @click="deleteDnsTemplate(tpl)" title="åˆ é™¤">
                        <i class="fas fa-trash"></i>
                      </button>
                    </td>
                  </tr>
                </tbody>
              </table>
              <div v-if="dnsTemplates.length === 0" class="empty-state">
                <i class="fas fa-copy" style="font-size: 48px; margin-bottom: 16px;"></i>
                <div>æš‚æ— æ¨¡æ¿ï¼Œæ·»åŠ å¸¸ç”¨ DNS é…ç½®æ¨¡æ¿ä»¥å¿«é€Ÿåº”ç”¨</div>
              </div>
            </div>
          </div>
        </div>

        <!-- æ·»åŠ  CF è´¦å·æ¨¡æ€æ¡† -->
        <div v-if="showAddDnsAccountModal" class="modal-overlay" @keydown.esc="showAddDnsAccountModal = false"
          @keydown.enter="addDnsAccount" tabindex="-1">
          <div class="modal">
            <div class="modal-header">
              <div class="modal-title">æ·»åŠ  Cloudflare è´¦å·</div>
              <button class="modal-close" @click="showAddDnsAccountModal = false">&times;</button>
            </div>

            <div class="form-group">
              <label class="form-label">è´¦å·åç§° *</label>
              <input v-model="dnsAccountForm.name" class="form-input" placeholder="ä¾‹å¦‚: ä¸»è´¦å·" />
            </div>

            <div class="form-group">
              <label class="form-label">API Token *</label>
              <input v-model="dnsAccountForm.apiToken" type="password" class="form-input"
                placeholder="Cloudflare API Token" />
              <div class="form-help">åœ¨ Cloudflare æ§åˆ¶å° â†’ My Profile â†’ API Tokens åˆ›å»º</div>
            </div>

            <div class="form-group">
              <label class="form-label">é‚®ç®±ï¼ˆå¯é€‰ï¼‰</label>
              <input v-model="dnsAccountForm.email" class="form-input" placeholder="ç”¨äºæ ‡è¯†è´¦å·" />
            </div>

            <div v-if="dnsAccountFormError" class="form-error">{{ dnsAccountFormError }}</div>
            <div v-if="dnsAccountFormSuccess" class="form-success">{{ dnsAccountFormSuccess }}</div>

            <div style="display: flex; gap: 12px; margin-top: 20px;">
              <button class="btn btn-primary" @click="addDnsAccount" :disabled="dnsSavingAccount" style="flex: 1;">
                {{ dnsSavingAccount ? 'éªŒè¯ä¸­...' : 'æ·»åŠ è´¦å·' }}
              </button>
              <button class="btn btn-secondary" @click="showAddDnsAccountModal = false" style="flex: 1;">å–æ¶ˆ</button>
            </div>
          </div>
        </div>

        <!-- ç¼–è¾‘ CF è´¦å·æ¨¡æ€æ¡† -->
        <div v-if="showEditDnsAccountModal" class="modal-overlay" @keydown.esc="showEditDnsAccountModal = false"
          @keydown.enter="updateDnsAccount" tabindex="-1">
          <div class="modal">
            <div class="modal-header">
              <div class="modal-title">ç¼–è¾‘ Cloudflare è´¦å·</div>
              <button class="modal-close" @click="showEditDnsAccountModal = false">&times;</button>
            </div>

            <div class="form-group">
              <label class="form-label">è´¦å·åç§° *</label>
              <input v-model="dnsEditAccountForm.name" class="form-input" placeholder="ä¾‹å¦‚: ä¸»è´¦å·" />
            </div>

            <div class="form-group">
              <label class="form-label">API Token *</label>
              <input v-model="dnsEditAccountForm.apiToken" type="password" class="form-input"
                placeholder="Cloudflare API Token" />
              <div class="form-help">ç•™ç©ºè¡¨ç¤ºä¸ä¿®æ”¹ Token</div>
            </div>

            <div class="form-group">
              <label class="form-label">é‚®ç®±ï¼ˆå¯é€‰ï¼‰</label>
              <input v-model="dnsEditAccountForm.email" class="form-input" placeholder="ç”¨äºæ ‡è¯†è´¦å·" />
            </div>

            <div v-if="dnsEditAccountFormError" class="form-error">{{ dnsEditAccountFormError }}</div>
            <div v-if="dnsEditAccountFormSuccess" class="form-success">{{ dnsEditAccountFormSuccess }}</div>

            <div style="display: flex; gap: 12px; margin-top: 20px;">
              <button class="btn btn-primary" @click="updateDnsAccount" :disabled="dnsSavingAccount" style="flex: 1;">
                {{ dnsSavingAccount ? 'ä¿å­˜ä¸­...' : 'ä¿å­˜ä¿®æ”¹' }}
              </button>
              <button class="btn btn-secondary" @click="showEditDnsAccountModal = false" style="flex: 1;">å–æ¶ˆ</button>
            </div>
          </div>
        </div>

        <!-- æ·»åŠ /ç¼–è¾‘ DNS è®°å½•æ¨¡æ€æ¡† -->
        <div v-if="showDnsRecordModal" class="modal-overlay" @keydown.esc="showDnsRecordModal = false"
          @keydown.enter="saveDnsRecord" tabindex="-1">
          <div class="modal">
            <div class="modal-header">
              <div class="modal-title">{{ dnsEditingRecord ? 'ç¼–è¾‘ DNS è®°å½•' : 'æ·»åŠ  DNS è®°å½•' }}</div>
              <button class="modal-close" @click="showDnsRecordModal = false">&times;</button>
            </div>

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
              <div class="form-group">
                <label class="form-label">ç±»å‹ *</label>
                <select v-model="dnsRecordForm.type" class="form-input" :disabled="!!dnsEditingRecord">
                  <option v-for="t in dnsRecordTypes" :key="t" :value="t">{{ t }}</option>
                </select>
              </div>
              <div class="form-group">
                <label class="form-label">åç§° *</label>
                <input v-model="dnsRecordForm.name" class="form-input" placeholder="@ æˆ– www" />
                <div class="form-help">@ è¡¨ç¤ºæ ¹åŸŸå</div>
              </div>
            </div>

            <div class="form-group">
              <label class="form-label">å†…å®¹ *</label>
              <input v-model="dnsRecordForm.content" class="form-input" placeholder="IP åœ°å€æˆ–ç›®æ ‡åŸŸå" />
            </div>

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
              <div class="form-group">
                <label class="form-label">TTL</label>
                <select v-model="dnsRecordForm.ttl" class="form-input">
                  <option :value="1">Auto</option>
                  <option :value="60">1 åˆ†é’Ÿ</option>
                  <option :value="300">5 åˆ†é’Ÿ</option>
                  <option :value="600">10 åˆ†é’Ÿ</option>
                  <option :value="3600">1 å°æ—¶</option>
                  <option :value="86400">1 å¤©</option>
                </select>
              </div>
              <div class="form-group" v-if="dnsRecordForm.type === 'MX'">
                <label class="form-label">ä¼˜å…ˆçº§</label>
                <input v-model.number="dnsRecordForm.priority" type="number" class="form-input" placeholder="10" />
              </div>
            </div>

            <div class="form-group" v-if="canDnsBeProxied(dnsRecordForm.type)">
              <label style="display: flex; align-items: center; gap: 8px; font-size: 14px; cursor: pointer;">
                <input type="checkbox" v-model="dnsRecordForm.proxied" style="width: 16px; height: 16px;" />
                å¯ç”¨ Cloudflare ä»£ç† (æ©™äº‘)
              </label>
              <div class="form-help">å¯ç”¨åæµé‡å°†é€šè¿‡ Cloudflare CDN</div>
            </div>

            <div v-if="dnsRecordFormError" class="form-error">{{ dnsRecordFormError }}</div>

            <div style="display: flex; gap: 12px; margin-top: 20px;">
              <button class="btn btn-primary" @click="saveDnsRecord" :disabled="dnsSavingRecord" style="flex: 1;">
                {{ dnsSavingRecord ? 'ä¿å­˜ä¸­...' : 'ä¿å­˜' }}
              </button>
              <button class="btn btn-secondary" @click="showDnsRecordModal = false" style="flex: 1;">å–æ¶ˆ</button>
            </div>
          </div>
        </div>

        <!-- æ·»åŠ /ç¼–è¾‘æ¨¡æ¿æ¨¡æ€æ¡† -->
        <div v-if="showDnsTemplateModal" class="modal-overlay" @keydown.esc="showDnsTemplateModal = false"
          @keydown.enter="saveDnsTemplate" tabindex="-1">
          <div class="modal">
            <div class="modal-header">
              <div class="modal-title">{{ dnsEditingTemplate ? 'ç¼–è¾‘æ¨¡æ¿' : 'æ·»åŠ æ¨¡æ¿' }}</div>
              <button class="modal-close" @click="showDnsTemplateModal = false">&times;</button>
            </div>

            <div class="form-group">
              <label class="form-label">æ¨¡æ¿åç§° *</label>
              <input v-model="dnsTemplateForm.name" class="form-input" placeholder="ä¾‹å¦‚: CDN è®°å½•" />
            </div>

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
              <div class="form-group">
                <label class="form-label">è®°å½•ç±»å‹ *</label>
                <select v-model="dnsTemplateForm.type" class="form-input">
                  <option v-for="t in dnsRecordTypes" :key="t" :value="t">{{ t }}</option>
                </select>
              </div>
              <div class="form-group">
                <label class="form-label">TTL</label>
                <select v-model="dnsTemplateForm.ttl" class="form-input">
                  <option :value="1">Auto</option>
                  <option :value="300">5 åˆ†é’Ÿ</option>
                  <option :value="3600">1 å°æ—¶</option>
                </select>
              </div>
            </div>

            <div class="form-group">
              <label class="form-label">å†…å®¹ *</label>
              <input v-model="dnsTemplateForm.content" class="form-input" placeholder="IP åœ°å€æˆ–ç›®æ ‡åŸŸå" />
            </div>

            <div class="form-group">
              <label class="form-label">æè¿°ï¼ˆå¯é€‰ï¼‰</label>
              <input v-model="dnsTemplateForm.description" class="form-input" placeholder="æ¨¡æ¿ç”¨é€”è¯´æ˜" />
            </div>

            <div class="form-group" v-if="canDnsBeProxied(dnsTemplateForm.type)">
              <label style="display: flex; align-items: center; gap: 8px; font-size: 14px; cursor: pointer;">
                <input type="checkbox" v-model="dnsTemplateForm.proxied" style="width: 16px; height: 16px;" />
                å¯ç”¨ Cloudflare ä»£ç†
              </label>
            </div>

            <div v-if="dnsTemplateFormError" class="form-error">{{ dnsTemplateFormError }}</div>

            <div style="display: flex; gap: 12px; margin-top: 20px;">
              <button class="btn btn-primary" @click="saveDnsTemplate" :disabled="dnsSavingTemplate" style="flex: 1;">
                {{ dnsSavingTemplate ? 'ä¿å­˜ä¸­...' : 'ä¿å­˜' }}
              </button>
              <button class="btn btn-secondary" @click="showDnsTemplateModal = false" style="flex: 1;">å–æ¶ˆ</button>
            </div>
          </div>
        </div>

      </div>
      <!-- ==================== DNS ç®¡ç†éƒ¨åˆ†ç»“æŸ ==================== -->

      <!-- ==================== OpenApi ç®¡ç†éƒ¨åˆ† ==================== -->
      <div v-if="mainActiveTab === 'openai'" class="tab-content openai-tab-content"
        :class="getTabAnimationClass('openai')">
        <!-- OpenApi å­æ ‡ç­¾é¡µ -->
        <div class="sec-tabs openai-sec-tabs">
          <button class="tab-btn" :class="{ active: openaiCurrentTab === 'endpoints' }"
            @click="openaiCurrentTab = 'endpoints'">
            <i class="fas fa-server"></i> API ç«¯ç‚¹
          </button>
          <button class="tab-btn" :class="{ active: openaiCurrentTab === 'accounts' }"
            @click="openaiCurrentTab = 'accounts'">
            <i class="fas fa-users"></i> è´¦å·ç®¡ç†
          </button>
        </div>

        <!-- API ç«¯ç‚¹æ ‡ç­¾é¡µ -->
        <div v-if="openaiCurrentTab === 'endpoints'" class="sub-tab-content quick-fade-in">
          <div v-if="openaiLoading" class="loading">
            <div class="spinner"></div>
            <div style="margin-top: 12px;">åŠ è½½ä¸­...</div>
          </div>

          <!-- ç«¯ç‚¹å¡ç‰‡åˆ—è¡¨ -->
          <div v-else>
            <div v-for="endpoint in openaiEndpoints" :key="endpoint.id" class="account-card"
              style="margin-bottom: 12px;">
              <!-- ç«¯ç‚¹å¤´éƒ¨ - å¯ç‚¹å‡»å±•å¼€æ¨¡å‹åˆ—è¡¨ -->
              <div class="account-header" @click="toggleOpenaiModels(endpoint.id)"
                style="cursor: pointer; align-items: center; padding-right: 10px;">
                <div class="account-info" style="flex: 1; align-items: center; padding-right: 0;">
                  <span style="font-size: 20px; display: inline-flex; align-items: center;">
                    <i class="fas fa-chevron-right toggle-icon" :style="{
                        transition: 'transform 0.4s cubic-bezier(0.4, 0, 0.2, 1)',
                        transform: isOpenaiEndpointExpanded(endpoint.id) ? 'rotate(90deg)' : 'rotate(0deg)'
                      }"></i>
                  </span>
                  <div style="flex: 1;">
                    <div style="display: flex; align-items: center; gap: 8px; flex-wrap: wrap; margin-bottom: 4px;">
                      <strong style="font-size: 16px;">{{ endpoint.name || 'æœªå‘½å' }}</strong>
                      <span class="proxied-badge"
                        :class="endpoint.status === 'valid' ? 'proxied-on' : (endpoint.status === 'invalid' ? 'proxied-off' : '')">
                        {{ endpoint.status === 'valid' ? 'æœ‰æ•ˆ' : (endpoint.status === 'invalid' ? 'æ— æ•ˆ' : 'æœªéªŒè¯') }}
                      </span>
                      <span v-if="endpoint.models && endpoint.models.length > 0"
                        style="font-size: 12px; color: var(--text-tertiary);">
                        {{ endpoint.models.length }} ä¸ªæ¨¡å‹
                      </span>
                    </div>
                    <div class="account-email" style="font-size: 12px;">
                      {{ endpoint.baseUrl }}
                    </div>
                  </div>
                </div>
              </div>

              <!-- æ¨¡å‹åˆ—è¡¨ - å¯å±•å¼€/æ”¶èµ· -->
              <div class="openai-models-container" :class="{ 'collapsed': !isOpenaiEndpointExpanded(endpoint.id) }">
                <div v-if="endpoint.models && endpoint.models.length > 0" class="models-grid">
                  <div v-for="model in endpoint.models" :key="getModelName(model)" class="model-tag-item"
                    @click="copyToClipboard(getModelName(model))" :title="'ç‚¹å‡»å¤åˆ¶: ' + getModelName(model)">
                    {{ getModelName(model) }}
                  </div>
                </div>
                <div v-else style="padding: 20px; text-align: center; color: var(--text-tertiary);">
                  <i class="fas fa-cube" style="font-size: 20px; margin-bottom: 8px; display: block;"></i>
                  æš‚æ— æ¨¡å‹æ•°æ®ï¼Œç‚¹å‡»åˆ·æ–°æŒ‰é’®è·å–
                </div>
              </div>
            </div>

            <div v-if="openaiEndpoints.length === 0" class="empty-state" style="padding: 40px;">
              <i class="fas fa-robot" style="font-size: 48px; margin-bottom: 16px;"></i>
              <div>æš‚æ—  API ç«¯ç‚¹ï¼Œç‚¹å‡»ä¸Šæ–¹æŒ‰é’®æ·»åŠ </div>
            </div>
          </div>
          <!-- </div> -->
        </div>

        <!-- è´¦å·ç®¡ç†æ ‡ç­¾é¡µ -->
        <div v-if="openaiCurrentTab === 'accounts'" class="sub-tab-content quick-fade-in">
          <div class="panel">
            <div class="panel-header">
              <div class="panel-title"></div>
              <div style="display: flex; gap: 8px;">
                <button class="btn btn-success" style="padding: 6px 12px;" @click="openAddOpenaiEndpointModal">
                  <i class="fas fa-plus"></i> æ·»åŠ è´¦å·
                </button>
                <button class="btn btn-secondary" style="padding: 6px 10px;" @click="refreshAllOpenaiEndpoints"
                  :disabled="openaiRefreshing">
                  <i class="fas fa-sync-alt" :class="{ 'fa-spin': openaiRefreshing }"></i> åˆ·æ–°å…¨éƒ¨
                </button>
                <button class="btn btn-secondary" @click="exportOpenaiEndpoints" style="padding: 6px 12px;">
                  <i class="fas fa-upload"></i> å¯¼å‡º
                </button>
                <button class="btn btn-secondary" @click="importOpenaiEndpointsFromFile" style="padding: 6px 12px;">
                  <i class="fas fa-download"></i> å¯¼å…¥
                </button>
              </div>
            </div>

            <div v-if="openaiLoading" class="loading">
              <div class="spinner"></div>
              <div style="margin-top: 12px;">åŠ è½½ä¸­...</div>
            </div>

            <div v-else class="table-container">
              <table class="data-table">
                <thead>
                  <tr>
                    <th>åç§°</th>
                    <th>API åœ°å€</th>
                    <th>API Key</th>
                    <th>çŠ¶æ€</th>
                    <th>æ¨¡å‹æ•°é‡</th>
                    <th>æ“ä½œ</th>
                  </tr>
                </thead>
                <tbody>
                  <tr v-for="endpoint in openaiEndpoints" :key="endpoint.id">
                    <td>{{ endpoint.name || 'æœªå‘½å' }}</td>
                    <td>
                      <div style="display: flex; align-items: center; gap: 4px;">
                        <span style="font-family: monospace; font-size: 12px;">{{ endpoint.baseUrl }}</span>
                        <button class="copy-btn" @click.stop="copyToClipboard(endpoint.baseUrl)" title="å¤åˆ¶åœ°å€"
                          style="padding: 2px 4px;">
                          <i class="fas fa-copy"></i>
                        </button>
                        <a :href="endpoint.baseUrl" target="_blank" rel="noopener noreferrer" title="åœ¨æ–°æ ‡ç­¾é¡µæ‰“å¼€"
                          class="copy-btn" style="padding: 2px 4px;">
                          <i class="fas fa-external-link-alt"></i>
                        </a>
                      </div>
                    </td>
                    <td>
                      <div style="display: flex; align-items: center; gap: 4px;">
                        <span style="font-family: monospace; font-size: 12px;">
                          {{ endpoint.showKey ? endpoint.apiKey : maskApiKey(endpoint.apiKey) }}
                        </span>
                        <button class="copy-btn" @click.stop="endpoint.showKey = !endpoint.showKey"
                          :title="endpoint.showKey ? 'éšè—' : 'æ˜¾ç¤º'" style="padding: 2px 4px;">
                          <i class="fas" :class="endpoint.showKey ? 'fa-eye-slash' : 'fa-eye'"></i>
                        </button>
                        <button class="copy-btn" @click.stop="copyToClipboard(endpoint.apiKey)" title="å¤åˆ¶ Key"
                          style="padding: 2px 4px;">
                          <i class="fas fa-copy"></i>
                        </button>
                      </div>
                    </td>
                    <td>
                      <span class="proxied-badge"
                        :class="endpoint.status === 'valid' ? 'proxied-on' : (endpoint.status === 'invalid' ? 'proxied-off' : '')">
                        {{ endpoint.status === 'valid' ? 'æœ‰æ•ˆ' : (endpoint.status === 'invalid' ? 'æ— æ•ˆ' : 'æœªéªŒè¯') }}
                      </span>
                    </td>
                    <td>
                      <span v-if="endpoint.models && endpoint.models.length > 0">
                        {{ endpoint.models.length }} ä¸ª
                      </span>
                      <span v-else style="color: var(--text-tertiary);">-</span>
                    </td>
                    <td class="actions">
                      <button class="btn btn-secondary" style="padding: 4px 8px; font-size: 12px;"
                        @click="verifyOpenaiEndpoint(endpoint)" title="éªŒè¯">
                        <i class="fas fa-sync-alt"></i>
                      </button>
                      <button class="btn btn-primary" style="padding: 4px 8px; font-size: 12px;"
                        @click="editOpenaiEndpoint(endpoint)" title="ç¼–è¾‘">
                        <i class="fas fa-edit"></i>
                      </button>
                      <button class="btn btn-danger" style="padding: 4px 8px; font-size: 12px;"
                        @click="deleteOpenaiEndpoint(endpoint)" title="åˆ é™¤">
                        <i class="fas fa-trash"></i>
                      </button>
                    </td>
                  </tr>
                </tbody>
              </table>
              <div v-if="openaiEndpoints.length === 0" class="empty-state">
                <i class="fas fa-robot" style="font-size: 48px; margin-bottom: 16px;"></i>
                <div>æš‚æ—  API è´¦å·ï¼Œç‚¹å‡»ä¸Šæ–¹æŒ‰é’®æ·»åŠ </div>
              </div>
            </div>
          </div>

          <!-- æ‰¹é‡æ·»åŠ  -->
          <div class="panel" style="margin-top: 16px;">
            <div class="panel-header">
              <div class="panel-title">æ‰¹é‡æ·»åŠ ç«¯ç‚¹</div>
            </div>
            <div>
              <p style="color: var(--text-secondary); font-size: 13px; margin-bottom: 12px;">
                æ¯è¡Œä¸€ä¸ªç«¯ç‚¹ï¼Œæ ¼å¼ï¼š<code>åç§°:APIåœ°å€:API_Key</code> æˆ– JSON æ ¼å¼
              </p>
              <textarea v-model="openaiBatchText" class="form-textarea" placeholder='æ¯è¡Œä¸€ä¸ªï¼Œæ ¼å¼: åç§°:https://api.example.com:sk-xxx
æˆ– JSON æ ¼å¼:
[{"name": "ç¤ºä¾‹", "baseUrl": "https://api.example.com", "apiKey": "sk-xxx"}]'
                style="min-height: 150px; font-family: monospace; font-size: 12px;"></textarea>
              <div v-if="openaiBatchError" class="form-error" style="margin-top: 8px;">{{ openaiBatchError }}</div>
              <div v-if="openaiBatchSuccess" class="form-success" style="margin-top: 8px;">{{ openaiBatchSuccess }}
              </div>
              <button class="btn btn-primary" @click="batchAddOpenaiEndpoints" :disabled="openaiAdding"
                style="width: 100%; margin-top: 12px;">
                {{ openaiAdding ? 'æ·»åŠ ä¸­...' : 'æ‰¹é‡æ·»åŠ ' }}
              </button>
            </div>
          </div>
        </div>

        <!-- æ·»åŠ /ç¼–è¾‘ç«¯ç‚¹æ¨¡æ€æ¡† -->
        <div v-if="showOpenaiEndpointModal" class="modal-overlay" @keydown.esc="showOpenaiEndpointModal = false"
          @keydown.ctrl.enter="saveOpenaiEndpoint" tabindex="-1">
          <div class="modal">
            <div class="modal-header">
              <div class="modal-title">{{ openaiEditingEndpoint ? 'ç¼–è¾‘ API ç«¯ç‚¹' : 'æ·»åŠ  API ç«¯ç‚¹' }}</div>
              <button class="modal-close" @click="showOpenaiEndpointModal = false">&times;</button>
            </div>

            <div class="form-group">
              <label class="form-label">åç§°</label>
              <input v-model="openaiEndpointForm.name" class="form-input" placeholder="ä¾‹å¦‚: OpenAI å®˜æ–¹" />
            </div>

            <div class="form-group">
              <label class="form-label">API åœ°å€ *</label>
              <input v-model="openaiEndpointForm.baseUrl" class="form-input" placeholder="https://api.openai.com" />
              <div class="form-help">OpenAI å…¼å®¹çš„ API åŸºç¡€åœ°å€ï¼ˆä¸éœ€è¦ /v1ï¼‰</div>
            </div>

            <div class="form-group">
              <label class="form-label">API Key *</label>
              <input v-model="openaiEndpointForm.apiKey" type="text" class="form-input" placeholder="sk-xxxxxxxx"
                style="font-family: monospace;" />
            </div>

            <div class="form-group">
              <label class="form-label">å¤‡æ³¨</label>
              <textarea v-model="openaiEndpointForm.notes" class="form-textarea" placeholder="å¯é€‰å¤‡æ³¨ä¿¡æ¯"
                style="min-height: 60px;"></textarea>
            </div>

            <div v-if="openaiEndpointFormError" class="form-error">{{ openaiEndpointFormError }}</div>

            <div style="display: flex; gap: 12px; margin-top: 20px;">
              <button class="btn btn-primary" @click="saveOpenaiEndpoint" :disabled="openaiSaving" style="flex: 1;">
                {{ openaiSaving ? 'ä¿å­˜ä¸­...' : 'ä¿å­˜' }}
              </button>
              <button class="btn btn-secondary" @click="showOpenaiEndpointModal = false" style="flex: 1;">å–æ¶ˆ</button>
            </div>
          </div>
        </div>

      </div>
      <!-- ==================== OpenAI API ç®¡ç†éƒ¨åˆ†ç»“æŸ ==================== -->

      <!-- ==================== ä¸»æœºç®¡ç†éƒ¨åˆ† ==================== -->
      <div v-show="mainActiveTab === 'server'" class="tab-content server-tab-content"
        :class="getTabAnimationClass('server')">
        <!-- ä¸»æœºå­æ ‡ç­¾é¡µ -->
        <div class="sec-tabs server-sec-tabs">
          <button class="tab-btn" :class="{ active: serverCurrentTab === 'list' }" @click="serverCurrentTab = 'list'"
            style="background: var(--server-primary) !important;" v-if="serverCurrentTab === 'list'">
            <i class="fas fa-server"></i> ä¸»æœºåˆ—è¡¨
          </button>
          <button class="tab-btn" :class="{ active: serverCurrentTab === 'list' }" @click="serverCurrentTab = 'list'"
            v-else>
            <i class="fas fa-server"></i> ä¸»æœºåˆ—è¡¨
          </button>
          <button class="tab-btn" :class="{ active: serverCurrentTab === 'management' }"
            @click="serverCurrentTab = 'management'" style="background: var(--server-primary) !important;"
            v-if="serverCurrentTab === 'management'">
            <i class="fas fa-cog"></i> åå°ç®¡ç†
          </button>
          <button class="tab-btn" :class="{ active: serverCurrentTab === 'management' }"
            @click="serverCurrentTab = 'management'" v-else>
            <i class="fas fa-cog"></i> åå°ç®¡ç†
          </button>
          <!-- åŠ¨æ€SSHç»ˆç«¯æ ‡ç­¾é¡µ -->
          <template v-for="session in sshSessions" :key="session.id">
            <button class="tab-btn ssh-session-tab" :class="{ active: serverCurrentTab === 'ssh_' + session.id }"
              @click="switchToSSHTab(session.id)" @dblclick.stop="closeSSHSession(session.id)"
              @mousedown.middle.prevent.stop="closeSSHSession(session.id)">
              <i class="fas fa-terminal"></i>
              <span>{{ session.server.name }}</span>
              <!-- <span class="ssh-tab-close" @click.stop="closeSSHSession(session.id)" title="å…³é—­">Ã—</span> -->
            </button>
          </template>
          <!-- æ–°å»ºSSHç»ˆç«¯æŒ‰é’® -->
          <button class="tab-btn ssh-add-tab" @click="showAddSessionModal" title="æ–°å»ºSSHç»ˆç«¯" v-if="serverList.length > 0">
            <i class="fas fa-plus"></i>
          </button>
        </div>

        <!-- ä¸»æœºåˆ—è¡¨æ ‡ç­¾é¡µ -->
        <div v-show="serverCurrentTab === 'list'" class="sub-tab-content quick-fade-in">
          <!-- ä¸»æœºæ§åˆ¶æ¡ -->
          <div class="controls-bar">
            <div class="controls-row">
              <div class="search-box">
                <i class="fas fa-search"></i>
                <input v-model="serverSearchText" placeholder="æœç´¢åç§°ã€IP æˆ–æ ‡ç­¾..." class="form-input" />
              </div>

              <div class="stats-pills">
                <div class="stat-pill" :class="{ active: serverStatusFilter === 'all' }"
                  @click="serverStatusFilter = 'all'">
                  <span class="label">å…¨éƒ¨</span>
                  <span class="value">{{ serverList.length }}</span>
                </div>
                <div class="stat-pill online" :class="{ active: serverStatusFilter === 'online' }"
                  @click="serverStatusFilter = serverStatusFilter === 'online' ? 'all' : 'online'">
                  <span class="label">åœ¨çº¿</span>
                  <span class="value">{{ serverList.filter(s => s.status === 'online').length }}</span>
                </div>
                <div class="stat-pill offline" :class="{ active: serverStatusFilter === 'offline' }"
                  @click="serverStatusFilter = serverStatusFilter === 'offline' ? 'all' : 'offline'">
                  <span class="label">ç¦»çº¿</span>
                  <span class="value">{{ serverList.filter(s => s.status === 'offline').length }}</span>
                </div>
              </div>
            </div>

            <div class="controls-row">
              <div style="display: flex; gap: 10px; align-items: center;">
                <button class="btn btn-primary" @click="loadServerList" :disabled="serverLoading">
                  <i class="fas fa-sync-alt" :class="{ 'fa-spin': serverLoading }"></i>
                  åˆ·æ–°çŠ¶æ€
                </button>
              </div>

              <div class="refresh-info">
                <div v-if="serverPollingEnabled" style="display: flex; align-items: center; gap: 12px; flex: 1;">
                  <span style="font-size: 12px; color: var(--text-tertiary);">
                    <i class="fas fa-clock" style="margin-right: 4px;"></i>
                    {{ serverRefreshCountdown }} ç§’ååˆ·æ–°
                  </span>
                  <div class="refresh-progress" style="flex: 1; max-width: 100px;">
                    <div class="refresh-progress-bar" :style="{ width: serverRefreshProgress + '%' }"></div>
                  </div>
                </div>
                <button class="btn btn-secondary icon-only"
                  @click="serverPollingEnabled = !serverPollingEnabled; serverPollingEnabled ? startServerPolling() : stopServerPolling()"
                  :title="serverPollingEnabled ? 'æš‚åœè‡ªåŠ¨ç›‘æµ‹' : 'å¼€å¯è‡ªåŠ¨ç›‘æµ‹'">
                  <i class="fas" :class="serverPollingEnabled ? 'fa-pause' : 'fa-play'"></i>
                </button>
                <button class="btn btn-secondary" style="padding: 6px 12px; min-width: 100px;" @click="probeAllServers"
                  :disabled="probeStatus === 'loading'">
                  <i v-if="probeStatus === 'success'" class="fas fa-check" style="color: #fff; margin-right: 4px;"></i>
                  <i v-else-if="probeStatus === 'error'" class="fas fa-times"
                    style="color: var(--danger-color); margin-right: 4px;"></i>
                  <i v-else class="fas" :class="{
                    'fa-heartbeat': probeStatus !== 'loading',
                    'fa-spinner fa-spin': probeStatus === 'loading'
                  }"></i>
                  æ‰¹é‡æ‹¨æµ‹
                </button>
              </div>
            </div>
          </div>

          <div v-if="serverLoading && serverList.length === 0" class="loading">
            <div class="spinner" style="margin-bottom: 12px;"></div>
            <p>æ­£åœ¨åŒæ­¥ä¸»æœºçŠ¶æ€...</p>
          </div>

          <!-- ä¸»æœºå¡ç‰‡åˆ—è¡¨ -->
          <div v-for="server in filteredServerList" :key="server.id" class="server-card"
            :class="{ expanded: isServerExpanded(server.id) }">
            <div class="server-card-header" @click="toggleServer(server.id)">
              <div class="server-card-info">
                <div class="server-status-indicator" :class="server.status || 'unknown'"></div>
                <div style="flex: 1; min-width: 0;">
                  <div style="display: flex; align-items: center; gap: 8px; flex-wrap: wrap;">
                    <span class="server-name">{{ server.name }}</span>
                    <span v-if="server.last_check_time"
                      style="font-size: 11px; color: var(--text-tertiary); display: inline-flex; align-items: center; gap: 4px;"
                      title="æœ€è¿‘æ›´æ–°æ—¶é—´">
                      <i class="far fa-clock"></i>
                      {{ formatDateTime(server.last_check_time) }}
                    </span>
                    <span v-if="server.response_time"
                      style="font-size: 11px; color: var(--text-tertiary); display: inline-flex; align-items: center; gap: 4px;"
                      title="å“åº”æ—¶é—´">
                      <i class="fas fa-bolt" style="font-size: 10px;"></i>
                      {{ server.response_time }}ms
                    </span>
                  </div>
                  <div class="server-host">{{ server.username }}@{{ server.host }}:{{ server.port }}</div>
                </div>
              </div>

              <div style="display: flex; align-items: center; gap: 12px;" class="header-right">
                <div class="server-tags" style="margin-top: 0; display: flex; gap: 4px;"
                  v-if="server.tags && server.tags.length > 0">
                  <span v-for="tag in server.tags" :key="tag" class="server-tag">{{ tag }}</span>
                </div>

                <div class="account-balance" style="gap: 6px;">
                  <button class="btn btn-sm btn-secondary icon-only" @click.stop="refreshServerInfo(server.id)"
                    title="åˆ·æ–°çŠ¶æ€">
                    <i class="fas" :class="server.loading ? 'fa-spinner fa-spin' : 'fa-sync-alt'"></i>
                  </button>
                  <button class="btn btn-sm btn-primary" @click.stop="openSSHTerminal(server)" title="SSH è¿æ¥">
                    <i class="fas fa-terminal"></i>
                  </button>
                </div>
              </div>
            </div>

            <!-- å¡ç‰‡å±•å¼€è¯¦æƒ…åŒºåŸŸ -->
            <div class="server-card-body">
              <div class="divider" style="margin: 0; opacity: 0.5;"></div>
              <div class="server-details" style="border: none; padding: 8px 3px;">

                <div v-if="server.loading" class="loading" style="padding: 8px 3px;">
                  <div class="spinner-sm"></div>
                  <p style="margin-top: 10px; font-size: 12px;">æ­£åœ¨è·å–å®æ—¶è´Ÿè½½å‚æ•°...</p>
                </div>

                <div v-else-if="server.error" class="error" style="margin: 0px 3px;">
                  <i class="fas fa-exclamation-circle"></i> {{ server.error }}
                </div>

                <div v-else-if="server.info">
                  <!-- ä¸»è¦ä¿¡æ¯ç½‘æ ¼ -->
                  <div class="server-details-grid">
                    <!-- ç³»ç»Ÿä¿¡æ¯ -->
                    <div class="server-detail-section">
                      <h4><i class="fas fa-microchip"></i> ç¡¬ä»¶è½½è·</h4>
                      <div class="server-detail-item">
                        <span class="server-detail-label">CPU è´Ÿè½½ ({{ server.info.cpu.Cores }} æ ¸å¿ƒ)</span>
                        <span class="server-detail-value">{{ server.info.cpu.Usage }}</span>
                      </div>
                      <div class="progress-bar">
                        <div class="progress-bar-fill" :style="{ width: server.info.cpu.Usage }"></div>
                      </div>

                      <div class="server-detail-item" style="margin-top: 12px;">
                        <span class="server-detail-label">å†…å­˜ä½¿ç”¨ ({{ server.info.memory.Used }} / {{
                          server.info.memory.Total }})</span>
                        <span class="server-detail-value">{{ server.info.memory.Usage }}</span>
                      </div>
                      <div class="progress-bar">
                        <div class="progress-bar-fill" :class="getMemoryClass(server.info.memory.Usage)"
                          :style="{ width: server.info.memory.Usage }"></div>
                      </div>
                    </div>

                    <!-- å­˜å‚¨èµ„æº -->
                    <div class="server-detail-section">
                      <h4><i class="fas fa-database"></i> å­˜å‚¨èµ„æº</h4>
                      <!-- åªæ˜¾ç¤ºä¸»åˆ†åŒºæˆ–ç¬¬ä¸€ä¸ªåˆ†åŒº -->
                      <div v-if="server.info.disk && server.info.disk.length > 0">
                        <div class="server-detail-item">
                          <span class="server-detail-label">ä¸»å­˜å‚¨ ({{ server.info.disk[0].device }})</span>
                          <span class="server-detail-value">{{ server.info.disk[0].used }} / {{
                            server.info.disk[0].total }}</span>
                        </div>
                        <div class="progress-bar">
                          <div class="progress-bar-fill" :class="getDiskClass(server.info.disk[0].usage)"
                            :style="{ width: server.info.disk[0].usage }"></div>
                        </div>
                        <div class="server-detail-item" style="border:none; padding: 4px 0 0 0;">
                          <span class="server-detail-value" style="font-size: 11px; opacity: 0.7;">ä½¿ç”¨ç‡: {{
                            server.info.disk[0].usage }}</span>
                        </div>
                      </div>
                    </div>

                    <!-- èŠ‚ç‚¹æ¦‚è§ˆ -->
                    <div class="server-detail-section">
                      <h4><i class="fas fa-info-circle"></i> ç³»ç»Ÿæ‘˜è¦</h4>
                      <div v-for="(value, key) in server.info.system" :key="key" class="server-detail-item"
                        style="padding: 4px 0;">
                        <span class="server-detail-label">{{ translateInfoKey(key) }}</span>
                        <span class="server-detail-value">{{ key === 'Uptime' ? formatUptime(value) : value }}</span>
                      </div>
                    </div>
                  </div>

                  <!-- å®¹å™¨è™šæ‹ŸåŒ– - å¯æŠ˜å é¢æ¿ -->
                  <div class="server-detail-section docker-section">
                    <div class="docker-section-header" @click.stop="toggleDockerPanel(server.id)"
                      style="cursor: pointer;">
                      <h4>
                        <i class="fab fa-docker"></i> å®¹å™¨è™šæ‹ŸåŒ–
                        <i class="fas fa-chevron-right toggle-icon"
                          :style="{ transform: isDockerPanelExpanded(server.id) ? 'rotate(90deg)' : 'rotate(0deg)' }"></i>
                      </h4>
                      <div class="docker-section-status">
                        <span class="docker-status-badge"
                          :class="server.info.docker.installed ? 'installed' : 'not-installed'">
                          {{ server.info.docker.installed ? 'å·²å®‰è£…' : 'æœªæ£€æµ‹åˆ°' }}
                        </span>
                        <span v-if="server.info.docker.installed && server.info.docker.containers.length > 0"
                          class="docker-container-count">
                          <span style="color: var(--success-color);">â—</span>
                          {{ getRunningContainers(server.info.docker.containers) }} è¿è¡Œ
                          <span v-if="getPausedContainers(server.info.docker.containers) > 0"
                            style="margin-left: 8px; color: var(--warning-color);">â—</span>
                          <span v-if="getPausedContainers(server.info.docker.containers) > 0">
                            {{ getPausedContainers(server.info.docker.containers) }} æš‚åœ
                          </span>
                        </span>
                      </div>
                    </div>

                    <!-- å±•å¼€çš„å®¹å™¨é¢æ¿ - ä½¿ç”¨ç±»ä¼¼ modal çš„æ ·å¼ -->
                    <div v-if="isDockerPanelExpanded(server.id) && server.info.docker.installed"
                      class="docker-panel-content">
                      <div v-if="server.info.docker.containers.length > 0" class="docker-containers-grid">
                        <div v-for="container in server.info.docker.containers" :key="container.id"
                          class="docker-container-mini-card" :class="{ 
                            'running': container.status.includes('Up') && !container.status.includes('Paused'),
                            'paused': container.status.includes('Paused')
                          }">
                          <div class="container-info">
                            <span class="container-status-dot"
                              :class="{ 'online': container.status.includes('Up') && !container.status.includes('Paused'), 'paused': container.status.includes('Paused') }"></span>
                            <span class="container-name" :title="container.name">{{ container.name }}</span>
                          </div>
                          <div class="container-actions">
                            <button v-if="container.status.includes('Up') && !container.status.includes('Paused')"
                              class="btn btn-xs btn-warning icon-only"
                              @click.stop="handleDockerAction(server.id, container.id, 'pause')" title="æš‚åœ">
                              <i class="fas fa-pause"></i>
                            </button>
                            <button v-else-if="container.status.includes('Paused')"
                              class="btn btn-xs btn-success icon-only"
                              @click.stop="handleDockerAction(server.id, container.id, 'unpause')" title="æ¢å¤">
                              <i class="fas fa-play"></i>
                            </button>
                            <button v-else class="btn btn-xs btn-success icon-only"
                              @click.stop="handleDockerAction(server.id, container.id, 'start')" title="å¯åŠ¨">
                              <i class="fas fa-play"></i>
                            </button>
                            <button class="btn btn-xs btn-secondary icon-only"
                              @click.stop="handleDockerAction(server.id, container.id, 'restart')" title="é‡å¯">
                              <i class="fas fa-redo-alt"></i>
                            </button>
                          </div>
                        </div>
                      </div>
                      <div v-else class="docker-empty-mini">
                        <i class="fab fa-docker"></i>
                        <span>æš‚æ— å®¹å™¨</span>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div v-if="!serverLoading && filteredServerList.length === 0" class="empty-state">
            <div class="server-empty-state-icon">ğŸ”</div>
            <p>æœªæ‰¾åˆ°ç¬¦åˆæ¡ä»¶çš„ä¸»æœº</p>
          </div>
        </div>

        <!-- åå°ç®¡ç†æ ‡ç­¾é¡µ -->
        <div v-show="serverCurrentTab === 'management'" class="sub-tab-content quick-fade-in">
          <!-- ä¸»æœºç®¡ç†é¢æ¿ -->
          <div class="panel">
            <div class="panel-header" style="flex-wrap: wrap; gap: 8px;">
              <div class="panel-title"></div>
              <div style="display: flex; gap: 8px; flex-wrap: wrap;">
                <button class="btn btn-success" style="padding: 6px 12px;" @click="openAddServerModal">
                  <i class="fas fa-plus"></i> æ·»åŠ ä¸»æœº
                </button>
                <button class="btn btn-server" style="padding: 6px 10px;" @click="loadServerList"
                  :disabled="serverLoading">
                  <i class="fas fa-sync-alt" :class="{ 'fa-spin': serverLoading }"></i>
                </button>
                <button class="btn btn-server" style="padding: 6px 12px; min-width: 100px;" @click="probeAllServers"
                  :disabled="probeStatus === 'loading'">
                  <i v-if="probeStatus === 'success'" class="fas fa-check" style="color: #fff; margin-right: 4px;"></i>
                  <i v-else-if="probeStatus === 'error'" class="fas fa-times"
                    style="color: var(--danger-color); margin-right: 4px;"></i>
                  <i v-else class="fas" :class="{
                    'fa-heartbeat': probeStatus !== 'loading',
                    'fa-spinner fa-spin': probeStatus === 'loading'
                  }"></i>
                  æ‰¹é‡æ‹¨æµ‹
                </button>
                <button class="btn btn-server" style="padding: 6px 12px;" @click="exportServers">
                  <i class="fas fa-upload"></i> å¯¼å‡º
                </button>
                <button class="btn btn-server" style="padding: 6px 12px;" @click="openImportServerModal">
                  <i class="fas fa-download"></i> å¯¼å…¥
                </button>
              </div>
            </div>

            <div v-if="serverLoading" class="loading">
              <div class="spinner"></div>
              <div style="margin-top: 12px;">åŠ è½½ä¸­...</div>
            </div>

            <div v-else class="table-container">
              <table class="data-table">
                <thead>
                  <tr>
                    <th>çŠ¶æ€</th>
                    <th>ä¸»æœºåç§°</th>
                    <th>ä¸»æœºåœ°å€</th>
                    <th>å“åº”</th>
                    <th>æœ€åæ£€æŸ¥</th>
                    <th style="width: 180px;">æ“ä½œ</th>
                  </tr>
                </thead>
                <tbody>
                  <tr v-for="server in serverList" :key="server.id">
                    <td>
                      <span class="proxied-badge"
                        :class="server.status === 'online' ? 'proxied-on' : (server.status === 'offline' ? 'proxied-off' : '')">
                        {{ server.status === 'online' ? 'åœ¨çº¿' : (server.status === 'offline' ? 'ç¦»çº¿' : 'æœªçŸ¥') }}
                      </span>
                    </td>
                    <td>
                      <strong>{{ server.name }}</strong>
                    </td>
                    <td>
                      <code
                        style="background: var(--bg-tertiary); padding: 2px 6px; border-radius: 4px; font-size: 11px;">
                        {{ server.username }}@{{ server.host }}:{{ server.port }}
                      </code>
                    </td>
                    <td><span v-if="server.response_time" style="font-family: monospace;">{{ server.response_time
                        }}ms</span><span v-else>-</span></td>
                    <td style="font-size: 11px; opacity: 0.8;">{{ server.last_check_time ?
                      formatDateTime(server.last_check_time) : 'ä»æœªæ£€æŸ¥' }}</td>
                    <td class="actions">
                      <button class="btn btn-sm btn-secondary icon-only" @click="openEditServerModal(server.id)"
                        title="ç¼–è¾‘"><i class="fas fa-edit"></i></button>
                      <button class="btn btn-sm btn-secondary icon-only" @click="rebootServerById(server.id)"
                        title="é‡å¯"><i class="fas fa-redo"></i></button>
                      <button class="btn btn-sm btn-danger icon-only" @click="deleteServerById(server.id)" title="åˆ é™¤"><i
                          class="fas fa-trash"></i></button>
                    </td>
                  </tr>
                </tbody>
              </table>
              <div v-if="serverList.length === 0" class="empty-state">
                <i class="fas fa-server" style="font-size: 48px; margin-bottom: 16px;"></i>
                <div>æš‚æ— ä¸»æœºï¼Œç‚¹å‡»ä¸Šæ–¹æŒ‰é’®æ·»åŠ </div>
              </div>
            </div>
          </div>

          <!-- æ‰¹é‡æ·»åŠ ä¸»æœº -->
          <div class="panel" style="margin-top: 16px;">
            <div class="panel-header">
              <div class="panel-title">æ‰¹é‡æ·»åŠ ä¸»æœº</div>
            </div>
            <div>
              <textarea v-model="serverBatchText" class="form-textarea" placeholder="ä¾‹å¦‚ï¼š
WebæœåŠ¡å™¨,192.168.1.100,22,root,password123
æ•°æ®åº“æœåŠ¡å™¨,192.168.1.101,22,root,secure_pass"
                style="min-height: 150px; font-family: monospace; font-size: 12px; white-space: pre;"></textarea>
              <div v-if="serverBatchError" class="form-error" style="margin-top: 8px;">{{ serverBatchError }}</div>
              <div v-if="serverBatchSuccess" class="form-success" style="margin-top: 8px;">{{ serverBatchSuccess }}
              </div>
              <button class="btn btn-primary" @click="batchAddServers" :disabled="serverAddingBatch"
                style="width: 100%; margin-top: 12px;">
                {{ serverAddingBatch ? 'æ·»åŠ ä¸­...' : 'æ‰¹é‡æ·»åŠ ' }}
              </button>
            </div>
          </div>

          <!-- æ‰¹é‡æ·»åŠ  -->
          <div class="panel" style="margin-top: 16px;">
            <div class="panel-header">
              <div class="panel-title">å¿«æ·é…ç½®</div>
            </div>
            <div class="secondary-config-row" style="padding: 1px;">
              <!-- ç›‘æ§å…¨å±€é…ç½® -->
              <div class="config-card">
                <div class="config-card-title">
                  <i class="fas fa-clock"></i> è‡ªåŠ¨æ‹¨æµ‹ç­–ç•¥
                </div>
                <div class="form-row">
                  <div class="form-group flex-1">
                    <label>æ¢æµ‹å‘¨æœŸ (S)</label>
                    <input type="number" v-model="monitorConfig.interval" class="form-input" min="10" />
                  </div>
                  <div class="form-group flex-1">
                    <label>å“åº”è¶…æ—¶ (S)</label>
                    <input type="number" v-model="monitorConfig.timeout" class="form-input" min="1" />
                  </div>
                  <div class="form-group flex-1">
                    <label>æ—¥å¿—å­˜é‡ (å¤©)</label>
                    <input type="number" v-model="monitorConfig.logRetentionDays" class="form-input" min="1" />
                  </div>
                </div>
                <button @click="saveMonitorConfig" class="btn btn-primary" :disabled="monitorConfigSaving"
                  style="width: 100%;">
                  <i class="fas" :class="monitorConfigSaving ? 'fa-spinner fa-spin' : 'fa-save'"></i>
                  åŒæ­¥é…ç½®
                </button>
              </div>

              <!-- ä¸»æœºå‡­æ®ç®¡ç† -->
              <div class="config-card">
                <div class="config-card-title">
                  <i class="fas fa-shield-alt"></i> é¢„è®¾è®¿é—®å‡­æ®
                  <button class="btn btn-success btn-sm" style="margin-left: auto; padding: 4px 10px;"
                    @click="showAddCredentialModal = true">
                    <!-- <i class="fas fa-plus"></i>  -->
                    æ·»åŠ 
                  </button>
                </div>
                <div v-if="serverCredentials.length > 0" class="credential-list" style="margin-top: 10px;">
                  <div v-for="cred in serverCredentials" :key="cred.id" class="credential-item">
                    <div class="cred-info">
                      <span class="cred-name">
                        {{ cred.name }}
                        <span class="cred-user">{{ cred.username }}</span>
                    </div>
                    <div class="cred-actions">
                      <button v-if="!cred.is_default" class="btn btn-sm btn-secondary"
                        style="padding: 2px 8px; font-size: 15px; margin-right: 6px;"
                        @click="setDefaultCredential(cred.id)" title="è®¾ä¸ºé»˜è®¤">
                        <i class="fas fa-star"></i>
                      </button>
                      <i class="fas fa-trash text-danger" @click="deleteCredential(cred.id)"
                        style="cursor: pointer;"></i>
                    </div>
                  </div>
                </div>
                <div v-else class="empty-mini" style="margin-top: 10px;">
                  <i class="fas fa-shield-alt"></i>
                  <span>æš‚æ— é¢„è®¾å‡­æ®</span>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- SSH ç»ˆç«¯å­æ ‡ç­¾é¡µå†…å®¹ - ä½¿ç”¨v-showä¿æŒè¿æ¥ -->
        <template v-for="session in sshSessions" :key="'content-' + session.id">
          <div v-show="serverCurrentTab === 'ssh_' + session.id" class="sub-tab-content ssh-tab-content"
            :class="{ 'ssh-fullscreen-mode': session.fullscreen }">
            <!-- ä½¿ç”¨ panel å¸ƒå±€ -->
            <div class="panel" :class="{ 'ssh-panel-fullscreen': session.fullscreen }">
              <div class="panel-header">
                <div class="panel-title">
                  <span v-if="session.server" style="font-size: 13px; font-weight: 600;">
                    <i class="fas fa-terminal"></i> {{ session.server.name }}
                  </span>
                </div>
                <div style="display: flex; gap: 8px;">
                  <button class="btn btn-secondary" style="padding: 6px 12px;" @click="toggleSSHFullscreen(session.id)"
                    title="å…¨å±åˆ‡æ¢">
                    <i class="fas" :class="session.fullscreen ? 'fa-compress' : 'fa-expand'"></i>
                  </button>
                  <button class="btn btn-secondary" style="padding: 6px 12px;" @click="reconnectSSHSession(session.id)"
                    :disabled="session.connected || !session.ws" title="é‡æ–°è¿æ¥">
                    <i class="fas fa-sync-alt"></i>
                  </button>
                  <button class="btn btn-danger" style="padding: 6px 12px;" @click="closeSSHSession(session.id)"
                    title="å…³é—­ä¼šè¯">
                    <i class="fas fa-times"></i>
                  </button>
                </div>
              </div>

              <!-- å†…å®¹å®¹å™¨ -->
              <div class="ssh-content-wrapper">
                <!-- ç»ˆç«¯è§†å›¾ -->
                <div class="ssh-terminal-container" :class="{ 'fullscreen': session.fullscreen }">
                  <div :id="'ssh-terminal-' + session.id" class="ssh-terminal-pane-embedded"
                    :class="{ 'fullscreen': session.fullscreen }"></div>
                </div>
              </div>
            </div>
          </div>
        </template>

      </div>
      <!-- ==================== ä¸»æœºç®¡ç†éƒ¨åˆ†ç»“æŸ ==================== -->

      <!-- ==================== Antigravity ç®¡ç†éƒ¨åˆ† ==================== -->
      <div v-if="mainActiveTab === 'antigravity'" class="tab-content antigravity-tab-content"
        :class="getTabAnimationClass('antigravity')">

        <!-- Antigravity å­æ ‡ç­¾æ  -->
        <div class="sec-tabs">
          <button class="tab-btn" :class="{ active: antigravityCurrentTab === 'quotas' }"
            @click="switchAntigravityTab('quotas')">
            <i class="fas fa-chart-pie"></i> é¢åº¦ä½¿ç”¨
          </button>
          <button class="tab-btn" :class="{ active: antigravityCurrentTab === 'accounts' }"
            @click="switchAntigravityTab('accounts')">
            <i class="fas fa-list"></i> è´¦å·ç®¡ç†
          </button>
          <button class="tab-btn" :class="{ active: antigravityCurrentTab === 'logs' }"
            @click="switchAntigravityTab('logs')">
            <i class="fas fa-history"></i> è°ƒç”¨æ—¥å¿—
          </button>
          <button class="tab-btn" :class="{ active: antigravityCurrentTab === 'settings' }"
            @click="switchAntigravityTab('settings')">
            <i class="fas fa-cog"></i> æ¨¡å—é…ç½®
          </button>
        </div>

        <!-- è´¦å·ç®¡ç†åˆ—è¡¨ -->
        <!-- å‡­è¯åˆ—è¡¨ (Accounts) -->
        <div v-show="antigravityCurrentTab === 'accounts'" class="sub-tab-content quick-fade-in">
          <div class="panel">
            <div class="panel-header">
              <div style="display: flex; gap: 8px;">
                <button class="btn btn-ag" style="padding: 6px 12px;" @click="showOAuthExpand = !showOAuthExpand">
                  <i class="fab fa-google"></i> OAuth æˆæƒ
                </button>
                <button class="btn btn-success" style="padding: 6px 12px;" @click="openAddAntigravityManualModal">
                  <i class="fas fa-plus-circle"></i> æ‰‹åŠ¨æ·»åŠ 
                </button>
                <button class="btn btn-secondary" @click="loadAntigravityAccounts" :disabled="antigravityLoading">
                  <i class="fas fa-sync-alt" :class="{ 'fa-spin': antigravityLoading }"></i>
                </button>
                <button class="btn btn-secondary" @click="refreshAllAntigravityTokens" title="åˆ·æ–°æ‰€æœ‰ Token">
                  <i class="fas fa-key"></i>
                </button>
              </div>
            </div>

            <!-- Expandable OAuth Panel -->
            <div class="ag-expandable-panel" :class="{ expanded: showOAuthExpand }">
              <div class="panel-header" style="border-bottom: none; padding-bottom: 0;">
                <div class="panel-title" style="width: 100%; text-align: center; padding-top: 10px;">è¿æ¥ Google è´¦å·</div>
              </div>

              <div class="oauth-modern-body">
                <!-- Step 1 -->
                <div class="oauth-step-item">
                  <div class="step-badge">1</div>
                  <div class="step-content">
                    <div class="step-text">ç™»å½• Google ä»¥è·å–æˆæƒç </div>
                    <button class="btn btn-ag btn-block" @click="openGoogleAuthUrl">
                      <i class="fab fa-google"></i> è·å–æˆæƒé“¾æ¥
                    </button>
                  </div>
                </div>

                <!-- Divider -->
                <div class="oauth-step-line"></div>

                <!-- Step 2 -->
                <div class="oauth-step-item">
                  <div class="step-badge">2</div>
                  <div class="step-content">
                    <div class="step-text">åœ¨ä¸‹æ–¹ç²˜è´´é‡å®šå‘åçš„ URL</div>
                    <textarea v-model="agOauthUrl" class="form-textarea oauth-textarea"
                      placeholder="ç²˜è´´ä»¥ http:// å¼€å¤´çš„å®Œæ•´ URL..." spellcheck="false"></textarea>
                  </div>
                </div>

                <!-- Options -->
                <div class="oauth-options">
                  <div class="oauth-option-row">
                    <input type="text" v-model="agCustomProjectId" class="form-input input-sm"
                      placeholder="è‡ªå®šä¹‰é¡¹ç›® ID (å¯é€‰)">
                    <div style="display: flex; align-items: center; gap: 8px;">
                      <label class="switch">
                        <input type="checkbox" v-model="agAllowRandomProjectId">
                        <span class="slider round"></span>
                      </label>
                      <span style="font-size: 12px; color: var(--text-secondary);">å…è®¸éšæœº ID</span>
                    </div>
                  </div>
                </div>

                <!-- Action -->
                <button class="btn btn-success btn-block btn-lg mt-3" @click="parseAgOauthUrl"
                  :disabled="!agOauthUrl || antigravityLoading">
                  <i class="fas" :class="antigravityLoading ? 'fa-spinner fa-spin' : 'fa-link'"></i>
                  {{ antigravityLoading ? 'éªŒè¯ä¸­...' : 'éªŒè¯å¹¶è¿æ¥' }}
                </button>
              </div>
            </div>

            <!-- ç»Ÿè®¡ä¿¡æ¯æ  -->
            <div v-if="antigravityStats" class="stats-bar"
              style="display: flex; gap: 20px; padding: 12px 16px; background: var(--bg-secondary); margin-bottom: 16px; border-radius: 8px; font-size: 13px;">
              <div class="stat-item">
                <span style="opacity: 0.7;">æ€» Token:</span>
                <strong style="margin-left: 4px;">{{ antigravityStats.total || 0 }}</strong>
              </div>
              <div class="stat-item">
                <span style="opacity: 0.7;">åœ¨çº¿:</span>
                <strong style="margin-left: 4px; color: var(--success-color);">{{ antigravityStats.online || 0
                  }}</strong>
              </div>
              <div class="stat-item">
                <span style="opacity: 0.7;">æ— æ•ˆ:</span>
                <strong style="margin-left: 4px; color: var(--danger-color);">{{ antigravityStats.disabled || 0
                  }}</strong>
              </div>
            </div>


            <div v-if="antigravityLoading && antigravityAccounts.length === 0" class="loading">
              <div class="spinner"></div>
              <div style="margin-top: 12px;">åŠ è½½ä¸­...</div>
            </div>

            <div v-else class="table-container">
              <table class="data-table">
                <thead>
                  <tr>
                    <th>å¤‡æ³¨åç§°</th>
                    <th>é¡¹ç›® ID</th>
                    <th>é‚®ç®±</th>
                    <th>çŠ¶æ€</th>
                    <th style="width: 140px;">æ“ä½œ</th>
                  </tr>
                </thead>
                <tbody>
                  <tr v-for="account in antigravityAccounts" :key="account.id">
                    <td><strong>{{ account.name || 'æœªå‘½å' }}</strong></td>
                    <td><code class="code-sm">{{ account.projectId || '-' }}</code></td>
                    <td><span style="font-size: 11px; opacity: 0.7;">{{ account.email || '-' }}</span></td>
                    <td>
                      <span class="ag-status-badge"
                        :class="account.status === 'online' ? 'ag-status-online' : (account.status === 'error' ? 'ag-status-error' : 'ag-status-unknown')">
                        {{ account.status === 'online' ? 'åœ¨çº¿' : (account.status === 'error' ? 'å¼‚å¸¸' : 'æœªçŸ¥') }}
                      </span>
                    </td>
                    <td class="actions">
                      <div style="display: flex; align-items: center; gap: 8px;">
                        <button class="btn btn-sm btn-secondary icon-only" @click="toggleAntigravityAccount(account)"
                          :title="account.enable ? 'ç‚¹å‡»åœç”¨' : 'ç‚¹å‡»å¯ç”¨'"
                          :class="{ 'btn-success': account.enable, 'btn-secondary': !account.enable }">
                          <i class="fas" :class="account.enable ? 'fa-toggle-on' : 'fa-toggle-off'"></i>
                        </button>
                        <button class="btn btn-sm btn-secondary icon-only" @click="editAntigravityAccount(account)"
                          title="ç¼–è¾‘">
                          <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn btn-sm btn-danger icon-only" @click="deleteAntigravityAccount(account)"
                          title="åˆ é™¤">
                          <i class="fas fa-trash"></i>
                        </button>
                      </div>
                    </td>
                  </tr>
                </tbody>
              </table>
              <div v-if="antigravityAccounts.length === 0" class="empty-state">
                <i class="fas fa-atom" style="font-size: 48px; margin-bottom: 16px;"></i>
                <div>æš‚æ— è´¦å·ï¼Œç‚¹å‡»ä¸Šæ–¹æŒ‰é’®æ–°å¢æˆæƒ</div>
              </div>
            </div>
          </div>
        </div>

        <!-- å‡­è¯ç”¨é‡ (Usage/Quotas) -->
        <div v-show="antigravityCurrentTab === 'quotas'" class="sub-tab-content quick-fade-in">
          <div class="panel-header" style="justify-content: space-between; padding-bottom: 10px;">
            <div style="display: flex; gap: 16px; align-items: center;">
              <div class="panel-title">é¢åº¦çŠ¶æ€</div>
              <select class="ag-account-selector" v-model="antigravityQuotaSelectedAccountId"
                @change="loadAntigravityQuotas()" style="padding-left: 8px; width: 180px;">
                <option v-for="acc in antigravityAccounts" :key="acc.id" :value="acc.id">
                  {{ acc.name }} ({{ acc.status === 'online' ? 'åœ¨çº¿' : 'ç¦»çº¿' }})
                </option>
              </select>
            </div>
            <div>
              <button class="btn btn-secondary btn-sm" @click="loadAntigravityQuotas(false)"
                :disabled="antigravityQuotaLoading">
                <i class="fas fa-sync-alt" :class="{ 'fa-spin': antigravityQuotaLoading }"></i> åˆ·æ–°é¢åº¦
              </button>
            </div>
          </div>

          <div v-if="antigravityQuotaLoading && Object.keys(antigravityQuotas).length === 0" class="loading">
            <div class="spinner"></div>
            <div style="margin-top: 12px;">æ­£åœ¨è·å–é¢åº¦è¯¦æƒ…...</div>
          </div>

          <div v-else class="ag-quota-list-view">
            <div class="panel">
              <div class="table-container">
                <table class="data-table">
                  <thead>
                    <tr>
                      <th style="width: 250px;">æ¨¡å‹ ID</th>
                      <th>åˆ†ç»„</th>
                      <th>å‰©ä½™é¢åº¦</th>
                      <th style="width: 100px;">çŠ¶æ€</th>
                      <th style="width: 150px;">é‡ç½®æ—¶é—´</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr v-for="model in getAllAntigravityModels()" :key="model.id"
                      :style="{ opacity: model.enabled === false ? 0.5 : 1, filter: model.enabled === false ? 'grayscale(100%)' : 'none', background: model.enabled === false ? 'var(--bg-tertiary)' : 'inherit' }">
                      <td style="font-family: monospace; font-weight: 600;">{{ model.id }}</td>
                      <td>{{ model.groupIcon }} {{ model.groupName }}</td>
                      <td>
                        <div class="quota-progress-container" style="width: 100%;">
                          <div class="progress-bar-compact">
                            <div class="progress-bar-fill"
                              :style="{ width: model.remaining + '%', background: getAgQuotaColor(model.remaining) }">
                            </div>
                          </div>
                          <span class="quota-percent" style="margin-left: 10px; width: 40px; text-align: right;"
                            :style="{ color: getAgQuotaColor(model.remaining) }">{{ model.remaining }}%</span>
                        </div>
                      </td>
                      <td>
                        <label class="switch">
                          <input type="checkbox" :checked="model.enabled !== false"
                            @change="toggleModelStatus(model, $event)">
                          <span class="slider round"></span>
                        </label>
                      </td>
                      <td>{{ formatResetCountdown(model.resetTime) }}</td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>

        <!-- è°ƒç”¨æ—¥å¿— (Logs) -->
        <div v-show="antigravityCurrentTab === 'logs'" class="sub-tab-content quick-fade-in">
          <div class="panel">
            <div class="panel-header">
              <div style="display: flex; gap: 8px;">
                <button class="btn btn-secondary btn-sm" @click="loadAntigravityLogs">
                  <i class="fas fa-sync-alt" :class="{ 'fa-spin': antigravityLoading }"></i> åˆ·æ–°
                </button>
                <button class="btn btn-danger btn-sm" @click="clearAntigravityLogs">æ¸…ç©º</button>
              </div>
            </div>
            <div class="table-container">
              <table class="data-table">
                <thead>
                  <tr>
                    <th>æ—¶é—´</th>
                    <th>å‡­è¯</th>
                    <th>æ¨¡å‹</th>
                    <th>è·¯å¾„</th>
                    <th>çŠ¶æ€</th>
                    <th>è€—æ—¶</th>
                    <th>æŸ¥çœ‹</th>
                  </tr>
                </thead>
                <tbody>
                  <tr v-for="log in antigravityLogs" :key="log.id">
                    <td style="font-size: 11px;">{{ new Date(log.timestamp).toLocaleString() }}</td>
                    <td>{{ log.accountName || 'System' }}</td>
                    <td style="font-family: monospace; font-size: 11px;">{{ log.model || '-' }}</td>
                    <td style="font-family: monospace; font-size: 11px;">{{ log.path }}</td>
                    <td>
                      <span :class="getLogStatusClass(log.statusCode)" style="font-weight: 600;">{{
                        log.statusCode }}</span>
                    </td>
                    <td>{{ log.durationMs }}ms</td>
                    <td>
                      <button class="btn btn-xs btn-secondary icon-only" @click="viewAntigravityLogDetail(log)">
                        <i class="fas fa-eye"></i>
                      </button>
                    </td>
                  </tr>
                </tbody>
              </table>
              <div v-if="antigravityLogs.length === 0" class="empty-state">
                <i class="fas fa-file-alt" style="font-size: 40px; opacity: 0.2; margin-bottom: 12px;"></i>
                <div>æš‚æ— è°ƒç”¨æ—¥å¿—</div>
              </div>
            </div>
          </div>
        </div>

        <!-- æ¨¡å—è®¾ç½® (Settings) -->
        <div v-show="antigravityCurrentTab === 'settings'" class="sub-tab-content quick-fade-in">
          <div class="panel">
            <div class="panel-header" style="border-bottom: 1px solid var(--border-color);">
              <div style="display: flex; justify-content: space-between; align-items: center; width: 100%;">
                <div class="panel-title-group">
                  <div class="panel-title">Antigravity API å‚æ•°é…ç½®</div>
                </div>
                <div style="display: flex; gap: 8px;">
                  <button class="btn btn-secondary btn-sm" @click="loadAntigravitySettings"
                    :disabled="antigravityLoading">
                    <i class="fas fa-sync-alt" :class="{ 'fa-spin': antigravityLoading }"></i> åˆ·æ–°
                  </button>
                  <button class="btn btn-primary btn-sm" @click="saveAllAgSettings" :disabled="antigravitySaving">
                    <i class="fas" :class="antigravitySaving ? 'fa-spinner fa-spin' : 'fa-save'"></i> ä¿å­˜å…¨éƒ¨
                  </button>
                </div>
              </div>
            </div>

            <div style="padding: 10px 3px 3px 3px;">
              <!-- ç”Ÿæˆå‚æ•° -->
              <div style="margin-bottom: 20px;">
                <div style="font-size: 13px; font-weight: 600; margin-bottom: 10px; color: var(--ag-primary);">
                  <i class="fas fa-sliders-h"></i> ç”Ÿæˆå‚æ•°
                </div>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 12px;">
                  <div>
                    <label style="font-size: 11px; opacity: 0.7; display: block; margin-bottom: 4px;">é»˜è®¤æ¸©åº¦</label>
                    <input type="number" step="0.1" min="0" max="2" v-model="agSettingsForm.DEFAULT_TEMPERATURE"
                      class="form-input" style="width: 100%; padding: 6px 10px; font-size: 13px;" placeholder="1">
                  </div>
                  <div>
                    <label style="font-size: 11px; opacity: 0.7; display: block; margin-bottom: 4px;">é»˜è®¤ top_p</label>
                    <input type="number" step="0.01" min="0" max="1" v-model="agSettingsForm.DEFAULT_TOP_P"
                      class="form-input" style="width: 100%; padding: 6px 10px; font-size: 13px;" placeholder="0.85">
                  </div>
                  <div>
                    <label style="font-size: 11px; opacity: 0.7; display: block; margin-bottom: 4px;">é»˜è®¤ top_k</label>
                    <input type="number" step="1" min="1" v-model="agSettingsForm.DEFAULT_TOP_K" class="form-input"
                      style="width: 100%; padding: 6px 10px; font-size: 13px;" placeholder="50">
                  </div>
                  <div>
                    <label style="font-size: 11px; opacity: 0.7; display: block; margin-bottom: 4px;">é»˜è®¤æœ€å¤§
                      Tokens</label>
                    <input type="number" step="1" min="1" v-model="agSettingsForm.DEFAULT_MAX_TOKENS" class="form-input"
                      style="width: 100%; padding: 6px 10px; font-size: 13px;" placeholder="8096">
                  </div>
                </div>
              </div>

              <!-- æ¨¡å‹é‡å®šå‘ -->
              <div style="margin-bottom: 24px;">
                <div
                  style="font-size: 13px; font-weight: 600; margin-bottom: 10px; color: var(--ag-primary); display: flex; align-items: center; gap: 8px;">
                  <i class="fas fa-exchange-alt"></i> æ¨¡å‹é‡å®šå‘ (åˆ«å)
                </div>
                <!-- åˆ—è¡¨ -->
                <div v-if="antigravityModelRedirects.length > 0"
                  style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 10px; margin-bottom: 12px;">
                  <div v-for="r in antigravityModelRedirects" :key="r.source_model"
                    style="background: var(--bg-tertiary); padding: 8px 12px; border-radius: 6px; display: flex; justify-content: space-between; align-items: center; border: 1px solid var(--border-color);">
                    <div style="font-size: 12px; font-family: monospace;">
                      <span style="color: var(--text-primary); font-weight: 600;">{{ r.source_model }}</span>
                      <i class="fas fa-arrow-right" style="font-size: 10px; opacity: 0.5; margin: 0 6px;"></i>
                      <span style="opacity: 0.8;">{{ r.target_model }}</span>
                    </div>
                    <button class="btn btn-xs btn-danger icon-only" @click="removeModelRedirect(r.source_model)"
                      title="åˆ é™¤é‡å®šå‘">
                      <i class="fas fa-trash"></i>
                    </button>
                  </div>
                </div>
                <div v-else style="font-size: 12px; opacity: 0.5; margin-bottom: 12px; padding: 8px 0;">
                  æš‚æ— é‡å®šå‘è§„åˆ™ã€‚æ·»åŠ åï¼Œè¯·æ±‚ source æ¨¡å‹å°†è‡ªåŠ¨è½¬å‘ç»™ target æ¨¡å‹ã€‚
                </div>

                <!-- æ·»åŠ è¡¨å• -->
                <div
                  style="display: flex; gap: 10px; align-items: flex-end; background: rgba(var(--ag-primary-rgb), 0); padding: 10px; border-radius: 8px;">
                  <div style="flex: 1;">
                    <label style="font-size: 11px; opacity: 0.7; display: block; margin-bottom: 4px;">æºæ¨¡å‹åç§°
                      (è‡ªå®šä¹‰)</label>
                    <input type="text" v-model="newRedirectSource" class="form-input"
                      style="width: 100%; padding: 6px 10px; font-size: 13px;" placeholder="ä¾‹å¦‚: gpt-4o">
                  </div>
                  <div style="flex: 1;">
                    <label style="font-size: 11px; opacity: 0.7; display: block; margin-bottom: 4px;">ç›®æ ‡æ¨¡å‹ ID
                      (å®é™…)</label>
                    <input type="text" v-model="newRedirectTarget" class="form-input"
                      style="width: 100%; padding: 6px 10px; font-size: 13px;" placeholder="ä¾‹å¦‚: gemini-1.5-pro">
                  </div>
                  <button class="btn btn-secondary btn-sm"
                    @click="addModelRedirect(newRedirectSource, newRedirectTarget).then(s => { if(s) { newRedirectSource=''; newRedirectTarget=''; } })">
                    <i class="fas fa-plus"></i> æ·»åŠ 
                  </button>
                </div>
              </div>

              <!-- å›¾ç‰‡è®¾ç½® + é™é¢ -->
              <div
                style="display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 20px; margin-bottom: 20px;">
                <div>
                  <div style="font-size: 13px; font-weight: 600; margin-bottom: 10px; color: var(--ag-primary);">
                    <i class="fas fa-image"></i> å›¾ç‰‡è®¾ç½®
                  </div>
                  <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 12px;">
                    <div>
                      <label style="font-size: 11px; opacity: 0.7; display: block; margin-bottom: 4px;">ä¿å­˜ä¸Šé™</label>
                      <input type="number" min="1" v-model="agSettingsForm.MAX_IMAGES" class="form-input"
                        style="width: 100%; padding: 6px 10px; font-size: 13px;" placeholder="10">
                    </div>
                    <div>
                      <label style="font-size: 11px; opacity: 0.7; display: block; margin-bottom: 4px;">è®¿é—®åŸºç¡€ URL</label>
                      <input type="text" v-model="agSettingsForm.IMAGE_BASE_URL" class="form-input"
                        style="width: 100%; padding: 6px 10px; font-size: 13px;" placeholder="ç•™ç©ºä½¿ç”¨é»˜è®¤">
                    </div>
                  </div>
                </div>
                <div>
                  <div style="font-size: 13px; font-weight: 600; margin-bottom: 10px; color: var(--ag-primary);">
                    <i class="fas fa-tachometer-alt"></i> é™é¢è®¾ç½®
                  </div>
                  <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 12px;">
                    <div>
                      <label style="font-size: 11px; opacity: 0.7; display: block; margin-bottom: 4px;">æ¯å°æ—¶ä¸Šé™</label>
                      <input type="number" v-model="agSettingsForm.CREDENTIAL_MAX_USAGE_PER_HOUR" class="form-input"
                        style="width: 100%; padding: 6px 10px; font-size: 13px;" placeholder="20">
                    </div>
                    <div>
                      <label style="font-size: 11px; opacity: 0.7; display: block; margin-bottom: 4px;">è¶…æ—¶ (ms)</label>
                      <input type="number" v-model="agSettingsForm.TIMEOUT" class="form-input"
                        style="width: 100%; padding: 6px 10px; font-size: 13px;" placeholder="120000">
                    </div>
                    <div>
                      <label style="font-size: 11px; opacity: 0.7; display: block; margin-bottom: 4px;">æ—¥å¿—ä¿ç•™å¤©æ•°</label>
                      <input type="number" v-model="agSettingsForm.REQUEST_LOG_RETENTION_DAYS" class="form-input"
                        style="width: 100%; padding: 6px 10px; font-size: 13px;" placeholder="7">
                    </div>
                  </div>
                </div>
              </div>

              <!-- å®‰å…¨è®¾ç½® -->
              <div>
                <div style="font-size: 13px; font-weight: 600; margin-bottom: 10px; color: var(--ag-primary);">
                  <i class="fas fa-shield-alt"></i> å®‰å…¨è®¾ç½®
                </div>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 12px;">
                  <div>
                    <label style="font-size: 11px; opacity: 0.7; display: block; margin-bottom: 4px;">API è®¿é—®å¯†é’¥</label>
                    <input type="password" v-model="agSettingsForm.API_KEY" class="form-input"
                      style="width: 100%; padding: 6px 10px; font-size: 13px;" placeholder="ç•™ç©ºåˆ™æ— éœ€è®¤è¯">
                  </div>
                  <div>
                    <label style="font-size: 11px; opacity: 0.7; display: block; margin-bottom: 4px;">HTTP ä»£ç†</label>
                    <input type="text" v-model="agSettingsForm.PROXY" class="form-input"
                      style="width: 100%; padding: 6px 10px; font-size: 13px;" placeholder="ä¾‹å¦‚ http://127.0.0.1:7890">
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- ==================== Antigravity æ—¥å¿—è¯¦æƒ…æ¨¡æ€æ¡† ==================== -->
    <div v-if="showAntigravityLogDetailModal" class="modal-overlay" @click.self="showAntigravityLogDetailModal = false"
      @keydown.esc="showAntigravityLogDetailModal = false" tabindex="-1">
      <div class="modal" style="max-width: 600px;">
        <div class="modal-header">
          <div class="modal-title">
            <i class="fas fa-file-alt"></i> è°ƒç”¨æ—¥å¿—è¯¦æƒ…
          </div>
          <button class="modal-close" @click="showAntigravityLogDetailModal = false">&times;</button>
        </div>
        <div class="modal-body" v-if="antigravityLogDetail" style="padding: 20px;">
          <div class="log-detail-grid"
            style="display: grid; grid-template-columns: 120px 1fr; gap: 12px; font-size: 13px;">
            <div style="opacity: 0.6;">è¯·æ±‚æ—¶é—´</div>
            <div>{{ new Date(antigravityLogDetail.created_at).toLocaleString() }}</div>

            <div style="opacity: 0.6;">è¯·æ±‚æ–¹æ³•</div>
            <div><code class="code-sm">{{ antigravityLogDetail.request_method }}</code></div>

            <div style="opacity: 0.6;">è¯·æ±‚è·¯å¾„</div>
            <div><code class="code-sm">{{ antigravityLogDetail.request_path }}</code></div>

            <div style="opacity: 0.6;">çŠ¶æ€ç </div>
            <div>
              <span :class="antigravityLogDetail.status_code < 400 ? 'text-success' : 'text-danger'"
                style="font-weight: 600;">
                {{ antigravityLogDetail.status_code }}
              </span>
            </div>

            <div style="opacity: 0.6;">è€—æ—¶</div>
            <div>{{ antigravityLogDetail.duration_ms }} ms</div>

            <div style="opacity: 0.6;">è´¦å· ID</div>
            <div><code class="code-sm">{{ antigravityLogDetail.account_id || '-' }}</code></div>

            <div style="opacity: 0.6;">å®¢æˆ·ç«¯ IP</div>
            <div>{{ antigravityLogDetail.client_ip || '-' }}</div>

            <div style="opacity: 0.6;">User-Agent</div>
            <div style="word-break: break-all; font-size: 11px; opacity: 0.8;">{{ antigravityLogDetail.user_agent || '-'
              }}</div>
          </div>

          <div v-if="antigravityLogDetail.detail" style="margin-top: 16px;">
            <div style="opacity: 0.6; margin-bottom: 8px; font-size: 13px;">è¯¦æƒ…ä¿¡æ¯</div>
            <pre
              style="background: var(--bg-secondary); padding: 12px; border-radius: 8px; font-size: 12px; overflow-x: auto; margin: 0;">{{ JSON.stringify(antigravityLogDetail.detail, null, 2) }}</pre>
          </div>
        </div>
        <div class="modal-footer" style="padding: 12px 20px; border-top: 1px solid var(--border-color);">
          <button class="btn btn-secondary" @click="showAntigravityLogDetailModal = false">
            å…³é—­
          </button>
        </div>
      </div>
    </div>

    <!-- ==================== ä¸»æœºç®¡ç†æ¨¡æ€æ¡† ==================== -->
    <!-- æ·»åŠ /ç¼–è¾‘ä¸»æœºæ¨¡æ€æ¡† -->
    <div v-if="showServerModal" class="modal-overlay" @keydown.esc="closeServerModal" @keydown.ctrl.enter="saveServer"
      tabindex="-1">
      <div class="modal server-modal">
        <div class="modal-header">
          <div class="modal-title">
            <i class="fas fa-server"></i>
            {{ serverModalMode === 'add' ? 'æ·»åŠ ä¸»æœº' : 'ç¼–è¾‘ä¸»æœº' }}
          </div>
          <button class="modal-close" @click="closeServerModal">&times;</button>
        </div>
        <div class="modal-body">
          <!-- åŸºç¡€ä¿¡æ¯åŒº -->
          <div class="server-form-section">
            <div class="form-row">
              <div class="form-group flex-1">
                <label>å¸¸ç”¨å‡­æ®</label>
                <select class="form-input" @change="applyCredential($event)">
                  <option value="">-- é€‰æ‹©é¢„è®¾å‡­æ® --</option>
                  <option v-for="cred in serverCredentials" :key="cred.id" :value="cred.id">
                    {{ cred.name }} ({{ cred.username }})
                  </option>
                </select>
              </div>
            </div>

            <div class="form-row">
              <div class="form-group flex-1">
                <label><i class="fas fa-id-badge"></i> å®ä¾‹åç§°</label>
                <input type="text" v-model="serverForm.name" class="form-input" placeholder="å¦‚: ç”Ÿäº§ç¯å¢ƒ-ç½‘å…³" required />
              </div>
            </div>

            <div class="form-row">
              <div class="form-group" style="flex: 7;">
                <label><i class="fas fa-network-wired"></i> ä¸»æœºåœ°å€</label>
                <input type="text" v-model="serverForm.host" class="form-input" placeholder="IP æˆ– åŸŸå" required />
              </div>
              <div class="form-group" style="flex: 3;">
                <label><i class="fas fa-door-open"></i> ç«¯å£</label>
                <input type="number" v-model="serverForm.port" class="form-input" placeholder="22" />
              </div>
            </div>

            <div class="form-row">
              <div class="form-group flex-1">
                <label><i class="fas fa-user-shield"></i> ç™»å½•ç”¨æˆ·</label>
                <input type="text" v-model="serverForm.username" class="form-input" placeholder="root" required />
              </div>
            </div>
          </div>

          <!-- è®¤è¯æ–¹å¼åŒº -->
          <div class="server-form-section">
            <div class="server-auth-toggle">
              <button type="button" :class="{ active: serverForm.authType === 'password' }"
                @click="serverForm.authType = 'password'">
                <i class="fas fa-key"></i> å¯†ç è®¤è¯
              </button>
              <button type="button" :class="{ active: serverForm.authType === 'privateKey' }"
                @click="serverForm.authType = 'privateKey'">
                <i class="fas fa-file-code"></i> å¯†é’¥è®¤è¯
              </button>
            </div>

            <div v-if="serverForm.authType === 'password'" class="server-form-field">
              <label><i class="fas fa-lock"></i> å¯†ç </label>
              <input v-model="serverForm.password" type="password" placeholder="è¯·è¾“å…¥å¯†ç " />
            </div>

            <div v-if="serverForm.authType === 'privateKey'">
              <div class="server-form-field">
                <label><i class="fas fa-file-alt"></i> ç§é’¥å†…å®¹</label>
                <textarea v-model="serverForm.privateKey" rows="4"
                  placeholder="ç²˜è´´ SSH ç§é’¥ï¼ˆæ”¯æŒ RSAã€ECDSAã€Ed25519ï¼‰"></textarea>
              </div>
              <div class="server-form-field">
                <label><i class="fas fa-unlock-alt"></i> ç§é’¥å¯†ç  <span class="optional-tag">å¯é€‰</span></label>
                <input v-model="serverForm.passphrase" type="password" placeholder="ç§é’¥æœ‰å¯†ç ä¿æŠ¤æ—¶å¡«å†™" />
              </div>
            </div>
          </div>

          <!-- æ‰©å±•ä¿¡æ¯åŒº -->
          <!-- <div class="server-form-section collapsed-section">
              <div class="server-form-row">
                <div class="server-form-field" style="flex: 1;">
                  <label><i class="fas fa-tags"></i> æ ‡ç­¾ <span class="optional-tag">å¯é€‰</span></label>
                  <input v-model="serverForm.tagsInput" type="text" placeholder="ç”Ÿäº§, Webä¸»æœº" />
                  <label><i class="fas fa-sticky-note"></i> å¤‡æ³¨ <span class="optional-tag">å¯é€‰</span></label>
                  <textarea v-model="serverForm.description" rows="2" placeholder="ä¸»æœºç”¨é€”è¯´æ˜"></textarea>
                </div>
              </div>
            </div> -->

          <div v-if="serverModalError" class="server-form-error">
            <i class="fas fa-exclamation-circle"></i> {{ serverModalError }}
          </div>
        </div>
        <div class="server-modal-footer">
          <button class="btn-server-cancel" @click="closeServerModal" :disabled="serverModalSaving">
            å–æ¶ˆ
          </button>
          <div class="server-modal-actions">
            <button class="btn-server-test" @click="testServerConnection" :disabled="serverModalSaving">
              <i class="fas fa-plug"></i> æµ‹è¯•
            </button>
            <button class="btn-server-save" @click="saveServer" :disabled="serverModalSaving">
              <i class="fas" :class="serverModalSaving ? 'fa-spinner fa-spin' : 'fa-check'"></i>
              {{ serverModalSaving ? 'ä¿å­˜ä¸­' : 'ä¿å­˜' }}
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- æ‰¹é‡å¯¼å…¥ä¸»æœºæ¨¡æ€æ¡† -->
    <div v-if="showImportServerModal" class="modal-overlay" @keydown.esc="closeImportServerModal"
      @keydown.enter="confirmImportServers" tabindex="-1">
      <div class="modal server-modal" style="max-width: 500px;">
        <div class="modal-header">
          <div class="modal-title">
            <i class="fas fa-file-import"></i>
            æ‰¹é‡å¯¼å…¥ä¸»æœº
          </div>
          <button class="modal-close" @click="closeImportServerModal">&times;</button>
        </div>
        <div class="modal-body">
          <div class="server-form-section">
            <div class="form-group">
              <label><i class="fas fa-file"></i> é€‰æ‹© JSON æ–‡ä»¶</label>
              <input type="file" ref="importFileInput" accept=".json" class="form-input"
                @change="handleImportFileChange" />
            </div>
          </div>
          <div v-if="importPreview" class="server-form-section" style="margin-top: 8px;">
            <div class="form-group">
              <label><i class="fas fa-list"></i> é¢„è§ˆï¼ˆå°†å¯¼å…¥ {{ importPreview.length }} å°ä¸»æœºï¼‰</label>
              <div class="import-preview-list">
                <div v-for="(server, index) in importPreview" :key="index" class="import-preview-item">
                  <i class="fas fa-server"></i>
                  <span>{{ server.name }} ({{ server.username }}@{{ server.host }}:{{ server.port }})</span>
                </div>
              </div>
            </div>
          </div>
          <div v-if="importModalError" class="server-form-error">
            <i class="fas fa-exclamation-circle"></i> {{ importModalError }}
          </div>
        </div>
        <div class="server-modal-footer">
          <button class="btn-server-cancel" @click="closeImportServerModal" :disabled="importModalSaving">
            å–æ¶ˆ
          </button>
          <button class="btn-server-save" @click="confirmImportServers"
            :disabled="importModalSaving || !importPreview || importPreview.length === 0">
            <i class="fas fa-check"></i>
            {{ importModalSaving ? 'å¯¼å…¥ä¸­...' : 'ç¡®è®¤å¯¼å…¥' }}
          </button>
        </div>
      </div>
    </div>

    <!-- æ–°å»ºç»ˆç«¯ä¼šè¯é€‰æ‹©æ¨¡æ€æ¡† -->
    <div v-if="showAddSessionSelectModal" class="modal-overlay" @keydown.esc="showAddSessionSelectModal = false"
      tabindex="-1">
      <div class="modal server-modal" style="max-width: 360px;">
        <div class="modal-header">
          <div class="modal-title">
            <i class="fas fa-terminal"></i>
            é€‰æ‹©ä¸»æœº
          </div>
          <button class="modal-close" @click="showAddSessionSelectModal = false">&times;</button>
        </div>
        <div class="modal-body" style="max-height: 400px; overflow-y: auto; padding: 8px;">
          <div v-if="serverList.length === 0" class="empty-state">
            <p>æš‚æ— å¯ç”¨ä¸»æœº</p>
          </div>
          <div v-else class="server-select-list">
            <div v-for="server in serverList" :key="server.id" class="server-select-item"
              @click="addSessionForServer(server)">
              <div class="server-status-indicator" :class="server.status || 'unknown'"></div>
              <div class="server-select-info">
                <div class="server-select-name">{{ server.name }}</div>
                <div class="server-select-host">{{ server.host }}:{{ server.port }}</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- è®¾ç½®ä¾§è¾¹æ  -->
    <div v-if="showSettingsModal" @keydown.esc="showSettingsModal = false" tabindex="-1">
      <div class="settings-sidebar-overlay"></div>
      <div class="settings-sidebar">
        <!-- ä¾§è¾¹æ å¤´éƒ¨ -->
        <div class="settings-sidebar-header">
          <div class="settings-sidebar-title">
            <i class="fas fa-cog"></i>
            <span>ç³»ç»Ÿè®¾ç½®</span>
          </div>
          <button class="settings-sidebar-close" @click="showSettingsModal = false">&times;</button>
        </div>

        <!-- ä¾§è¾¹æ å†…å®¹ -->
        <div class="settings-sidebar-content">
          <!-- æ¨¡å—ç®¡ç† -->
          <div class="settings-section">
            <div class="settings-section-title">æ¨¡å—ç®¡ç†</div>
            <div>
              <div v-for="(module, index) in moduleOrder" :key="module" class="draggable-module-item" draggable="true"
                @dragstart="handleDragStart($event, index)" @dragend="handleDragEnd"
                @dragover.prevent="handleDragOver($event, index)" @drop="handleDrop($event, index)">
                <i class="fas fa-grip-vertical drag-handle"></i>
                <i class="draggable-module-icon fas" :class="getModuleIcon(module)"></i>
                <span class="draggable-module-name">{{ getModuleName(module) }}</span>
                <!-- æ˜¾ç¤º/éšè—åˆ‡æ¢æŒ‰é’® -->
                <button class="btn btn-sm" :class="moduleVisibility[module] ? 'btn-success' : 'btn-secondary'"
                  @click.stop="toggleModuleVisibility(module)" style="padding: 4px 8px; font-size: 12px;">
                  <i class="fas" :class="moduleVisibility[module] ? 'fa-eye' : 'fa-eye-slash'"></i>
                </button>
              </div>
            </div>
            <div class="form-help" style="margin-top: 8px;">æ‹–æ‹½è°ƒæ•´é¡ºåºï¼Œç‚¹å‡»çœ¼ç›å›¾æ ‡åˆ‡æ¢æ˜¾ç¤º/éšè—</div>
          </div>

          <!-- ä¿®æ”¹å¯†ç  -->
          <div class="settings-section">
            <div class="settings-section-title">ä¿®æ”¹ç™»å½•å¯†ç </div>
            <div class="form-group">
              <input v-model="newPassword" type="password" class="form-input" placeholder="è¾“å…¥æ–°å¯†ç ï¼ˆè‡³å°‘6ä½ï¼‰" />
            </div>
            <div class="form-group">
              <input v-model="confirmPassword" type="password" class="form-input" placeholder="ç¡®è®¤æ–°å¯†ç " />
            </div>
            <div v-if="passwordError" class="form-error">{{ passwordError }}</div>
            <div v-if="passwordSuccess" class="form-success">{{ passwordSuccess }}</div>
            <button class="btn btn-primary" @click="changePassword" style="width: 100%;">
              <i class="fas fa-key"></i> ä¿®æ”¹å¯†ç 
            </button>
          </div>

          <!-- æ•°æ®å¯¼å…¥å¯¼å‡º -->
          <div class="settings-section">
            <div class="settings-section-title">æ•°æ®å¤‡ä»½ä¸æ¢å¤</div>
            <div style="display: flex; gap: 8px; margin-bottom: 8px;">
              <button class="btn btn-success" @click="exportAllData" style="flex: 1;">
                <i class="fas fa-upload"></i> å¯¼å‡ºæ•°æ®
              </button>
              <button class="btn btn-warning" @click="importAllData" style="flex: 1;">
                <i class="fas fa-download"></i> å¯¼å…¥æ•°æ®
              </button>
            </div>
                        <div class="form-help">å¯¼å‡ºåŒ…å«æ‰€æœ‰æ¨¡å—çš„é…ç½®å’Œæ•°æ®</div>
                      </div>
            
                      <!-- è‡ªå®šä¹‰ CSS -->
          <div class="settings-section">
            <div class="settings-section-title">è‡ªå®šä¹‰ CSS</div>
            <div class="form-help" style="margin-bottom: 8px;">
              å¯ä»¥è‡ªå®šä¹‰å­—ä½“ã€é¢œè‰²ç­‰æ ·å¼ã€‚ä¾‹å¦‚ï¼š
              <code style="display: block; margin-top: 4px;">body { font-family: 'Microsoft YaHei', sans-serif; }</code>
            </div>
            <textarea v-model="customCss" class="form-textarea" placeholder="è¾“å…¥è‡ªå®šä¹‰ CSS ä»£ç ..."
              style="min-height: 150px; font-family: 'Consolas', 'Monaco', monospace; font-size: 12px;"></textarea>
            <div v-if="customCssError" class="form-error" style="margin-top: 8px;">{{ customCssError }}</div>
            <div v-if="customCssSuccess" class="form-success" style="margin-top: 8px;">{{ customCssSuccess }}
            </div>
            <div style="display: flex; gap: 8px; margin-top: 8px;">
              <button class="btn btn-primary" @click="saveCustomCss" style="flex: 1;">
                <i class="fas fa-save"></i> åº”ç”¨ CSS
              </button>
              <button class="btn btn-secondary" @click="resetCustomCss" style="flex: 1;">
                <i class="fas fa-undo"></i> é‡ç½®
              </button>
            </div>
          </div>

          <!-- ä¿å­˜æŒ‰é’® -->
          <div
            style="bottom: 0; background: var(--card-bg); padding-top: 16px; border-top: 1px solid var(--border-color); margin-top: 20px;">
            <button class="btn btn-primary" @click="saveSettings" style="width: 100%;">
              <i class="fas fa-save"></i> ä¿å­˜è®¾ç½®
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- æ—¥å¿—æ¨¡æ€æ¡† -->
    <div v-if="showLogsModal" class="modal-overlay" :class="{ 'logs-fullscreen-overlay': logsFullscreen }"
      @keydown.esc="showLogsModal = false" tabindex="-1">
      <div class="modal logs-modal" :class="{ 'logs-modal-fullscreen': logsFullscreen }">
        <div class="logs-header">
          <div class="logs-title">ğŸ“‹ {{ logsModalTitle }}</div>
          <div class="logs-controls">
            <button class="btn btn-secondary" @click="toggleRealTimeRefresh"
              style="margin-right: 8px; padding: 6px 10px; font-size: 12px;">
              <i class="fas" :class="logsRealTime ? 'fa-stop' : 'fa-play'"></i>
              {{ logsRealTime ? 'åœæ­¢å®æ—¶' : 'å®æ—¶åˆ·æ–°' }}
            </button>
            <button class="btn btn-secondary" @click="toggleAutoScroll"
              style="margin-right: 8px; padding: 6px 10px; font-size: 12px;">
              <i class="fas" :class="logsAutoScroll ? 'fa-pause' : 'fa-play'"></i>
              {{ logsAutoScroll ? 'åœæ­¢æ»šåŠ¨' : 'è‡ªåŠ¨æ»šåŠ¨' }}
            </button>
            <button class="btn btn-secondary" @click="toggleFullscreen"
              style="margin-right: 8px; padding: 6px 10px; font-size: 12px;">
              <i class="fas" :class="logsFullscreen ? 'fa-compress' : 'fa-expand'"></i>
              {{ logsFullscreen ? 'é€€å‡ºå…¨å±' : 'å…¨å±' }}
            </button>
            <button class="btn btn-danger" @click="showLogsModal = false" style="padding: 6px 10px; font-size: 12px;">
              <i class="fas fa-times"></i>
              å…³é—­
            </button>
          </div>
        </div>
        <div class="logs-info">
          <span>é¡¹ç›®: {{ logsModalInfo.project }}</span>
          <span>è´¦å·: {{ logsModalInfo.account }}</span>
          <span>æ—¥å¿—: {{ logsModalInfo.count }} æ¡</span>
          <span>æ—¶é—´: {{ logsModalInfo.time }}</span>
        </div>
        <div class="logs-content" ref="logsContent" @wheel.stop @touchmove.stop>
          <div v-if="logsLoading" style="text-align: center; padding: 40px;">â³ æ­£åœ¨åŠ è½½æ—¥å¿—...</div>
          <div v-else class="logs-text-container" ref="logsTextContainer">
            <pre class="logs-text" ref="logsText">{{ logsContent || 'æš‚æ— æ—¥å¿—' }}</pre>
            <div class="logs-horizontal-scrollbar" ref="logsScrollbar">
              <div class="logs-scrollbar-thumb" ref="logsScrollbarThumb"></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Toast ç³»ç»Ÿå®¹å™¨å°†ç”± toast.js è‡ªåŠ¨åˆ›å»º -->

    <!-- è‡ªå®šä¹‰ç¡®è®¤å¯¹è¯æ¡† -->
    <div v-if="customDialog.show" class="custom-dialog-overlay"
      @keydown.esc="customDialog.onCancel ? customDialog.onCancel() : (customDialog.show = false)"
      @keydown.enter="customDialog.onConfirm" tabindex="-1">
      <div class="custom-dialog">
        <div class="custom-dialog-title">
          <i class="fas" :class="customDialog.icon || 'fa-question-circle'"></i>
          {{ customDialog.title || 'ç¡®è®¤' }}
        </div>
        <div class="custom-dialog-message">{{ customDialog.message }}</div>
        <input v-if="customDialog.isPrompt" v-model="customDialog.promptValue" :placeholder="customDialog.placeholder"
          @keyup.enter="customDialog.onConfirm" class="custom-dialog-input" ref="promptInput" />
        <div class="custom-dialog-buttons">
          <button v-if="customDialog.cancelText" class="btn btn-secondary"
            @click="customDialog.onCancel ? customDialog.onCancel() : (customDialog.show = false)">
            {{ customDialog.cancelText }}
          </button>
          <button class="btn" :class="customDialog.confirmClass || 'btn-primary'" @click="customDialog.onConfirm">
            {{ customDialog.confirmText || 'ç¡®å®š' }}
          </button>
        </div>
      </div>
    </div>

    <!-- å‡­æ®ç®¡ç†æ¨¡æ€æ¡† -->
    <div v-if="showAddCredentialModal" class="modal-overlay" @click.self="showAddCredentialModal = false"
      @keydown.esc="showAddCredentialModal = false" tabindex="-1">
      <div class="modal server-modal" style="max-width: 380px;">
        <div class="modal-header">
          <div class="modal-title">
            <i class="fas fa-key"></i> ä¿å­˜æ–°å‡­æ®
          </div>
          <button class="modal-close" @click="showAddCredentialModal = false">&times;</button>
        </div>
        <div class="modal-body">
          <div class="server-form-section">
            <div class="form-group">
              <label><i class="fas fa-tag"></i> å‡­æ®æ ‡è¯†</label>
              <input type="text" v-model="credForm.name" class="form-input" placeholder="ä¾‹å¦‚: é»˜è®¤å¯†ç " />
            </div>
            <div class="form-group">
              <label><i class="fas fa-user"></i> ç”¨æˆ·å</label>
              <input type="text" v-model="credForm.username" class="form-input" placeholder="root" />
            </div>
            <div class="form-group">
              <label><i class="fas fa-lock"></i> å¯†ç </label>
              <input type="password" v-model="credForm.password" class="form-input" placeholder="ç™»å½•å¯†ç " />
            </div>
          </div>
          <div v-if="credError" class="server-form-error">
            <i class="fas fa-exclamation-circle"></i> {{ credError }}
          </div>
        </div>
        <div class="server-modal-footer">
          <button class="btn-server-cancel" @click="showAddCredentialModal = false">å–æ¶ˆ</button>
          <button class="btn-server-save" @click="saveCredential">
            <i class="fas fa-save"></i> ä¿å­˜
          </button>
        </div>
      </div>
    </div>

    <!-- Docker è¯¦ç»†åˆ—è¡¨æ¨¡æ€æ¡† -->
    <div v-if="showDockerModal" class="modal-overlay" @click.self="showDockerModal = false">
      <div class="modal-container glass-panel" style="max-width: 900px; border-radius: 20px;">
        <div class="modal-header">
          <div class="modal-title">äº‘å®¹å™¨ç®¡ç† - {{ dockerModalServer ? dockerModalServer.name : '' }}</div>
          <button class="close-btn" @click="showDockerModal = false">Ã—</button>
        </div>
        <div class="modal-body">
          <div v-if="dockerModalData && dockerModalData.containers" class="docker-container-list">
            <div v-for="container in dockerModalData.containers" :key="container.id" class="docker-container-card"
              :class="{ 'running': container.status.includes('Up') }">
              <div class="docker-container-info" style="padding: 15px;">
                <div
                  style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 10px;">
                  <div>
                    <div style="font-weight: 700; font-size: 14px;">{{ container.name }}</div>
                    <div style="font-size: 11px; opacity: 0.6; font-family: monospace;">{{ container.image }}</div>
                  </div>
                  <span class="docker-status-badge"
                    :class="container.status.includes('Up') ? 'status-running' : 'status-exited'">
                    {{ container.status }}
                  </span>
                </div>
                <div style="font-size: 11px; opacity: 0.8;">ç«¯å£: {{ container.ports }}</div>
                <div class="docker-container-actions" style="margin-top: 15px; justify-content: flex-end;">
                  <button v-if="container.status.includes('Up')" class="btn btn-sm btn-secondary"
                    @click="handleDockerAction(dockerModalServer.id, container.id, 'stop')" title="åœæ­¢"><i
                      class="fas fa-stop"></i></button>
                  <button v-else class="btn btn-sm btn-success"
                    @click="handleDockerAction(dockerModalServer.id, container.id, 'start')" title="å¯åŠ¨"><i
                      class="fas fa-play"></i></button>
                  <button class="btn btn-sm btn-secondary"
                    @click="handleDockerAction(dockerModalServer.id, container.id, 'restart')" title="é‡å¯"><i
                      class="fas fa-redo"></i></button>
                </div>
              </div>
            </div>
          </div>
          <div v-else class="loading">æ­£åœ¨è·å–å®¹å™¨ä¿¡æ¯...</div>
        </div>
      </div>
    </div> <!-- é—­åˆ Docker è¯¦ç»†åˆ—è¡¨æ¨¡æ€æ¡† -->

    <!-- ==================== Antigravity è´¦å·æ¨¡æ€æ¡† ==================== -->
    <div v-if="showAntigravityAccountModal" class="modal-overlay" @keydown.esc="showAntigravityAccountModal = false">
      <div class="modal">
        <div class="modal-header">
          <div class="modal-title">
            <i class="fas fa-atom"></i>
            {{ antigravityEditingAccount ? 'ç¼–è¾‘è´¦å·' : 'æ·»åŠ è´¦å·' }}
          </div>
          <button class="modal-close" @click="showAntigravityAccountModal = false">&times;</button>
        </div>
        <div class="modal-body">
          <div class="form-group">
            <label class="form-label">è´¦å·åç§° *</label>
            <input v-model="antigravityAccountForm.name" class="form-input" placeholder="ä¾‹å¦‚: Google Pro" />
          </div>
          <div class="form-group">
            <label class="form-label">Email (å¯é€‰)</label>
            <input v-model="antigravityAccountForm.email" class="form-input" placeholder="user@gmail.com" />
          </div>
          <div class="form-group">
            <label class="form-label">API Key (å¯é€‰)</label>
            <input v-model="antigravityAccountForm.apiKey" type="password" class="form-input" placeholder="sk-..." />
          </div>
          <div v-if="antigravityAccountFormError" class="form-error">{{ antigravityAccountFormError }}</div>
        </div>
        <div class="modal-footer" style="display: flex; gap: 12px; margin-top: 20px;">
          <button class="btn btn-primary" @click="saveAntigravityAccount" :disabled="antigravitySaving"
            style="flex: 1;">
            {{ antigravitySaving ? 'ä¿å­˜ä¸­...' : 'æäº¤' }}
          </button>
          <button class="btn btn-secondary" @click="showAntigravityAccountModal = false" style="flex: 1;">å–æ¶ˆ</button>
        </div>
      </div>
    </div>

    <!-- Antigravity æ‰‹åŠ¨æ·»åŠ æ¨¡æ€æ¡† -->
    <div v-if="showAntigravityManualModal" class="modal-overlay" @click.self="showAntigravityManualModal = false">
      <div class="modal" style="max-width: 500px;">
        <div class="modal-header">
          <div class="modal-title">æ‰‹åŠ¨æ·»åŠ  Token</div>
          <button class="modal-close" @click="showAntigravityManualModal = false">&times;</button>
        </div>
        <div class="modal-body">
          <div class="form-group">
            <label>è´¦å·åç§° (å¯é€‰)</label>
            <input type="text" v-model="antigravityManualForm.name" class="form-input" placeholder="é»˜è®¤ä¸º Manual Account">
          </div>
          <div class="form-group">
            <label>Access Token <span style="color:red">*</span></label>
            <textarea v-model="antigravityManualForm.accessToken" class="form-textarea" placeholder="ya29.a0..."
              style="min-height: 80px; font-family: monospace; font-size: 12px;"></textarea>
          </div>
          <div class="form-group">
            <label>Refresh Token <span style="color:red">*</span></label>
            <textarea v-model="antigravityManualForm.refreshToken" class="form-textarea" placeholder="1//0..."
              style="min-height: 60px; font-family: monospace; font-size: 12px;"></textarea>
          </div>
          <div class="form-row">
            <div class="form-group flex-1">
              <label>Project ID (å¯é€‰)</label>
              <input type="text" v-model="antigravityManualForm.projectId" class="form-input" placeholder="å¦‚æœªå¡«å°†å°è¯•è‡ªåŠ¨è·å–">
            </div>
            <div class="form-group" style="flex: 0 0 120px;">
              <label>æœ‰æ•ˆæœŸ (ç§’)</label>
              <input type="number" v-model="antigravityManualForm.expiresIn" class="form-input" placeholder="3599">
            </div>
          </div>
          <div v-if="antigravityManualFormError" class="form-error">{{ antigravityManualFormError }}</div>
        </div>
        <div class="modal-footer">
          <button class="btn btn-secondary" @click="showAntigravityManualModal = false">å–æ¶ˆ</button>
          <button class="btn btn-primary" @click="saveAntigravityManualAccount" :disabled="antigravitySaving">
            <i class="fas" :class="antigravitySaving ? 'fa-spinner fa-spin' : 'fa-save'"></i> ä¿å­˜
          </button>
        </div>
      </div>
    </div>

  </div> <!-- é—­åˆ isAuthenticated container -->
  </div> <!-- é—­åˆ app -->



  <!-- æ¨¡å—åŒ– JavaScript -->
  <script type="module" src="/js/main.js"></script>
</body>

</html>